version: 4.3.2
definitions:
  nested_selector:
    type: RecordSelector
    extractor:
      type: DpathExtractor
      field_path:
      - "list"
      - "*"
      - "{{ parameters.get('name') }}"
  custom_field_transformation:
    type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  requester:
    type: HttpRequester
    url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
    http_method: "GET"
    authenticator:
      type: BasicHttpAuthenticator
      username: "{{ config['site_api_key'] }}"
    error_handler:
      type: CompositeErrorHandler
      error_handlers:
      - type: DefaultErrorHandler
        response_filters:
        - error_message_contains: "This API operation is not enabled for this site"
          action: IGNORE
          error_message: "Stream is available only for Product Catalog 1.0"
      - type: DefaultErrorHandler
        backoff_strategies:
        - type: WaitTimeFromHeader
          header: "Retry-After"
  date_stream_slicer:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
  base_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
  base_incremental_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  semi_incremental_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
        record_filter:
          condition: "{{ record['updated_at'] >= ( stream_state.get('prior_state',
            {}).get('updated_at', 0) if stream_state else stream_slice.get('prior_state',
            {}).get('updated_at', 0) ) }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: CustomIncrementalSync
      class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
      cursor_field: "updated_at"
  addon_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Add-on
        type: object
        properties:
          id:
            description: Unique identifier for the addon.
            type:
            - string
            - 'null'
          name:
            description: Name of the addon.
            type:
            - string
            - 'null'
          invoice_name:
            description: Name to be displayed on the invoice for the addon.
            type:
            - string
            - 'null'
          description:
            description: Description of the addon.
            type:
            - string
            - 'null'
          pricing_model:
            description: Model used for pricing the addon.
            type:
            - string
            - 'null'
          charge_type:
            description: Type of charge for the addon.
            type:
            - string
            - 'null'
          price:
            description: Price of the addon.
            type:
            - integer
            - 'null'
          currency_code:
            description: Currency code for the addon pricing.
            type:
            - string
            - 'null'
          period:
            description: Duration of the addon period.
            type:
            - integer
            - 'null'
          period_unit:
            description: Unit of duration for the addon period.
            type:
            - string
            - 'null'
          unit:
            description: Unit of the addon quantity.
            type:
            - string
            - 'null'
          status:
            description: Status of the addon.
            type:
            - string
            - 'null'
          archived_at:
            description: Timestamp indicating when the addon was archived.
            type:
            - integer
            - 'null'
          enabled_in_portal:
            description: Indicator for whether the addon is enabled in the customer
              portal.
            type:
            - boolean
            - 'null'
          tax_code:
            description: Tax code associated with the addon.
            type:
            - string
            - 'null'
          taxjar_product_code:
            description: TaxJar product code for tax calculation.
            type:
            - string
            - 'null'
          avalara_sale_type:
            description: Avalara sale type for tax calculation.
            type:
            - string
            - 'null'
          avalara_transaction_type:
            description: Avalara transaction type for tax calculation.
            type:
            - integer
            - 'null'
          avalara_service_type:
            description: Avalara service type for tax calculation.
            type:
            - integer
            - 'null'
          sku:
            description: Stock Keeping Unit (SKU) for the addon.
            type:
            - string
            - 'null'
          accounting_code:
            description: Accounting code for the addon.
            type:
            - string
            - 'null'
          accounting_category1:
            description: First accounting category for the addon.
            type:
            - string
            - 'null'
          accounting_category2:
            description: Second accounting category for the addon.
            type:
            - string
            - 'null'
          accounting_category3:
            description: Third accounting category for the addon.
            type:
            - string
            - 'null'
          accounting_category4:
            description: Fourth accounting category for the addon.
            type:
            - string
            - 'null'
          is_shippable:
            description: Indicator for whether the addon is shippable.
            type:
            - boolean
            - 'null'
          shipping_frequency_period:
            description: Frequency of shipping for the addon period.
            type:
            - integer
            - 'null'
          shipping_frequency_period_unit:
            description: Unit of frequency for shipping the addon.
            type:
            - string
            - 'null'
          resource_version:
            description: Version of the resource.
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp of the last update to the addon data.
            type:
            - integer
            - 'null'
          price_in_decimal:
            description: Price of the addon in decimal format.
            type:
            - string
            - 'null'
          included_in_mrr:
            description: Indicator for whether the addon is included in Monthly Recurring
              Revenue (MRR).
            type:
            - boolean
            - 'null'
          invoice_notes:
            description: Additional notes to include on the invoice for the addon.
            type:
            - string
            - 'null'
          taxable:
            description: Indicator for whether the addon is taxable.
            type:
            - boolean
            - 'null'
          tax_profile_id:
            description: Tax profile identifier for the addon.
            type:
            - string
            - 'null'
          meta_data:
            description: Additional metadata associated with the addon.
            type:
            - object
            - 'null'
            properties: {}
          show_description_in_invoices:
            description: Indicator for whether the description should appear on invoices.
            type:
            - boolean
            - 'null'
          show_description_in_quotes:
            description: Indicator for whether the description should appear on quotes.
            type:
            - boolean
            - 'null'
          channel:
            description: Channel for which the addon is applicable.
            type:
            - string
            - 'null'
          object:
            description: Type of object, in this case, addon.
            type:
            - string
            - 'null'
          type:
            description: Type of addon.
            type:
            - string
            - 'null'
          tiers:
            description: Tiers with specific pricing for the addon.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                starting_unit:
                  description: Starting unit quantity for the tier.
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: Ending unit quantity for the tier.
                  type:
                  - integer
                  - 'null'
                price:
                  description: Price of the tier.
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  description: Starting unit quantity in decimal for the tier.
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  description: Ending unit quantity in decimal for the tier.
                  type:
                  - string
                  - 'null'
                price_in_decimal:
                  description: Price of the tier in decimal format.
                  type:
                  - string
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  attached_item_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
      partition_router:
        type: SubstreamPartitionRouter
        parent_stream_configs:
        - type: ParentStreamConfig
          stream:
            retriever:
              type: SimpleRetriever
              record_selector:
                type: RecordSelector
                extractor:
                  type: DpathExtractor
                  field_path:
                  - "list"
                  - "*"
                  - "{{ parameters.get('name') }}"
              paginator:
                type: DefaultPaginator
                pagination_strategy:
                  type: "CursorPagination"
                  cursor_value: "{{ response.get('next_offset')|tojson() }}"
                  stop_condition: "{{ not response.next_offset }}"
                  page_size_option:
                    type: RequestOption
                    inject_into: request_parameter
                    field_name: limit
                    page_size: 100
                page_token_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: offset
              requester:
                type: HttpRequester
                url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
                http_method: "GET"
                authenticator:
                  type: BasicHttpAuthenticator
                  username: "{{ config['site_api_key'] }}"
                error_handler:
                  type: CompositeErrorHandler
                  error_handlers:
                  - type: DefaultErrorHandler
                    response_filters:
                    - error_message_contains: "This API operation is not enabled for
                        this site"
                      action: IGNORE
                      error_message: "Stream is available only for Product Catalog
                        1.0"
                  - type: DefaultErrorHandler
                    backoff_strategies:
                    - type: WaitTimeFromHeader
                      header: "Retry-After"
                request_parameters:
                  sort_by[asc]: updated_at
                  include_deleted: "true"
                  updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
            transformations:
            - type: CustomTransformation
              class_name: source_declarative_manifest.components.CustomFieldTransformation
            incremental_sync:
              type: DatetimeBasedCursor
              start_datetime:
                datetime: "{{ format_datetime(config['start_date'], '%s') }}"
                datetime_format: "%s"
              end_datetime:
                datetime: "{{ now_utc().strftime('%s') }}"
                datetime_format: "%s"
              datetime_format: "%s"
              cursor_granularity: PT1S
              step: P1M
              cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
                }}"
            schema_loader:
              type: InlineSchemaLoader
              schema:
                $schema: http://json-schema.org/draft-07/schema#
                name: Item
                type: object
                properties:
                  id:
                    description: Unique identifier for the item
                    type:
                    - string
                    - 'null'
                  name:
                    description: Name of the item
                    type:
                    - string
                    - 'null'
                  description:
                    description: Description of the item
                    type:
                    - string
                    - 'null'
                  status:
                    description: Status of the item
                    type:
                    - string
                    - 'null'
                  resource_version:
                    description: Version of the resource
                    type:
                    - integer
                    - 'null'
                  updated_at:
                    description: Date and time when the item was last updated
                    type:
                    - integer
                    - 'null'
                  item_family_id:
                    description: ID of the item's family
                    type:
                    - string
                    - 'null'
                  type:
                    description: Type of the item
                    type:
                    - string
                    - 'null'
                  is_shippable:
                    description: Flag indicating if the item is shippable
                    type:
                    - boolean
                    - 'null'
                  is_giftable:
                    description: Flag indicating if the item is giftable
                    type:
                    - boolean
                    - 'null'
                  redirect_url:
                    description: URL to redirect for the item
                    type:
                    - string
                    - 'null'
                  enabled_for_checkout:
                    description: Flag indicating if the item is enabled for checkout
                    type:
                    - boolean
                    - 'null'
                  enabled_in_portal:
                    description: Flag indicating if the item is enabled in the portal
                    type:
                    - boolean
                    - 'null'
                  included_in_mrr:
                    description: Flag indicating if the item is included in Monthly
                      Recurring Revenue
                    type:
                    - boolean
                    - 'null'
                  item_applicability:
                    description: Applicability of the item
                    type:
                    - string
                    - 'null'
                  gift_claim_redirect_url:
                    description: URL to redirect for gift claim
                    type:
                    - string
                    - 'null'
                  unit:
                    description: Unit associated with the item
                    type:
                    - string
                    - 'null'
                  metered:
                    description: Flag indicating if the item is metered
                    type:
                    - boolean
                    - 'null'
                  usage_calculation:
                    description: Calculation method used for item usage
                    type:
                    - string
                    - 'null'
                  archived_at:
                    description: Date and time when the item was archived
                    type:
                    - integer
                    - 'null'
                  metadata:
                    description: Additional data associated with the item
                    type:
                    - object
                    - 'null'
                    properties: {}
                  external_name:
                    description: Name of the item in an external system
                    type:
                    - string
                    - 'null'
                  applicable_items:
                    description: Items associated with the item
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          description: Unique identifier for the item
                          type:
                          - string
                          - 'null'
                  channel:
                    description: Channel the item belongs to
                    type:
                    - string
                    - 'null'
                  object:
                    description: Type of object
                    type:
                    - string
                    - 'null'
                  custom_fields: _definitions.json#/definitions/custom_fields
          parent_key: "id"
          partition_field: "item_id"
          incremental_dependency: true
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    $comment: "As of 2/8/24 this stream should be full refresh only as there is an
      issue with state being appended rather than replaced, causing duplicates. See
      GH Issue: https://github.com/airbytehq/airbyte/issues/33854"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Attached Items
        type: object
        properties:
          id:
            description: Unique identifier for the attached item.
            type:
            - string
            - 'null'
          parent_item_id:
            description: Identifier of the parent item to which this attached item
              is attached.
            type:
            - string
            - 'null'
          item_id:
            description: Identifier of the item to which this attached item belongs.
            type:
            - string
            - 'null'
          type:
            description: Type of the attached item.
            type:
            - string
            - 'null'
          status:
            description: Current status of the attached item.
            type:
            - string
            - 'null'
          quantity:
            description: Quantity of the attached item included in the parent item.
            type:
            - integer
            - 'null'
          quantity_in_decimal:
            description: Quantity of the attached item in decimal format.
            type:
            - string
            - 'null'
          billing_cycles:
            description: Number of billing cycles associated with the attached item.
            type:
            - integer
            - 'null'
          charge_on_event:
            description: Indicates when the attached item should be charged.
            type:
            - string
            - 'null'
          charge_once:
            description: Flag to determine if the attached item should be charged
              only once.
            type:
            - boolean
            - 'null'
          created_at:
            description: Timestamp when the attached item was created.
            type:
            - integer
            - 'null'
          resource_version:
            description: Version of the attached item resource for tracking changes.
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp when the attached item was last updated.
            type:
            - integer
            - 'null'
          object:
            description: Type of object representing the attached item.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  customer_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Customer
        type: object
        properties:
          id:
            description: Unique ID of the customer.
            type:
            - string
            - 'null'
          first_name:
            description: First name of the customer.
            type:
            - string
            - 'null'
          last_name:
            description: Last name of the customer.
            type:
            - string
            - 'null'
          email:
            description: Email address of the customer.
            type:
            - string
            - 'null'
          phone:
            description: Phone number of the customer.
            type:
            - string
            - 'null'
          company:
            description: Company or organization name.
            type:
            - string
            - 'null'
          vat_number:
            description: VAT number associated with the customer.
            type:
            - string
            - 'null'
          auto_collection:
            description: Configures the automatic collection settings for the customer.
            type:
            - string
            - 'null'
          offline_payment_method:
            description: Offline payment method used by the customer.
            type:
            - string
            - 'null'
          net_term_days:
            description: Number of days for net terms.
            type:
            - integer
            - 'null'
          vat_number_validated_time:
            description: Date and time when the VAT number was validated.
            type:
            - integer
            - 'null'
          vat_number_status:
            description: Status of the VAT number validation.
            type:
            - string
            - 'null'
          allow_direct_debit:
            description: Indicates if direct debit is allowed for the customer.
            type:
            - boolean
            - 'null'
          is_location_valid:
            description: Flag indicating if the customer location is valid.
            type:
            - boolean
            - 'null'
          created_at:
            description: Date and time when the customer was created.
            type:
            - integer
            - 'null'
          created_from_ip:
            description: IP address from which the customer was created.
            type:
            - string
            - 'null'
          exemption_details:
            description: Details about any exemptions applicable to the customer's
              account.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties: {}
          taxability:
            description: Taxability status of the customer.
            type:
            - string
            - 'null'
          entity_code:
            description: Code for the customer entity.
            type:
            - string
            - 'null'
          exempt_number:
            description: Exemption number for tax purposes.
            type:
            - string
            - 'null'
          resource_version:
            description: Version of the customer's resource.
            type:
            - integer
            - 'null'
          updated_at:
            description: Date and time when the customer record was last updated.
            type:
            - integer
            - 'null'
          locale:
            description: Locale setting for the customer.
            type:
            - string
            - 'null'
          billing_date:
            description: Date for billing cycle.
            type:
            - integer
            - 'null'
          billing_date_mode:
            description: Mode for billing date calculation.
            type:
            - string
            - 'null'
          billing_day_of_week:
            description: Day of the week for billing cycle.
            type:
            - string
            - 'null'
          billing_day_of_week_mode:
            description: Mode for billing day of the week calculation.
            type:
            - string
            - 'null'
          billing_month:
            description: Month for billing cycle.
            type:
            - integer
            - 'null'
          pii_cleared:
            description: Flag indicating if PII (Personally Identifiable Information)
              is cleared.
            type:
            - string
            - 'null'
          auto_close_invoices:
            description: Flag to automatically close invoices for the customer.
            type:
            - boolean
            - 'null'
          fraud_flag:
            description: Flag indicating if fraud is associated with the customer.
            type:
            - string
            - 'null'
          primary_payment_source_id:
            description: ID of the primary payment source for the customer.
            type:
            - string
            - 'null'
          backup_payment_source_id:
            description: ID of the backup payment source for the customer.
            type:
            - string
            - 'null'
          invoice_notes:
            description: Notes added to the customer's invoices.
            type:
            - string
            - 'null'
          preferred_currency_code:
            description: Preferred currency code for transactions.
            type:
            - string
            - 'null'
          promotional_credits:
            description: Total amount of promotional credits used.
            type:
            - integer
            - 'null'
          unbilled_charges:
            description: Total amount of unbilled charges.
            type:
            - integer
            - 'null'
          refundable_credits:
            description: Total amount of refundable credits.
            type:
            - integer
            - 'null'
          excess_payments:
            description: Total amount of excess payments by the customer.
            type:
            - integer
            - 'null'
          deleted:
            description: Flag indicating if the customer is deleted.
            type:
            - boolean
            - 'null'
          registered_for_gst:
            description: Flag indicating if the customer is registered for GST.
            type:
            - boolean
            - 'null'
          consolidated_invoicing:
            description: Flag for consolidated invoicing setting.
            type:
            - boolean
            - 'null'
          customer_type:
            description: Type of customer (e.g., individual, business).
            type:
            - string
            - 'null'
          business_customer_without_vat_number:
            description: Flag indicating business customer without a VAT number.
            type:
            - boolean
            - 'null'
          client_profile_id:
            description: Client profile ID of the customer.
            type:
            - string
            - 'null'
          use_default_hierarchy_settings:
            description: Flag indicating if default hierarchy settings are used.
            type:
            - boolean
            - 'null'
          vat_number_prefix:
            description: Prefix for the VAT number.
            type:
            - string
            - 'null'
          business_entity_id:
            description: ID of the business entity.
            type:
            - string
            - 'null'
          channel:
            description: Channel through which the customer was acquired.
            type:
            - string
            - 'null'
          object:
            description: Object type for the customer.
            type:
            - string
            - 'null'
          mrr:
            description: Monthly recurring revenue generated from the customer.
            type:
            - integer
            - 'null'
          tax_providers_fields:
            description: Fields related to tax providers.
            type:
            - array
            - 'null'
          billing_address:
            description: Customer's billing address details.
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: First name in the billing address.
                type:
                - string
                - 'null'
              last_name:
                description: Last name in the billing address.
                type:
                - string
                - 'null'
              email:
                description: Email address for billing communication.
                type:
                - string
                - 'null'
              company:
                description: Company name in the billing address.
                type:
                - string
                - 'null'
              phone:
                description: Phone number for billing contact.
                type:
                - string
                - 'null'
              line1:
                description: Address line 1 in the billing address.
                type:
                - string
                - 'null'
              line2:
                description: Address line 2 in the billing address.
                type:
                - string
                - 'null'
              line3:
                description: Address line 3 in the billing address.
                type:
                - string
                - 'null'
              city:
                description: City in the billing address.
                type:
                - string
                - 'null'
              state_code:
                description: State code in the billing address.
                type:
                - string
                - 'null'
              state:
                description: State in the billing address.
                type:
                - string
                - 'null'
              country:
                description: Country in the billing address.
                type:
                - string
                - 'null'
              zip:
                description: Zip code in the billing address.
                type:
                - string
                - 'null'
              validation_status:
                description: Validation status of the billing address.
                type:
                - string
                - 'null'
              object:
                description: Object type for billing address.
                type:
                - string
                - 'null'
          referral_urls:
            description: List of referral URLs associated with the customer.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                external_customer_id:
                  description: External customer ID linked to the referral URL.
                  type:
                  - string
                  - 'null'
                referral_sharing_url:
                  description: URL for sharing the referral.
                  type:
                  - string
                  - 'null'
                created_at:
                  description: Date and time when the referral URL was created.
                  type:
                  - integer
                  - 'null'
                updated_at:
                  description: Date and time when the referral URL was last updated.
                  type:
                  - integer
                  - 'null'
                referral_campaign_id:
                  description: Campaign ID for the referral.
                  type:
                  - string
                  - 'null'
                referral_account_id:
                  description: Account ID associated with the referral.
                  type:
                  - string
                  - 'null'
                referral_external_campaign_id:
                  description: External campaign ID linked to the referral.
                  type:
                  - string
                  - 'null'
                referral_system:
                  description: System used for the referral.
                  type:
                  - string
                  - 'null'
          contacts:
            description: List of contact details associated with the customer.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the contact.
                  type:
                  - string
                  - 'null'
                first_name:
                  description: First name of the contact.
                  type:
                  - string
                  - 'null'
                last_name:
                  description: Last name of the contact.
                  type:
                  - string
                  - 'null'
                email:
                  description: Email address of the contact.
                  type:
                  - string
                  - 'null'
                phone:
                  description: Phone number of the contact.
                  type:
                  - string
                  - 'null'
                label:
                  description: Label for the contact.
                  type:
                  - string
                  - 'null'
                enabled:
                  description: Flag indicating contact is enabled.
                  type:
                  - boolean
                  - 'null'
                send_account_email:
                  description: Permission to send account emails to the contact.
                  type:
                  - boolean
                  - 'null'
                send_billing_email:
                  description: Permission to send billing emails to the contact.
                  type:
                  - boolean
                  - 'null'
                object:
                  description: Object type for contact.
                  type:
                  - string
                  - 'null'
          payment_method:
            description: Customer's preferred payment method details.
            type:
            - object
            - 'null'
            properties:
              type:
                description: Type of payment method.
                type:
                - string
                - 'null'
              gateway:
                description: Payment gateway used for transactions.
                type:
                - string
                - 'null'
              gateway_account_id:
                description: ID of the gateway account.
                type:
                - string
                - 'null'
              status:
                description: Status of the payment method.
                type:
                - string
                - 'null'
              reference_id:
                description: Reference ID for the payment method.
                type:
                - string
                - 'null'
              object:
                description: Object type for payment method.
                type:
                - string
                - 'null'
          balances:
            description: Customer's balance information related to their account.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                promotional_credits:
                  description: Amount of promotional credits.
                  type:
                  - integer
                  - 'null'
                excess_payments:
                  description: Amount of excess payments.
                  type:
                  - integer
                  - 'null'
                refundable_credits:
                  description: Amount of refundable credits.
                  type:
                  - integer
                  - 'null'
                unbilled_charges:
                  description: Amount of unbilled charges.
                  type:
                  - integer
                  - 'null'
                currency_code:
                  description: Currency code used for the transaction.
                  type:
                  - string
                  - 'null'
                balance_currency_code:
                  description: Currency code for the balance.
                  type:
                  - string
                  - 'null'
                object:
                  description: Object type for the balance.
                  type:
                  - string
                  - 'null'
          relationship:
            description: Details about the relationship of the customer to other entities,
              if any.
            type:
            - object
            - 'null'
            properties:
              parent_id:
                description: ID of the parent in the relationship.
                type:
                - string
                - 'null'
              payment_owner_id:
                description: ID of the payment owner in the relationship.
                type:
                - string
                - 'null'
              invoice_owner_id:
                description: ID of the invoice owner in the relationship.
                type:
                - string
                - 'null'
          parent_account_access:
            description: Information regarding the access rights of the parent account,
              if applicable.
            type:
            - object
            - 'null'
            properties:
              portal_edit_child_subscriptions:
                description: Permission to edit child subscriptions for the parent
                  account.
                type:
                - string
                - 'null'
              portal_download_child_invoices:
                description: Permission to download child invoices for the parent
                  account.
                type:
                - string
                - 'null'
              send_subscription_emails:
                description: Permission to send subscription emails for the parent
                  account.
                type:
                - boolean
                - 'null'
              send_invoice_emails:
                description: Permission to send invoice emails for the parent account.
                type:
                - boolean
                - 'null'
              send_payment_emails:
                description: Permission to send payment emails for the parent account.
                type:
                - boolean
                - 'null'
          child_account_access:
            description: Information regarding the access rights of child accounts
              linked to the customer's account.
            type:
            - object
            - 'null'
            properties:
              portal_edit_child_subscriptions:
                description: Permission to edit child subscriptions.
                type:
                - string
                - 'null'
              portal_download_child_invoices:
                description: Permission to download child invoices.
                type:
                - string
                - 'null'
              send_subscription_emails:
                description: Permission to send subscription emails.
                type:
                - boolean
                - 'null'
              send_invoice_emails:
                description: Permission to send invoice emails.
                type:
                - boolean
                - 'null'
              send_payment_emails:
                description: Permission to send payment emails.
                type:
                - boolean
                - 'null'
          card_status:
            description: Status of payment card associated with the customer.
            type:
            - string
            - 'null'
          meta_data:
            description: Additional metadata associated with the customer.
            type:
            - object
            - 'null'
            properties: {}
          custom_fields: _definitions.json#/definitions/custom_fields
  contact_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - http_codes:
              - 404
              action: IGNORE
              error_message: "Entity unavailable. Customer may have been deleted."
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
      partition_router:
        type: SubstreamPartitionRouter
        parent_stream_configs:
        - type: ParentStreamConfig
          stream:
            retriever:
              type: SimpleRetriever
              record_selector:
                type: RecordSelector
                extractor:
                  type: DpathExtractor
                  field_path:
                  - "list"
                  - "*"
                  - "{{ parameters.get('name') }}"
              paginator:
                type: DefaultPaginator
                pagination_strategy:
                  type: "CursorPagination"
                  cursor_value: "{{ response.get('next_offset')|tojson() }}"
                  stop_condition: "{{ not response.next_offset }}"
                  page_size_option:
                    type: RequestOption
                    inject_into: request_parameter
                    field_name: limit
                    page_size: 100
                page_token_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: offset
              requester:
                type: HttpRequester
                url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
                http_method: "GET"
                authenticator:
                  type: BasicHttpAuthenticator
                  username: "{{ config['site_api_key'] }}"
                error_handler:
                  type: CompositeErrorHandler
                  error_handlers:
                  - type: DefaultErrorHandler
                    response_filters:
                    - error_message_contains: "This API operation is not enabled for
                        this site"
                      action: IGNORE
                      error_message: "Stream is available only for Product Catalog
                        1.0"
                  - type: DefaultErrorHandler
                    backoff_strategies:
                    - type: WaitTimeFromHeader
                      header: "Retry-After"
                request_parameters:
                  sort_by[asc]: updated_at
                  include_deleted: "true"
                  updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
            transformations:
            - type: CustomTransformation
              class_name: source_declarative_manifest.components.CustomFieldTransformation
            incremental_sync:
              type: DatetimeBasedCursor
              start_datetime:
                datetime: "{{ format_datetime(config['start_date'], '%s') }}"
                datetime_format: "%s"
              end_datetime:
                datetime: "{{ now_utc().strftime('%s') }}"
                datetime_format: "%s"
              datetime_format: "%s"
              cursor_granularity: PT1S
              step: P1M
              cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
                }}"
            schema_loader:
              type: InlineSchemaLoader
              schema:
                $schema: http://json-schema.org/draft-07/schema#
                name: Customer
                type: object
                properties:
                  id:
                    description: Unique ID of the customer.
                    type:
                    - string
                    - 'null'
                  first_name:
                    description: First name of the customer.
                    type:
                    - string
                    - 'null'
                  last_name:
                    description: Last name of the customer.
                    type:
                    - string
                    - 'null'
                  email:
                    description: Email address of the customer.
                    type:
                    - string
                    - 'null'
                  phone:
                    description: Phone number of the customer.
                    type:
                    - string
                    - 'null'
                  company:
                    description: Company or organization name.
                    type:
                    - string
                    - 'null'
                  vat_number:
                    description: VAT number associated with the customer.
                    type:
                    - string
                    - 'null'
                  auto_collection:
                    description: Configures the automatic collection settings for
                      the customer.
                    type:
                    - string
                    - 'null'
                  offline_payment_method:
                    description: Offline payment method used by the customer.
                    type:
                    - string
                    - 'null'
                  net_term_days:
                    description: Number of days for net terms.
                    type:
                    - integer
                    - 'null'
                  vat_number_validated_time:
                    description: Date and time when the VAT number was validated.
                    type:
                    - integer
                    - 'null'
                  vat_number_status:
                    description: Status of the VAT number validation.
                    type:
                    - string
                    - 'null'
                  allow_direct_debit:
                    description: Indicates if direct debit is allowed for the customer.
                    type:
                    - boolean
                    - 'null'
                  is_location_valid:
                    description: Flag indicating if the customer location is valid.
                    type:
                    - boolean
                    - 'null'
                  created_at:
                    description: Date and time when the customer was created.
                    type:
                    - integer
                    - 'null'
                  created_from_ip:
                    description: IP address from which the customer was created.
                    type:
                    - string
                    - 'null'
                  exemption_details:
                    description: Details about any exemptions applicable to the customer's
                      account.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties: {}
                  taxability:
                    description: Taxability status of the customer.
                    type:
                    - string
                    - 'null'
                  entity_code:
                    description: Code for the customer entity.
                    type:
                    - string
                    - 'null'
                  exempt_number:
                    description: Exemption number for tax purposes.
                    type:
                    - string
                    - 'null'
                  resource_version:
                    description: Version of the customer's resource.
                    type:
                    - integer
                    - 'null'
                  updated_at:
                    description: Date and time when the customer record was last updated.
                    type:
                    - integer
                    - 'null'
                  locale:
                    description: Locale setting for the customer.
                    type:
                    - string
                    - 'null'
                  billing_date:
                    description: Date for billing cycle.
                    type:
                    - integer
                    - 'null'
                  billing_date_mode:
                    description: Mode for billing date calculation.
                    type:
                    - string
                    - 'null'
                  billing_day_of_week:
                    description: Day of the week for billing cycle.
                    type:
                    - string
                    - 'null'
                  billing_day_of_week_mode:
                    description: Mode for billing day of the week calculation.
                    type:
                    - string
                    - 'null'
                  billing_month:
                    description: Month for billing cycle.
                    type:
                    - integer
                    - 'null'
                  pii_cleared:
                    description: Flag indicating if PII (Personally Identifiable Information)
                      is cleared.
                    type:
                    - string
                    - 'null'
                  auto_close_invoices:
                    description: Flag to automatically close invoices for the customer.
                    type:
                    - boolean
                    - 'null'
                  fraud_flag:
                    description: Flag indicating if fraud is associated with the customer.
                    type:
                    - string
                    - 'null'
                  primary_payment_source_id:
                    description: ID of the primary payment source for the customer.
                    type:
                    - string
                    - 'null'
                  backup_payment_source_id:
                    description: ID of the backup payment source for the customer.
                    type:
                    - string
                    - 'null'
                  invoice_notes:
                    description: Notes added to the customer's invoices.
                    type:
                    - string
                    - 'null'
                  preferred_currency_code:
                    description: Preferred currency code for transactions.
                    type:
                    - string
                    - 'null'
                  promotional_credits:
                    description: Total amount of promotional credits used.
                    type:
                    - integer
                    - 'null'
                  unbilled_charges:
                    description: Total amount of unbilled charges.
                    type:
                    - integer
                    - 'null'
                  refundable_credits:
                    description: Total amount of refundable credits.
                    type:
                    - integer
                    - 'null'
                  excess_payments:
                    description: Total amount of excess payments by the customer.
                    type:
                    - integer
                    - 'null'
                  deleted:
                    description: Flag indicating if the customer is deleted.
                    type:
                    - boolean
                    - 'null'
                  registered_for_gst:
                    description: Flag indicating if the customer is registered for
                      GST.
                    type:
                    - boolean
                    - 'null'
                  consolidated_invoicing:
                    description: Flag for consolidated invoicing setting.
                    type:
                    - boolean
                    - 'null'
                  customer_type:
                    description: Type of customer (e.g., individual, business).
                    type:
                    - string
                    - 'null'
                  business_customer_without_vat_number:
                    description: Flag indicating business customer without a VAT number.
                    type:
                    - boolean
                    - 'null'
                  client_profile_id:
                    description: Client profile ID of the customer.
                    type:
                    - string
                    - 'null'
                  use_default_hierarchy_settings:
                    description: Flag indicating if default hierarchy settings are
                      used.
                    type:
                    - boolean
                    - 'null'
                  vat_number_prefix:
                    description: Prefix for the VAT number.
                    type:
                    - string
                    - 'null'
                  business_entity_id:
                    description: ID of the business entity.
                    type:
                    - string
                    - 'null'
                  channel:
                    description: Channel through which the customer was acquired.
                    type:
                    - string
                    - 'null'
                  object:
                    description: Object type for the customer.
                    type:
                    - string
                    - 'null'
                  mrr:
                    description: Monthly recurring revenue generated from the customer.
                    type:
                    - integer
                    - 'null'
                  tax_providers_fields:
                    description: Fields related to tax providers.
                    type:
                    - array
                    - 'null'
                  billing_address:
                    description: Customer's billing address details.
                    type:
                    - object
                    - 'null'
                    properties:
                      first_name:
                        description: First name in the billing address.
                        type:
                        - string
                        - 'null'
                      last_name:
                        description: Last name in the billing address.
                        type:
                        - string
                        - 'null'
                      email:
                        description: Email address for billing communication.
                        type:
                        - string
                        - 'null'
                      company:
                        description: Company name in the billing address.
                        type:
                        - string
                        - 'null'
                      phone:
                        description: Phone number for billing contact.
                        type:
                        - string
                        - 'null'
                      line1:
                        description: Address line 1 in the billing address.
                        type:
                        - string
                        - 'null'
                      line2:
                        description: Address line 2 in the billing address.
                        type:
                        - string
                        - 'null'
                      line3:
                        description: Address line 3 in the billing address.
                        type:
                        - string
                        - 'null'
                      city:
                        description: City in the billing address.
                        type:
                        - string
                        - 'null'
                      state_code:
                        description: State code in the billing address.
                        type:
                        - string
                        - 'null'
                      state:
                        description: State in the billing address.
                        type:
                        - string
                        - 'null'
                      country:
                        description: Country in the billing address.
                        type:
                        - string
                        - 'null'
                      zip:
                        description: Zip code in the billing address.
                        type:
                        - string
                        - 'null'
                      validation_status:
                        description: Validation status of the billing address.
                        type:
                        - string
                        - 'null'
                      object:
                        description: Object type for billing address.
                        type:
                        - string
                        - 'null'
                  referral_urls:
                    description: List of referral URLs associated with the customer.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        external_customer_id:
                          description: External customer ID linked to the referral
                            URL.
                          type:
                          - string
                          - 'null'
                        referral_sharing_url:
                          description: URL for sharing the referral.
                          type:
                          - string
                          - 'null'
                        created_at:
                          description: Date and time when the referral URL was created.
                          type:
                          - integer
                          - 'null'
                        updated_at:
                          description: Date and time when the referral URL was last
                            updated.
                          type:
                          - integer
                          - 'null'
                        referral_campaign_id:
                          description: Campaign ID for the referral.
                          type:
                          - string
                          - 'null'
                        referral_account_id:
                          description: Account ID associated with the referral.
                          type:
                          - string
                          - 'null'
                        referral_external_campaign_id:
                          description: External campaign ID linked to the referral.
                          type:
                          - string
                          - 'null'
                        referral_system:
                          description: System used for the referral.
                          type:
                          - string
                          - 'null'
                  contacts:
                    description: List of contact details associated with the customer.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          description: ID of the contact.
                          type:
                          - string
                          - 'null'
                        first_name:
                          description: First name of the contact.
                          type:
                          - string
                          - 'null'
                        last_name:
                          description: Last name of the contact.
                          type:
                          - string
                          - 'null'
                        email:
                          description: Email address of the contact.
                          type:
                          - string
                          - 'null'
                        phone:
                          description: Phone number of the contact.
                          type:
                          - string
                          - 'null'
                        label:
                          description: Label for the contact.
                          type:
                          - string
                          - 'null'
                        enabled:
                          description: Flag indicating contact is enabled.
                          type:
                          - boolean
                          - 'null'
                        send_account_email:
                          description: Permission to send account emails to the contact.
                          type:
                          - boolean
                          - 'null'
                        send_billing_email:
                          description: Permission to send billing emails to the contact.
                          type:
                          - boolean
                          - 'null'
                        object:
                          description: Object type for contact.
                          type:
                          - string
                          - 'null'
                  payment_method:
                    description: Customer's preferred payment method details.
                    type:
                    - object
                    - 'null'
                    properties:
                      type:
                        description: Type of payment method.
                        type:
                        - string
                        - 'null'
                      gateway:
                        description: Payment gateway used for transactions.
                        type:
                        - string
                        - 'null'
                      gateway_account_id:
                        description: ID of the gateway account.
                        type:
                        - string
                        - 'null'
                      status:
                        description: Status of the payment method.
                        type:
                        - string
                        - 'null'
                      reference_id:
                        description: Reference ID for the payment method.
                        type:
                        - string
                        - 'null'
                      object:
                        description: Object type for payment method.
                        type:
                        - string
                        - 'null'
                  balances:
                    description: Customer's balance information related to their account.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        promotional_credits:
                          description: Amount of promotional credits.
                          type:
                          - integer
                          - 'null'
                        excess_payments:
                          description: Amount of excess payments.
                          type:
                          - integer
                          - 'null'
                        refundable_credits:
                          description: Amount of refundable credits.
                          type:
                          - integer
                          - 'null'
                        unbilled_charges:
                          description: Amount of unbilled charges.
                          type:
                          - integer
                          - 'null'
                        currency_code:
                          description: Currency code used for the transaction.
                          type:
                          - string
                          - 'null'
                        balance_currency_code:
                          description: Currency code for the balance.
                          type:
                          - string
                          - 'null'
                        object:
                          description: Object type for the balance.
                          type:
                          - string
                          - 'null'
                  relationship:
                    description: Details about the relationship of the customer to
                      other entities, if any.
                    type:
                    - object
                    - 'null'
                    properties:
                      parent_id:
                        description: ID of the parent in the relationship.
                        type:
                        - string
                        - 'null'
                      payment_owner_id:
                        description: ID of the payment owner in the relationship.
                        type:
                        - string
                        - 'null'
                      invoice_owner_id:
                        description: ID of the invoice owner in the relationship.
                        type:
                        - string
                        - 'null'
                  parent_account_access:
                    description: Information regarding the access rights of the parent
                      account, if applicable.
                    type:
                    - object
                    - 'null'
                    properties:
                      portal_edit_child_subscriptions:
                        description: Permission to edit child subscriptions for the
                          parent account.
                        type:
                        - string
                        - 'null'
                      portal_download_child_invoices:
                        description: Permission to download child invoices for the
                          parent account.
                        type:
                        - string
                        - 'null'
                      send_subscription_emails:
                        description: Permission to send subscription emails for the
                          parent account.
                        type:
                        - boolean
                        - 'null'
                      send_invoice_emails:
                        description: Permission to send invoice emails for the parent
                          account.
                        type:
                        - boolean
                        - 'null'
                      send_payment_emails:
                        description: Permission to send payment emails for the parent
                          account.
                        type:
                        - boolean
                        - 'null'
                  child_account_access:
                    description: Information regarding the access rights of child
                      accounts linked to the customer's account.
                    type:
                    - object
                    - 'null'
                    properties:
                      portal_edit_child_subscriptions:
                        description: Permission to edit child subscriptions.
                        type:
                        - string
                        - 'null'
                      portal_download_child_invoices:
                        description: Permission to download child invoices.
                        type:
                        - string
                        - 'null'
                      send_subscription_emails:
                        description: Permission to send subscription emails.
                        type:
                        - boolean
                        - 'null'
                      send_invoice_emails:
                        description: Permission to send invoice emails.
                        type:
                        - boolean
                        - 'null'
                      send_payment_emails:
                        description: Permission to send payment emails.
                        type:
                        - boolean
                        - 'null'
                  card_status:
                    description: Status of payment card associated with the customer.
                    type:
                    - string
                    - 'null'
                  meta_data:
                    description: Additional metadata associated with the customer.
                    type:
                    - object
                    - 'null'
                    properties: {}
                  custom_fields: _definitions.json#/definitions/custom_fields
          parent_key: id
          partition_field: id
          incremental_dependency: true
    transformations:
    - type: AddFields
      fields:
      - path:
        - "customer_id"
        value: "{{ stream_slice.id }}"
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Customer
        type: object
        properties:
          email:
            description: Email address of the contact.
            type:
            - string
            - 'null'
          enabled:
            description: Indicates whether the contact is currently enabled or disabled.
            type:
            - boolean
            - 'null'
          first_name:
            description: First name of the contact.
            type:
            - string
            - 'null'
          id:
            description: Unique identifier of the contact.
            type:
            - string
            - 'null'
          customer_id:
            description: The unique identifier of the customer associated with the
              contact.
            type:
            - string
            - 'null'
          label:
            description: A label assigned to the contact for easy identification.
            type:
            - string
            - 'null'
          last_name:
            description: Last name of the contact.
            type:
            - string
            - 'null'
          object:
            description: Type of object, in this case, it will be 'contact'.
            type:
            - string
            - 'null'
          send_account_email:
            description: Indicates whether account-related emails are enabled for
              the contact.
            type:
            - boolean
            - 'null'
          send_billing_email:
            description: Indicates whether billing-related emails are enabled for
              the contact.
            type:
            - boolean
            - 'null'
          phone:
            description: Phone number of the contact.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  coupon_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Coupon
        type: object
        properties:
          id:
            description: Unique identifier for the coupon.
            type:
            - string
            - 'null'
          name:
            description: Name of the coupon.
            type:
            - string
            - 'null'
          invoice_name:
            description: Name displayed on invoices when the coupon is used.
            type:
            - string
            - 'null'
          discount_type:
            description: Type of discount (e.g. fixed, percentage).
            type:
            - string
            - 'null'
          discount_percentage:
            description: Percentage discount applied by the coupon.
            type:
            - number
            - 'null'
          discount_amount:
            description: The fixed discount amount applied by the coupon.
            type:
            - integer
            - 'null'
          currency_code:
            description: The currency code for the coupon (e.g. USD, EUR).
            type:
            - string
            - 'null'
          duration_type:
            description: Type of duration (e.g. forever, one-time).
            type:
            - string
            - 'null'
          duration_month:
            description: Duration of the coupon in months.
            type:
            - integer
            - 'null'
          valid_till:
            description: Date until which the coupon is valid for use.
            type:
            - integer
            - 'null'
          max_redemptions:
            description: Maximum number of times the coupon can be redeemed.
            type:
            - integer
            - 'null'
          status:
            description: Current status of the coupon (e.g. active, inactive).
            type:
            - string
            - 'null'
          apply_discount_on:
            description: Determines where the discount is applied on (e.g. subtotal,
              total).
            type:
            - string
            - 'null'
          apply_on:
            description: Specify on what type of items the coupon applies (e.g. subscription,
              addon).
            type:
            - string
            - 'null'
          created_at:
            description: Timestamp of the coupon creation.
            type:
            - integer
            - 'null'
          archived_at:
            description: Timestamp when the coupon was archived.
            type:
            - integer
            - 'null'
          resource_version:
            description: Version of the resource.
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp when the coupon was last updated.
            type:
            - integer
            - 'null'
          period:
            description: Duration or frequency for which the coupon is valid.
            type:
            - integer
            - 'null'
          period_unit:
            description: Unit of the period (e.g. days, weeks).
            type:
            - string
            - 'null'
          redemptions:
            description: Number of times the coupon has been redeemed.
            type:
            - integer
            - 'null'
          invoice_notes:
            description: Additional notes displayed on invoices when the coupon is
              used.
            type:
            - string
            - 'null'
          object:
            description: Type of object (usually 'coupon').
            type:
            - string
            - 'null'
          item_constraints:
            description: Constraints related to the items
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_type:
                  description: The type of item to which the constraint is applied.
                  type:
                  - string
                  - 'null'
                constraint:
                  description: Specific constraints applied to items.
                  type:
                  - string
                  - 'null'
                item_price_ids:
                  description: IDs of the items with pricing constraints
                  type:
                  - array
                  - 'null'
                  items: {}
          item_constraint_criteria:
            description: Criteria for item constraints
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_type:
                  description: The type of item the coupon should be applied to.
                  type:
                  - string
                  - 'null'
                currencies:
                  description: Supported currencies for the item
                  type:
                  - array
                  - 'null'
                  items: {}
                item_family_ids:
                  description: Allowed item family IDs
                  type:
                  - array
                  - 'null'
                  items: {}
                item_price_periods:
                  description: Valid price periods for the item
                  type:
                  - array
                  - 'null'
                  items: {}
          coupon_constraints:
            description: Represents the constraints associated with the coupon
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                entity_type:
                  description: The type of entity the coupon is applicable to (e.g.
                    customer, subscription).
                  type:
                  - string
                  - 'null'
                type:
                  description: Type of constraint applied (e.g. specific item, any
                    item).
                  type:
                  - string
                  - 'null'
                vlaue:
                  description: The specific value associated with the constraint.
                  type:
                  - string
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  credit_note_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: date
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Credit Note
        type: object
        properties:
          id:
            description: The unique identifier for the credit note.
            type:
            - string
            - 'null'
          customer_id:
            description: The ID of the customer associated with the credit note.
            type:
            - string
            - 'null'
          subscription_id:
            description: The ID of the subscription associated with the credit note.
            type:
            - string
            - 'null'
          reference_invoice_id:
            description: The ID of the invoice this credit note references.
            type:
            - string
            - 'null'
          type:
            description: The type of credit note.
            type:
            - string
            - 'null'
          reason_code:
            description: The reason code for creating the credit note.
            type:
            - string
            - 'null'
          status:
            description: The status of the credit note.
            type:
            - string
            - 'null'
          vat_number:
            description: VAT number associated with the credit note.
            type:
            - string
            - 'null'
          date:
            description: The date when the credit note was created.
            type:
            - integer
            - 'null'
          price_type:
            description: The type of pricing used for the credit note.
            type:
            - string
            - 'null'
          currency_code:
            description: The currency code for the credit note.
            type:
            - string
            - 'null'
          total:
            description: The total amount of the credit note.
            type:
            - integer
            - 'null'
          amount_allocated:
            description: The amount of credits allocated.
            type:
            - integer
            - 'null'
          amount_refunded:
            description: The amount of credits refunded.
            type:
            - integer
            - 'null'
          amount_available:
            description: The amount of credits available.
            type:
            - integer
            - 'null'
          refunded_at:
            description: The date when the credit note was refunded.
            type:
            - integer
            - 'null'
          voided_at:
            description: The date when the credit note was voided.
            type:
            - integer
            - 'null'
          generated_at:
            description: The date when the credit note was generated.
            type:
            - integer
            - 'null'
          resource_version:
            description: The version of the credit note resource.
            type:
            - integer
            - 'null'
          updated_at:
            description: The date when the credit note was last updated.
            type:
            - integer
            - 'null'
          sub_total:
            description: The subtotal amount of the credit note.
            type:
            - integer
            - 'null'
          sub_total_in_local_currency:
            description: The subtotal amount in local currency.
            type:
            - integer
            - 'null'
          total_in_local_currency:
            description: The total amount in local currency.
            type:
            - integer
            - 'null'
          local_currency_code:
            description: The local currency code for the credit note.
            type:
            - string
            - 'null'
          round_off_amount:
            description: Amount rounded off for currency conversions.
            type:
            - integer
            - 'null'
          fractional_correction:
            description: Fractional correction for rounding off decimals.
            type:
            - integer
            - 'null'
            maximum: 50000
          deleted:
            description: Indicates if the credit note has been deleted.
            type:
            - boolean
            - 'null'
          create_reason_code:
            description: The reason code for creating the credit note.
            type:
            - string
            - 'null'
          vat_number_prefix:
            description: Prefix for the VAT number.
            type:
            - string
            - 'null'
          base_currency_code:
            description: The base currency code for the credit note.
            type:
            - string
            - 'null'
          business_entity_id:
            description: The ID of the business entity associated with the credit
              note.
            type:
            - string
            - 'null'
          channel:
            description: The channel through which the credit note was created.
            type:
            - string
            - 'null'
          exchange_rate:
            description: The exchange rate used for currency conversion.
            type:
            - number
            - 'null'
          is_digital:
            description: Indicates if the credit note is in digital format.
            type:
            - boolean
            - 'null'
          object:
            description: The object type of the credit note.
            type:
            - string
            - 'null'
          is_vat_moss_registered:
            description: Indicates if VAT MOSS registration applies.
            type:
            - boolean
            - 'null'
            $comment: Only available for accounts which have enabled taxes for EU
              Region for taxes.
          customer_notes:
            description: Notes provided by the customer for the credit note.
            type:
            - string
            - 'null'
          line_items:
            description: Details of line items in the credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The ID of the line item
                  type:
                  - string
                  - 'null'
                subscription_id:
                  description: The ID of the subscription associated with the line
                    item
                  type:
                  - string
                  - 'null'
                date_from:
                  description: The start date for the line item
                  type:
                  - integer
                  - 'null'
                date_to:
                  description: The end date for the line item
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  description: The amount per unit of the line item
                  type:
                  - integer
                  - 'null'
                quantity:
                  description: The quantity of the line item
                  type:
                  - integer
                  - 'null'
                amount:
                  description: The total amount for the line item
                  type:
                  - integer
                  - 'null'
                pricing_model:
                  description: The pricing model for the line item
                  type:
                  - string
                  - 'null'
                is_taxed:
                  description: Flag indicating if the line item is taxed
                  type:
                  - boolean
                  - 'null'
                tax_amount:
                  description: The amount of tax applied to the line item
                  type:
                  - integer
                  - 'null'
                tax_rate:
                  description: The tax rate applied to the line item
                  type:
                  - number
                  - 'null'
                unit_amount_in_decimal:
                  description: The amount per unit in decimal format
                  type:
                  - string
                  - 'null'
                quantity_in_decimal:
                  description: The quantity of the line item in decimal format
                  type:
                  - string
                  - 'null'
                amount_in_decimal:
                  description: The total amount in decimal format
                  type:
                  - string
                  - 'null'
                discount_amount:
                  description: The amount of discount applied to the line item
                  type:
                  - integer
                  - 'null'
                item_level_discount_amount:
                  description: The amount of item level discount applied
                  type:
                  - integer
                  - 'null'
                description:
                  description: The description of the line item
                  type:
                  - string
                  - 'null'
                entity_description:
                  description: The description of the entity associated with the line
                    item
                  type:
                  - string
                  - 'null'
                entity_type:
                  description: The type of entity associated with the line item
                  type:
                  - string
                  - 'null'
                tax_exempt_reason:
                  description: The reason for tax exemption
                  type:
                  - string
                  - 'null'
                entity_id:
                  description: The ID of the entity associated with the line item
                  type:
                  - string
                  - 'null'
                customer_id:
                  description: The ID of the customer associated with the line item
                  type:
                  - string
                  - 'null'
                metered:
                  description: Flag indicating if the line item is metered
                  type:
                  - boolean
                  - 'null'
                reference_line_item_id:
                  description: The reference ID of the line item
                  type:
                  - string
                  - 'null'
                object:
                  description: The object type
                  type:
                  - string
                  - 'null'
          discounts:
            description: Details of discounts applied to the credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                amount:
                  description: The amount of discount
                  type:
                  - integer
                  - 'null'
                description:
                  description: The description of the discount
                  type:
                  - string
                  - 'null'
                entity_type:
                  description: The type of entity to which the discount applies
                  type:
                  - string
                  - 'null'
                entity_id:
                  description: The ID of the entity to which the discount applies
                  type:
                  - string
                  - 'null'
          line_item_discounts:
            description: Details of discounts applied at the line item level in the
              credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: The ID of the line item to which the discount applies
                  type:
                  - string
                  - 'null'
                discount_type:
                  description: The type of discount applied
                  type:
                  - string
                  - 'null'
                discount_amount:
                  description: The amount of the line item discount
                  type:
                  - integer
                  - 'null'
                entity_id:
                  description: The ID of the entity to which the line item discount
                    applies
                  type:
                  - string
                  - 'null'
          line_item_tiers:
            description: Details of tiers applied to line items in the credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: The ID of the line item to which the tier applies
                  type:
                  - string
                  - 'null'
                starting_unit:
                  description: The starting unit of the tier
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: The ending unit of the tier
                  type:
                  - integer
                  - 'null'
                quantity_used:
                  description: The quantity used under the tier
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  description: The amount per unit of the tier
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  description: The starting unit in decimal format
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  description: The ending unit in decimal format
                  type:
                  - string
                  - 'null'
                quantity_used_in_decimal:
                  description: The quantity used in decimal format
                  type:
                  - string
                  - 'null'
                unit_amount_in_decimal:
                  description: The amount per unit in decimal format
                  type:
                  - string
                  - 'null'
          taxes:
            description: List of taxes applied to the credit note
            type:
            - array
            - 'null'
            items:
              description: Details of each individual tax applied
              type:
              - object
              - 'null'
              properties:
                name:
                  description: Name of the tax.
                  type:
                  - string
                  - 'null'
                amount:
                  description: The amount of taxes.
                  type:
                  - integer
                  - 'null'
                description:
                  description: Description of the tax.
                  type:
                  - string
                  - 'null'
          line_item_taxes:
            description: Details of taxes applied at the line item level in the credit
              note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: The ID of the line item to which the tax applies
                  type:
                  - string
                  - 'null'
                tax_name:
                  description: The name of the tax
                  type:
                  - string
                  - 'null'
                tax_rate:
                  description: The tax rate applied
                  type:
                  - number
                  - 'null'
                  maximum: 100.0
                is_partial_tax_applied:
                  description: Flag indicating if partial tax is applied
                  type:
                  - boolean
                  - 'null'
                is_non_compliance_tax:
                  description: Flag indicating if the tax is non-compliant
                  type:
                  - boolean
                  - 'null'
                taxable_amount:
                  description: The amount on which tax is calculated
                  type:
                  - integer
                  - 'null'
                tax_amount:
                  description: The amount of tax
                  type:
                  - integer
                  - 'null'
                tax_juris_type:
                  description: The type of jurisdiction for the tax
                  type:
                  - string
                  - 'null'
                tax_juris_name:
                  description: The jurisdiction name for the tax
                  type:
                  - string
                  - 'null'
                tax_juris_code:
                  description: The jurisdiction code for the tax
                  type:
                  - string
                  - 'null'
                tax_amount_in_local_currency:
                  description: The amount of tax in local currency
                  type:
                  - integer
                  - 'null'
                local_currency-code:
                  description: The currency code for local currency
                  type:
                  - string
                  - 'null'
          linked_refunds:
            description: Details of linked refunds to the credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                txn_id:
                  description: The ID of the refund transaction
                  type:
                  - string
                  - 'null'
                applied_amount:
                  description: The amount applied from the refund
                  type:
                  - integer
                  - 'null'
                applied_at:
                  description: The date and time the refund amount was applied
                  type:
                  - integer
                  - 'null'
                txn_status:
                  description: The status of the refund transaction
                  type:
                  - string
                  - 'null'
                txn_date:
                  description: The date of the refund transaction
                  type:
                  - integer
                  - 'null'
                txn_amount:
                  description: The total transaction amount for the refund
                  type:
                  - integer
                  - 'null'
                refund_reason_code:
                  description: The reason code for the refund
                  type:
                  - string
                  - 'null'
          linked_tax_withheld_refunds:
            description: Details of linked tax withheld refunds to the credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The ID of the tax withheld refund
                  type:
                  - string
                  - 'null'
                amount:
                  description: The amount of tax withheld refund
                  type:
                  - integer
                  - 'null'
                description:
                  description: The description of the tax withheld refund
                  type:
                  - string
                  - 'null'
                date:
                  description: The date of the tax withheld refund
                  type:
                  - integer
                  - 'null'
                reference_number:
                  description: The reference number of the tax withheld refund
                  type:
                  - string
                  - 'null'
          allocations:
            description: Details of allocations associated with the credit note
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                invoice_id:
                  description: The ID of the invoice
                  type:
                  - string
                  - 'null'
                allocated_amount:
                  description: The amount allocated in the allocation
                  type:
                  - integer
                  - 'null'
                allocated_at:
                  description: The date and time the amount was allocated
                  type:
                  - integer
                  - 'null'
                invoice_date:
                  description: The date of the invoice
                  type:
                  - integer
                  - 'null'
                invoice_status:
                  description: The status of the invoice
                  type:
                  - string
                  - 'null'
          shipping_address:
            description: Details of the shipping address associated with the credit
              note
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: The first name in the shipping address
                type:
                - string
                - 'null'
              last_name:
                description: The last name in the shipping address
                type:
                - string
                - 'null'
              email:
                description: The email address in the shipping address
                type:
                - string
                - 'null'
              company:
                description: The company name in the shipping address
                type:
                - string
                - 'null'
              phone:
                description: The phone number in the shipping address
                type:
                - string
                - 'null'
              line1:
                description: The first line of the address
                type:
                - string
                - 'null'
              line2:
                description: The second line of the address
                type:
                - string
                - 'null'
              line3:
                description: The third line of the address
                type:
                - string
                - 'null'
              city:
                description: The city in the shipping address
                type:
                - string
                - 'null'
              state_code:
                description: The state code in the shipping address
                type:
                - string
                - 'null'
              state:
                description: The state in the shipping address
                type:
                - string
                - 'null'
              country:
                description: The country in the shipping address
                type:
                - string
                - 'null'
              zip:
                description: The zip code in the shipping address
                type:
                - string
                - 'null'
              validation_status:
                description: The validation status of the address
                type:
                - string
                - 'null'
          billing_address:
            description: Details of the billing address associated with the credit
              note
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: The first name in the billing address
                type:
                - string
                - 'null'
              last_name:
                description: The last name in the billing address
                type:
                - string
                - 'null'
              email:
                description: The email address in the billing address
                type:
                - string
                - 'null'
              company:
                description: The company name in the billing address
                type:
                - string
                - 'null'
              phone:
                description: The phone number in the billing address
                type:
                - string
                - 'null'
              line1:
                description: The first line of the address
                type:
                - string
                - 'null'
              line2:
                description: The second line of the address
                type:
                - string
                - 'null'
              line3:
                description: The third line of the address
                type:
                - string
                - 'null'
              city:
                description: The city in the billing address
                type:
                - string
                - 'null'
              state_code:
                description: The state code in the billing address
                type:
                - string
                - 'null'
              state:
                description: The state in the billing address
                type:
                - string
                - 'null'
              country:
                description: The country in the billing address
                type:
                - string
                - 'null'
              zip:
                description: The zip code in the billing address
                type:
                - string
                - 'null'
              validation_status:
                description: The validation status of the address
                type:
                - string
                - 'null'
              object:
                description: The object type
                type:
                - string
                - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  event_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: occurred_at
          occurred_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Event
        type: object
        properties:
          id:
            description: Unique identifier for the event data record.
            type:
            - string
            - 'null'
          occurred_at:
            description: The datetime when the event occurred.
            type:
            - integer
            - 'null'
          source:
            description: The source or origin of the event data.
            type:
            - string
            - 'null'
          user:
            description: Information about the user or entity associated with the
              event.
            type:
            - string
            - 'null'
          event_type:
            description: The type or category of the event.
            type:
            - string
            - 'null'
          api_version:
            description: The version of the Chargebee API being used to fetch the
              event data.
            type:
            - string
            - 'null'
          webhook_status:
            description: The status of the webhook execution for the event.
            type:
            - string
            - 'null'
          content:
            description: The specific content or information associated with the event.
            type:
            - object
            - 'null'
          object:
            description: The object or entity that the event is triggered for.
            type:
            - string
            - 'null'
          webhooks:
            description: List of webhooks associated with the event.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: Unique identifier for the webhook.
                  type:
                  - string
                  - 'null'
                webhook_status:
                  description: The status of the individual webhook related to the
                    event.
                  type:
                  - string
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  gift_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
        record_filter:
          condition: "{{ record['updated_at'] >= ( stream_state.get('prior_state',
            {}).get('updated_at', 0) if stream_state else stream_slice.get('prior_state',
            {}).get('updated_at', 0) ) }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: CustomIncrementalSync
      class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
      cursor_field: "updated_at"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Gift
        type: object
        properties:
          id:
            description: Unique ID of the gift.
            type:
            - string
            - 'null'
          status:
            description: Status of the gift.
            type:
            - string
            - 'null'
          scheduled_at:
            description: Timestamp indicating when the gift is scheduled.
            type:
            - integer
            - 'null'
          auto_claim:
            description: Indicates if the gift is set to be automatically claimed
              by the recipient.
            type:
            - boolean
            - 'null'
          no_expiry:
            description: Indicates if the gift has no expiry.
            type:
            - boolean
            - 'null'
          claim_expiry_date:
            description: The date when the gift claim expires.
            type:
            - integer
            - 'null'
          resource_version:
            description: Version of the resource related to the gift.
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp of when the gift data was last updated.
            type:
            - integer
            - 'null'
          gifter:
            description: Information about the person who gave the gift
            type:
            - object
            - 'null'
            properties:
              customer_id:
                description: The ID of the customer who sent the gift.
                type:
                - string
                - 'null'
              invoice_id:
                description: The ID of the invoice associated with the gift.
                type:
                - string
                - 'null'
              signature:
                description: Signature or identifier of the gift sender.
                type:
                - string
                - 'null'
              note:
                description: Any note attached to the gift from the sender.
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the gift sender.
                type:
                - string
                - 'null'
          gift_receiver:
            description: Information about the receiver of the gift
            type:
            - object
            - 'null'
            properties:
              customer_id:
                description: The ID of the customer who receives the gift.
                type:
                - string
                - 'null'
              subscription_id:
                description: The ID of the subscription associated with the gift receiver.
                type:
                - string
                - 'null'
              first_name:
                description: First name of the gift recipient.
                type:
                - string
                - 'null'
              last_name:
                description: Last name of the gift recipient.
                type:
                - string
                - 'null'
              email:
                description: Email of the gift recipient.
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the gift receiver.
                type:
                - string
                - 'null'
          gift_timelines:
            description: Timeline information related to the gift
            type:
            - array
            - 'null'
            items:
              description: Details of each event in the gift timeline
              type:
              - object
              - 'null'
              properties:
                status:
                  description: Status of the timeline event.
                  type:
                  - string
                  - 'null'
                occurred_at:
                  description: Timestamp of when the timeline event occurred.
                  type:
                  - integer
                  - 'null'
                object:
                  description: Type of object representing the timeline item.
                  type:
                  - string
                  - 'null'
          object:
            description: Type of object representing the gift.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  order_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Order
        type: object
        additionalProperties: true
        properties:
          id:
            description: Unique identifier for the order.
            type:
            - string
            - 'null'
          document_number:
            description: Unique document number associated with the order.
            type:
            - string
            - 'null'
          invoice_id:
            description: Identifier for the invoice associated with the order.
            type:
            - string
            - 'null'
          subscription_id:
            description: Identifier for the subscription associated with the order.
            type:
            - string
            - 'null'
          customer_id:
            description: Identifier for the customer placing the order.
            type:
            - string
            - 'null'
          status:
            description: Current status of the order.
            type:
            - string
            - 'null'
          cancellation_reason:
            description: Reason for order cancellation.
            type:
            - string
            - 'null'
          payment_status:
            description: Status of payment for the order.
            type:
            - string
            - 'null'
          order_type:
            description: Type of order such as purchase order or sales order.
            type:
            - string
            - 'null'
          price_type:
            description: Type of pricing used for the order.
            type:
            - string
            - 'null'
          reference_id:
            description: Reference identifier for the order.
            type:
            - string
            - 'null'
          fulfillment_status:
            description: Status of fulfillment for the order.
            type:
            - string
            - 'null'
          order_date:
            description: Date when the order was created.
            type:
            - integer
            - 'null'
          shipping_date:
            description: Date when the order is scheduled for shipping.
            type:
            - integer
            - 'null'
          note:
            description: Additional notes or comments for the order.
            type:
            - string
            - 'null'
          tracking_id:
            description: Tracking identifier for the order shipment.
            type:
            - string
            - 'null'
          tracking_url:
            description: URL for tracking the order shipment.
            type:
            - string
            - 'null'
          batch_id:
            description: Unique identifier for the batch the order belongs to.
            type:
            - string
            - 'null'
          created_by:
            description: User or system that created the order.
            type:
            - string
            - 'null'
          shipment_carrier:
            description: Carrier for shipping the order.
            type:
            - string
            - 'null'
          invoice_round_off_amount:
            description: Round-off amount applied to the invoice.
            type:
            - integer
            - 'null'
          tax:
            description: Total tax amount for the order.
            type:
            - integer
            - 'null'
          amount_paid:
            description: Amount paid for the order.
            type:
            - integer
            - 'null'
          amount_adjusted:
            description: Adjusted amount for the order.
            type:
            - integer
            - 'null'
          refundable_credits_issued:
            description: Credits already issued for refund for the whole order.
            type:
            - integer
            - 'null'
          refundable_credits:
            description: Credits that can be refunded for the whole order.
            type:
            - integer
            - 'null'
          rounding_adjustement:
            description: Adjustment made for rounding off the order amount.
            type:
            - integer
            - 'null'
          paid_on:
            description: Timestamp when the order was paid for.
            type:
            - integer
            - 'null'
          shipping_cut_off_date:
            description: Date indicating the shipping cut-off for the order.
            type:
            - integer
            - 'null'
          created_at:
            description: Timestamp when the order was created.
            type:
            - integer
            - 'null'
          status_update_at:
            description: Timestamp when the status of the order was last updated.
            type:
            - integer
            - 'null'
          delivered_at:
            description: Timestamp when the order was delivered.
            type:
            - integer
            - 'null'
          shipped_at:
            description: Timestamp when the order was shipped.
            type:
            - integer
            - 'null'
          resource_version:
            description: Version of the resource or order data.
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp when the order data was last updated.
            type:
            - integer
            - 'null'
          cancelled_at:
            description: Timestamp when the order was cancelled.
            type:
            - integer
            - 'null'
          resent_status:
            description: Status of the resent order.
            type:
            - string
            - 'null'
          is_resent:
            description: Flag indicating if the order has been resent.
            type:
            - boolean
            - 'null'
          original_order_id:
            description: Identifier for the original order if this is a modified order.
            type:
            - string
            - 'null'
          discount:
            description: Discount amount applied to the order.
            type:
            - integer
            - 'null'
          sub_total:
            description: Sub-total amount for the order before applying taxes or discounts.
            type:
            - integer
            - 'null'
          total:
            description: Total amount including taxes and discounts for the order.
            type:
            - integer
            - 'null'
          deleted:
            description: Flag indicating if the order has been deleted.
            type:
            - boolean
            - 'null'
          currency_code:
            description: Currency code used for the order.
            type:
            - string
            - 'null'
          is_gifted:
            description: Flag indicating if the order is a gift.
            type:
            - boolean
            - 'null'
          gift_note:
            description: Note attached to any gift in the order.
            type:
            - string
            - 'null'
          gift_id:
            description: Identifier for any gift associated with the order.
            type:
            - string
            - 'null'
          resend_reason:
            description: Reason for resending the order.
            type:
            - string
            - 'null'
          business_entity_id:
            description: Identifier for the business entity associated with the order.
            type:
            - string
            - 'null'
          base_currency_code:
            description: The base currency code used for the order.
            type:
            - string
            - 'null'
          exchange_rate:
            description: Rate used for currency exchange in the order.
            type:
            - number
            - 'null'
          object:
            description: Type of object representing an order in the system.
            type:
            - string
            - 'null'
          order_line_items:
            description: List of line items in the order
            type:
            - array
            - 'null'
            items:
              description: Details of a particular line item
              type:
              - object
              - 'null'
              properties:
                id:
                  description: Unique identifier for the line item.
                  type:
                  - string
                  - 'null'
                invoice_id:
                  description: Identifier for the invoice associated with the line
                    item.
                  type:
                  - string
                  - 'null'
                invoice_line_item_id:
                  description: Identifier for the invoice line item associated with
                    the line item.
                  type:
                  - string
                  - 'null'
                unit_price:
                  description: Unit price of the line item.
                  type:
                  - integer
                  - 'null'
                description:
                  description: Description of the line item.
                  type:
                  - string
                  - 'null'
                amount:
                  description: Total amount for the line item.
                  type:
                  - integer
                  - 'null'
                fulfillment_quantity:
                  description: Quantity fulfilled for the line item.
                  type:
                  - integer
                  - 'null'
                fulfillment_amount:
                  description: Amount fulfilled for the line item.
                  type:
                  - integer
                  - 'null'
                tax_amount:
                  description: Tax amount applied to the line item.
                  type:
                  - integer
                  - 'null'
                amount_paid:
                  description: Amount paid for the line item.
                  type:
                  - integer
                  - 'null'
                amount_adjusted:
                  description: Adjusted amount for the line item.
                  type:
                  - integer
                  - 'null'
                refundable_credits_issued:
                  description: Credits already issued for refund for the line item.
                  type:
                  - integer
                  - 'null'
                refundable_credits:
                  description: Credits that can be refunded for the line item.
                  type:
                  - integer
                  - 'null'
                is_shippable:
                  description: Flag indicating if the line item is shippable.
                  type:
                  - boolean
                  - 'null'
                sku:
                  description: Stock Keeping Unit (SKU) associated with the line item.
                  type:
                  - string
                  - 'null'
                status:
                  description: Status of the line item.
                  type:
                  - string
                  - 'null'
                entity_type:
                  description: Type of entity associated with the line item.
                  type:
                  - string
                  - 'null'
                item_level_discount_amount:
                  description: Discount amount applied at the item level.
                  type:
                  - integer
                  - 'null'
                discount_amount:
                  description: Discount amount applied to the line item.
                  type:
                  - integer
                  - 'null'
                entity_id:
                  description: Identifier for the entity associated with the line
                    item.
                  type:
                  - string
                  - 'null'
                object:
                  description: Type of object representing the line item.
                  type:
                  - string
                  - 'null'
          shipping_address:
            description: The shipping address for the order
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: First name in the shipping address.
                type:
                - string
                - 'null'
              last_name:
                description: Last name in the shipping address.
                type:
                - string
                - 'null'
              email:
                description: Email associated with the shipping address.
                type:
                - string
                - 'null'
              company:
                description: Company name in the shipping address.
                type:
                - string
                - 'null'
              phone:
                description: Phone number associated with the shipping address.
                type:
                - string
                - 'null'
              line1:
                description: First address line in the shipping address.
                type:
                - string
                - 'null'
              line2:
                description: Second address line in the shipping address.
                type:
                - string
                - 'null'
              line3:
                description: Third address line in the shipping address.
                type:
                - string
                - 'null'
              city:
                description: City in the shipping address.
                type:
                - string
                - 'null'
              state_code:
                description: State code of the shipping address.
                type:
                - string
                - 'null'
              state:
                description: State in the shipping address.
                type:
                - string
                - 'null'
              country:
                description: Country in the shipping address.
                type:
                - string
                - 'null'
              zip:
                description: Zip or postal code in the shipping address.
                type:
                - string
                - 'null'
              validation_status:
                description: Validation status of the shipping address.
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the shipping address.
                type:
                - string
                - 'null'
          billing_address:
            description: The billing address associated with the order
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: First name in the billing address.
                type:
                - string
                - 'null'
              last_name:
                description: Last name in the billing address.
                type:
                - string
                - 'null'
              email:
                description: Email associated with the billing address.
                type:
                - string
                - 'null'
              company:
                description: Company name in the billing address.
                type:
                - string
                - 'null'
              phone:
                description: Phone number associated with the billing address.
                type:
                - string
                - 'null'
              line1:
                description: First address line in the billing address.
                type:
                - string
                - 'null'
              line2:
                description: Second address line in the billing address.
                type:
                - string
                - 'null'
              line3:
                description: Third address line in the billing address.
                type:
                - string
                - 'null'
              city:
                description: City in the billing address.
                type:
                - string
                - 'null'
              state_code:
                description: State code of the billing address.
                type:
                - string
                - 'null'
              state:
                description: State in the billing address.
                type:
                - string
                - 'null'
              country:
                description: Country in the billing address.
                type:
                - string
                - 'null'
              zip:
                description: Zip or postal code in the billing address.
                type:
                - string
                - 'null'
              validation_status:
                description: Validation status of the billing address.
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the billing address.
                type:
                - string
                - 'null'
          line_item_taxes:
            description: Taxes applied to individual line items
            type:
            - array
            - 'null'
            items:
              description: Details of a particular line item tax
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: Identifier for the line item the tax is applied to.
                  type:
                  - string
                  - 'null'
                tax_name:
                  description: Name of the tax applied.
                  type:
                  - string
                  - 'null'
                tax_rate:
                  description: Rate of tax applied.
                  type:
                  - number
                  - 'null'
                is_partial_tax_applied:
                  description: Flag indicating if partial tax has been applied.
                  type:
                  - boolean
                  - 'null'
                is_non_compliance_tax:
                  description: Flag indicating if the tax is non-compliant.
                  type:
                  - boolean
                  - 'null'
                taxable_amount:
                  description: Amount on which tax is calculated.
                  type:
                  - integer
                  - 'null'
                tax_amount:
                  description: Total tax amount applied.
                  type:
                  - integer
                  - 'null'
                tax_juris_type:
                  description: Type of tax jurisdiction.
                  type:
                  - string
                  - 'null'
                tax_juris_name:
                  description: Name of the tax jurisdiction.
                  type:
                  - string
                  - 'null'
                tax_juris_code:
                  description: Code for the tax jurisdiction.
                  type:
                  - string
                  - 'null'
                tax_amount_in_local_currency:
                  description: Tax amount converted to the local currency.
                  type:
                  - integer
                  - 'null'
                local_currency-code:
                  description: Currency code used for the local tax amount.
                  type:
                  - string
                  - 'null'
          line_item_discounts:
            description: Discounts applied to individual line items
            type:
            - array
            - 'null'
            items:
              description: Details of a particular line item discount
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: Identifier for the line item the discount is applied
                    to.
                  type:
                  - string
                  - 'null'
                discount_type:
                  description: Type of discount applied.
                  type:
                  - string
                  - 'null'
                coupon_id:
                  description: Identifier for the coupon applied for the discount.
                  type:
                  - string
                  - 'null'
                discount_amount:
                  description: Amount of the discount applied.
                  type:
                  - integer
                  - 'null'
                entity_id:
                  description: Identifier for the entity the discount is associated
                    with.
                  type:
                  - string
                  - 'null'
                object:
                  description: Type of object representing the line item discount.
                  type:
                  - string
                  - 'null'
          linked_credit_notes:
            description: Credit notes linked to the order
            type:
            - array
            - 'null'
            items:
              description: Details of a linked credit note
              type:
              - object
              - 'null'
              properties:
                amount:
                  description: Amount associated with the credit note.
                  type:
                  - integer
                  - 'null'
                type:
                  description: Type of credit note.
                  type:
                  - string
                  - 'null'
                id:
                  description: Unique identifier for the credit note.
                  type:
                  - string
                  - 'null'
                status:
                  description: Status of the credit note.
                  type:
                  - string
                  - 'null'
                amount_adjusted:
                  description: Adjusted amount in the credit note.
                  type:
                  - integer
                  - 'null'
                amount_refunded:
                  description: Amount refunded for the credit note.
                  type:
                  - integer
                  - 'null'
                object:
                  description: Type of object representing the credit note.
                  type:
                  - string
                  - 'null'
          resent_orders:
            description: Orders that were resent to the customer
            type:
            - array
            - 'null'
            items:
              description: Details of a resent order
              type:
              - object
              - 'null'
              properties:
                order_id:
                  description: Identifier for the resent order.
                  type:
                  - string
                  - 'null'
                reason:
                  description: Reason for resenting the order.
                  type:
                  - string
                  - 'null'
                amount:
                  description: Amount for the resent order.
                  type:
                  - integer
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  hosted_page_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Hosted Page
        type: object
        properties:
          id:
            description: Unique identifier for the hosted page.
            type:
            - string
            - 'null'
          type:
            description: Type of hosted page (e.g., checkout, subscription).
            type:
            - string
            - 'null'
          url:
            description: URL where the hosted page can be accessed.
            type:
            - string
            - 'null'
          state:
            description: Current state of the hosted page (e.g., active, expired).
            type:
            - string
            - 'null'
          pass_thru_content:
            description: Content that is passed through to the hosted page.
            type:
            - string
            - 'null'
          embed:
            description: Details about embedding the hosted page.
            type:
            - boolean
            - 'null'
          created_at:
            description: Timestamp indicating when the hosted page was created.
            type:
            - integer
            - 'null'
          expires_at:
            description: Timestamp specifying the expiry date of the hosted page.
            type:
            - integer
            - 'null'
          content:
            description: Content or details displayed on the hosted page.
            type:
            - object
            - 'null'
          updated_at:
            description: Timestamp indicating the last update time of the hosted page.
            type:
            - integer
            - 'null'
          resource_version:
            description: Version of the hosted page resource.
            type:
            - integer
            - 'null'
          checkout_info:
            description: Information related to the checkout process for the hosted
              page.
            type:
            - object
            - 'null'
          business_entity_id:
            description: The ID of the business entity associated with the hosted
              page.
            type:
            - string
            - 'null'
          object:
            description: Indicates the type of object, in this case, it would be 'hosted_page'.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  invoice_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Invoice
        type: object
        additionalProperties: true
        properties:
          id:
            description: Unique ID of the invoice
            type:
            - string
            - 'null'
          po_number:
            description: Purchase order number
            type:
            - string
            - 'null'
          customer_id:
            description: ID of the customer
            type:
            - string
            - 'null'
          subscription_id:
            description: ID of the subscription associated
            type:
            - string
            - 'null'
          recurring:
            description: Flag indicating if it's a recurring invoice
            type:
            - boolean
            - 'null'
          status:
            description: Status of the invoice
            type:
            - string
            - 'null'
          vat_number:
            description: VAT number
            type:
            - string
            - 'null'
          price_type:
            description: Type of pricing
            type:
            - string
            - 'null'
          date:
            description: Date of the invoice
            type:
            - integer
            - 'null'
          due_date:
            description: Due date for payment
            type:
            - integer
            - 'null'
          net_term_days:
            description: Net term days for payment
            type:
            - integer
            - 'null'
          exchange_rate:
            description: Exchange rate used for currency conversion
            type:
            - number
            - 'null'
          currency_code:
            description: Currency code of the invoice
            type:
            - string
            - 'null'
          total:
            description: Total amount of the invoice
            type:
            - integer
            - 'null'
          amount_paid:
            description: Amount already paid
            type:
            - integer
            - 'null'
          amount_adjusted:
            description: Total amount adjusted in the invoice
            type:
            - integer
            - 'null'
          write_off_amount:
            description: Amount written off
            type:
            - integer
            - 'null'
          credits_applied:
            description: Total credits applied to the invoice
            type:
            - integer
            - 'null'
          amount_due:
            description: Amount due for payment
            type:
            - integer
            - 'null'
          paid_at:
            description: Date when the invoice was paid
            type:
            - integer
            - 'null'
          dunning_status:
            description: Status of dunning for the invoice
            type:
            - string
            - 'null'
          next_retry_at:
            description: Date of the next payment retry
            type:
            - integer
            - 'null'
          voided_at:
            description: Date when the invoice was voided
            type:
            - integer
            - 'null'
          resource_version:
            description: Resource version of the invoice
            type:
            - integer
            - 'null'
          updated_at:
            description: Date of last update
            type:
            - integer
            - 'null'
          sub_total:
            description: Subtotal amount
            type:
            - integer
            - 'null'
          sub_total_in_local_currency:
            description: Subtotal amount in local currency
            type:
            - integer
            - 'null'
          total_in_local_currency:
            description: Total amount in local currency
            type:
            - integer
            - 'null'
          local_currency_code:
            description: Local currency code of the invoice
            type:
            - string
            - 'null'
          tax:
            description: Total tax amount
            type:
            - integer
            - 'null'
          local_currency_exchange_rate:
            description: Exchange rate for local currency conversion
            type:
            - number
            - 'null'
          first_invoice:
            description: Flag indicating whether it's the first invoice
            type:
            - boolean
            - 'null'
          new_sales_amount:
            description: New sales amount in the invoice
            type:
            - integer
            - 'null'
          has_advance_charges:
            description: Flag indicating if there are advance charges
            type:
            - boolean
            - 'null'
          term_finalized:
            description: Flag indicating if the term is finalized
            type:
            - boolean
            - 'null'
          is_gifted:
            description: Flag indicating if the invoice is gifted
            type:
            - boolean
            - 'null'
          is_digital:
            description: Flag indicating if the invoice is digital
            type:
            - boolean
            - 'null'
          generated_at:
            description: Date when the invoice was generated
            type:
            - integer
            - 'null'
          expected_payment_date:
            description: Expected date of payment
            type:
            - integer
            - 'null'
          amount_to_collect:
            description: Amount yet to be collected
            type:
            - integer
            - 'null'
          round_off_amount:
            description: Amount rounded off
            type:
            - integer
            - 'null'
          payment_owner:
            description: Owner of the payment
            type:
            - string
            - 'null'
          void_reason_code:
            description: Reason code for voiding the invoice
            type:
            - string
            - 'null'
          deleted:
            description: Flag indicating if the invoice is deleted
            type:
            - boolean
            - 'null'
          tax_category:
            description: Tax category
            type:
            - string
            - 'null'
          vat_number_prefix:
            description: Prefix for the VAT number
            type:
            - string
            - 'null'
          channel:
            description: Channel through which the invoice was generated
            type:
            - string
            - 'null'
          business_entity_id:
            description: ID of the business entity
            type:
            - string
            - 'null'
          base_currency_code:
            description: Currency code used as base for the invoice
            type:
            - string
            - 'null'
          object:
            description: Type of object
            type:
            - string
            - 'null'
          line_items:
            description: Details of individual line items in the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the line item
                  type:
                  - string
                  - 'null'
                subscription_id:
                  description: ID of the subscription associated with the line item
                  type:
                  - string
                  - 'null'
                date_from:
                  description: Start date for the line item service
                  type:
                  - integer
                  - 'null'
                date_to:
                  description: End date for the line item service
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  description: Unit amount of the line item
                  type:
                  - integer
                  - 'null'
                quantity:
                  description: Quantity of the line item
                  type:
                  - integer
                  - 'null'
                amount:
                  description: Total amount for the line item
                  type:
                  - integer
                  - 'null'
                pricing_model:
                  description: Pricing model applied to the line item
                  type:
                  - string
                  - 'null'
                is_taxed:
                  description: Flag indicating if tax is applied
                  type:
                  - boolean
                  - 'null'
                tax_amount:
                  description: Total tax amount applied
                  type:
                  - integer
                  - 'null'
                tax_rate:
                  description: Rate of tax applied
                  type:
                  - number
                  - 'null'
                unit_amount_in_decimal:
                  description: Unit amount of the line item in decimal form
                  type:
                  - string
                  - 'null'
                quantity_in_decimal:
                  description: Quantity of the line item in decimal form
                  type:
                  - string
                  - 'null'
                amount_in_decimal:
                  description: Total amount in decimal form
                  type:
                  - string
                  - 'null'
                discount_amount:
                  description: Amount of discount applied
                  type:
                  - integer
                  - 'null'
                item_level_discount_amount:
                  description: Amount of discount applied at item level
                  type:
                  - integer
                  - 'null'
                description:
                  description: Description of the line item
                  type:
                  - string
                  - 'null'
                entity_description:
                  description: Description of the associated entity
                  type:
                  - string
                  - 'null'
                entity_type:
                  description: Type of associated entity
                  type:
                  - string
                  - 'null'
                tax_exempt_reason:
                  description: Reason for tax exemption
                  type:
                  - string
                  - 'null'
                entity_id:
                  description: ID of the associated entity
                  type:
                  - string
                  - 'null'
                customer_id:
                  description: ID of the customer associated with the line item
                  type:
                  - string
                  - 'null'
                metered:
                  description: Indicates if the line item is metered
                  type:
                  - boolean
                  - 'null'
                object:
                  description: Type of object representing the line item
                  type:
                  - string
                  - 'null'
          discounts:
            description: Discount details applied to the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                amount:
                  description: Amount of the discount
                  type:
                  - integer
                  - 'null'
                description:
                  description: Description of the discount
                  type:
                  - string
                  - 'null'
                entity_type:
                  description: Type of entity to which the discount is applied
                  type:
                  - string
                  - 'null'
                entity_id:
                  description: ID of the entity to which the discount is applied
                  type:
                  - string
                  - 'null'
                coupon_set_code:
                  description: Code of the coupon set if applicable
                  type:
                  - string
                  - 'null'
                discount_type:
                  description: Type of discount
                  type:
                  - string
                  - 'null'
                discount_percentage:
                  description: Percentage of the discount
                  type:
                  - number
                  - 'null'
                object:
                  description: Type of object representing the discount
                  type:
                  - string
                  - 'null'
          line_item_discounts:
            description: Details of line item discounts
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: ID of the line item
                  type:
                  - string
                  - 'null'
                discount_type:
                  description: Type of the discount
                  type:
                  - string
                  - 'null'
                discount_amount:
                  description: Amount of the discount
                  type:
                  - integer
                  - 'null'
                entity_id:
                  description: ID of the entity associated with the discount
                  type:
                  - string
                  - 'null'
                coupon_id:
                  description: ID of the coupon applied
                  type:
                  - string
                  - 'null'
                object:
                  description: Type of object
                  type:
                  - string
                  - 'null'
          taxes:
            description: Details of taxes applied
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                name:
                  description: Name of the tax
                  type:
                  - string
                  - 'null'
                amount:
                  description: Amount of the tax
                  type:
                  - integer
                  - 'null'
                description:
                  description: Description of the tax
                  type:
                  - string
                  - 'null'
          line_item_taxes:
            description: Tax details applied to each line item in the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: ID of the line item to which the tax is applied
                  type:
                  - string
                  - 'null'
                tax_name:
                  description: Name of the tax
                  type:
                  - string
                  - 'null'
                tax_rate:
                  description: Rate of tax applied
                  type:
                  - number
                  - 'null'
                date_to:
                  description: End date for the tax calculation
                  type:
                  - integer
                  - 'null'
                date_from:
                  description: Start date for the tax calculation
                  type:
                  - integer
                  - 'null'
                prorated_taxable_amount:
                  description: Prorated taxable amount for tax calculation
                  type:
                  - number
                  - 'null'
                is_partial_tax_applied:
                  description: Flag indicating partial tax calculation
                  type:
                  - boolean
                  - 'null'
                is_non_compliance_tax:
                  description: Flag indicating non-compliance tax
                  type:
                  - boolean
                  - 'null'
                taxable_amount:
                  description: Total taxable amount for tax calculation
                  type:
                  - integer
                  - 'null'
                tax_amount:
                  description: Amount of tax applied
                  type:
                  - integer
                  - 'null'
                tax_juris_type:
                  description: Type of tax jurisdiction
                  type:
                  - string
                  - 'null'
                tax_juris_name:
                  description: Tax jurisdiction name
                  type:
                  - string
                  - 'null'
                tax_juris_code:
                  description: Tax jurisdiction code
                  type:
                  - string
                  - 'null'
                tax_amount_in_local_currency:
                  description: Tax amount in local currency
                  type:
                  - integer
                  - 'null'
                local_currency_code:
                  description: Local currency code for the tax calculation
                  type:
                  - string
                  - 'null'
          line_item_tiers:
            description: Tiers information for each line item in the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  description: ID of the line item to which the tier applies
                  type:
                  - string
                  - 'null'
                starting_unit:
                  description: Starting unit of tier pricing
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: Ending unit of tier pricing
                  type:
                  - integer
                  - 'null'
                quantity_used:
                  description: Quantity used within the tier
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  description: Unit amount for the tier
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  description: Starting unit in decimal form
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  description: Ending unit in decimal form
                  type:
                  - string
                  - 'null'
                quantity_used_in_decimal:
                  description: Quantity used in decimal form
                  type:
                  - string
                  - 'null'
                unit_amount_in_decimal:
                  description: Unit amount in decimal form
                  type:
                  - string
                  - 'null'
                object:
                  description: Type of object representing the line item tier
                  type:
                  - string
                  - 'null'
          linked_payments:
            description: Details of linked payments
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                txn_id:
                  description: ID of the transaction linked
                  type:
                  - string
                  - 'null'
                applied_amount:
                  description: Amount of the linked payment applied
                  type:
                  - integer
                  - 'null'
                applied_at:
                  description: Date when the linked payment was applied
                  type:
                  - integer
                  - 'null'
                txn_status:
                  description: Status of the linked transaction
                  type:
                  - string
                  - 'null'
                txn_date:
                  description: Date of the transaction
                  type:
                  - integer
                  - 'null'
                txn_amount:
                  description: Amount of the transaction linked
                  type:
                  - integer
                  - 'null'
          dunning_attempts:
            description: Details of dunning attempts made
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                attempt:
                  description: Attempt number
                  type:
                  - integer
                  - 'null'
                transaction_id:
                  description: ID of the transaction
                  type:
                  - string
                  - 'null'
                dunning_type:
                  description: Type of dunning
                  type:
                  - string
                  - 'null'
                created_at:
                  description: Creation date of the attempt
                  type:
                  - integer
                  - 'null'
                txn_status:
                  description: Status of the transaction
                  type:
                  - string
                  - 'null'
                txn_amount:
                  description: Amount of the transaction
                  type:
                  - integer
                  - 'null'
          applied_credits:
            description: Details of credits applied to the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                cn_id:
                  description: ID of the applied credit
                  type:
                  - string
                  - 'null'
                applied_amount:
                  description: Amount applied
                  type:
                  - integer
                  - 'null'
                applied_at:
                  description: Date when the credit was applied
                  type:
                  - integer
                  - 'null'
                cn_reason_code:
                  description: Reason code for the applied credit
                  type:
                  - string
                  - 'null'
                cn_create_reason_code:
                  description: Reason code for creating the applied credit
                  type:
                  - string
                  - 'null'
                cn_date:
                  description: Date of the applied credit
                  type:
                  - integer
                  - 'null'
                cn_status:
                  description: Status of the applied credit
                  type:
                  - string
                  - 'null'
          adjustment_credit_notes:
            description: Details of adjustment credit notes applied to the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                cn_id:
                  description: ID of the credit note
                  type:
                  - string
                  - 'null'
                cn_reason_code:
                  description: Reason code for the credit note
                  type:
                  - string
                  - 'null'
                cn_create_reason_code:
                  description: Reason code for creating the credit note
                  type:
                  - string
                  - 'null'
                cn_date:
                  description: Date of the credit note
                  type:
                  - integer
                  - 'null'
                cn_total:
                  description: Total amount of the credit note
                  type:
                  - integer
                  - 'null'
                cn_status:
                  description: Status of the credit note
                  type:
                  - string
                  - 'null'
          issued_credit_notes:
            description: Details of credit notes issued
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                cn_id:
                  description: ID of the issued credit note
                  type:
                  - string
                  - 'null'
                cn_reason_code:
                  description: Reason code for the issued credit note
                  type:
                  - string
                  - 'null'
                cn_create_reason_code:
                  description: Reason code for creating the issued credit note
                  type:
                  - string
                  - 'null'
                cn_date:
                  description: Date of the issued credit note
                  type:
                  - integer
                  - 'null'
                cn_total:
                  description: Total amount of the issued credit note
                  type:
                  - integer
                  - 'null'
                cn_status:
                  description: Status of the issued credit note
                  type:
                  - string
                  - 'null'
          linked_orders:
            description: Details of linked orders to the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the order
                  type:
                  - string
                  - 'null'
                document_number:
                  description: Document number of the order
                  type:
                  - string
                  - 'null'
                status:
                  description: Current status of the order
                  type:
                  - string
                  - 'null'
                order_type:
                  description: Type of the order
                  type:
                  - string
                  - 'null'
                reference_id:
                  description: ID of the reference linked to the order
                  type:
                  - string
                  - 'null'
                fulfillment_status:
                  description: Status of order fulfillment
                  type:
                  - string
                  - 'null'
                batch_id:
                  description: ID of the order batch
                  type:
                  - string
                  - 'null'
                created_at:
                  description: Creation date of the order
                  type:
                  - integer
                  - 'null'
          notes:
            description: Notes associated with the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                entity_type:
                  description: Type of the entity related to the note
                  type:
                  - string
                  - 'null'
                note:
                  description: Content of the note
                  type:
                  - string
                  - 'null'
                entity_id:
                  description: ID of the entity related to the note
                  type:
                  - string
                  - 'null'
          shipping_address:
            description: Details of the shipping address associated with the invoice
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: First name in the shipping address
                type:
                - string
                - 'null'
              last_name:
                description: Last name in the shipping address
                type:
                - string
                - 'null'
              email:
                description: Email address associated with the shipping address
                type:
                - string
                - 'null'
              company:
                description: Company name in the shipping address
                type:
                - string
                - 'null'
              phone:
                description: Phone number associated with the shipping address
                type:
                - string
                - 'null'
              line1:
                description: First line of the shipping address
                type:
                - string
                - 'null'
              line2:
                description: Second line of the shipping address
                type:
                - string
                - 'null'
              line3:
                description: Third line of the shipping address
                type:
                - string
                - 'null'
              city:
                description: City of the shipping address
                type:
                - string
                - 'null'
              state_code:
                description: State code of the shipping address
                type:
                - string
                - 'null'
              state:
                description: State of the shipping address
                type:
                - string
                - 'null'
              country:
                description: Country of the shipping address
                type:
                - string
                - 'null'
              zip:
                description: ZIP code of the shipping address
                type:
                - string
                - 'null'
              validation_status:
                description: Status of address validation
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the shipping address
                type:
                - string
                - 'null'
          statement_descriptor:
            description: Descriptor for the statement
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the descriptor
                type:
                - string
                - 'null'
              descriptor:
                description: Descriptor text
                type:
                - string
                - 'null'
              additional_info:
                description: Additional information for the descriptor
                type:
                - string
                - 'null'
          billing_address:
            description: Details of the billing address associated with the invoice
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: First name in the billing address
                type:
                - string
                - 'null'
              last_name:
                description: Last name in the billing address
                type:
                - string
                - 'null'
              email:
                description: Email address associated with the billing address
                type:
                - string
                - 'null'
              company:
                description: Company name in the billing address
                type:
                - string
                - 'null'
              phone:
                description: Phone number associated with the billing address
                type:
                - string
                - 'null'
              line1:
                description: First line of the billing address
                type:
                - string
                - 'null'
              line2:
                description: Second line of the billing address
                type:
                - string
                - 'null'
              line3:
                description: Third line of the billing address
                type:
                - string
                - 'null'
              city:
                description: City of the billing address
                type:
                - string
                - 'null'
              state_code:
                description: State code of the billing address
                type:
                - string
                - 'null'
              state:
                description: State of the billing address
                type:
                - string
                - 'null'
              country:
                description: Country of the billing address
                type:
                - string
                - 'null'
              zip:
                description: ZIP code of the billing address
                type:
                - string
                - 'null'
              validation_status:
                description: Status of address validation
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the billing address
                type:
                - string
                - 'null'
          einvoice:
            description: Details of electronic invoice
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the electronic invoice
                type:
                - string
                - 'null'
              reference_number:
                description: Reference number of the electronic invoice
                type:
                - string
                - 'null'
              status:
                description: Status of the electronic invoice
                type:
                - string
                - 'null'
              message:
                description: Message related to the electronic invoice
                type:
                - string
                - 'null'
          linked_taxes_withheld:
            description: Details of linked taxes withheld on the invoice
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the tax withholding
                  type:
                  - string
                  - 'null'
                amount:
                  description: Amount of tax withheld
                  type:
                  - integer
                  - 'null'
                description:
                  description: Description of the tax withholding
                  type:
                  - string
                  - 'null'
                date:
                  description: Date of tax withholding
                  type:
                  - integer
                  - 'null'
                reference_number:
                  description: Reference number of the tax withholding
                  type:
                  - string
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  item_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Item
        type: object
        properties:
          id:
            description: Unique identifier for the item
            type:
            - string
            - 'null'
          name:
            description: Name of the item
            type:
            - string
            - 'null'
          description:
            description: Description of the item
            type:
            - string
            - 'null'
          status:
            description: Status of the item
            type:
            - string
            - 'null'
          resource_version:
            description: Version of the resource
            type:
            - integer
            - 'null'
          updated_at:
            description: Date and time when the item was last updated
            type:
            - integer
            - 'null'
          item_family_id:
            description: ID of the item's family
            type:
            - string
            - 'null'
          type:
            description: Type of the item
            type:
            - string
            - 'null'
          is_shippable:
            description: Flag indicating if the item is shippable
            type:
            - boolean
            - 'null'
          is_giftable:
            description: Flag indicating if the item is giftable
            type:
            - boolean
            - 'null'
          redirect_url:
            description: URL to redirect for the item
            type:
            - string
            - 'null'
          enabled_for_checkout:
            description: Flag indicating if the item is enabled for checkout
            type:
            - boolean
            - 'null'
          enabled_in_portal:
            description: Flag indicating if the item is enabled in the portal
            type:
            - boolean
            - 'null'
          included_in_mrr:
            description: Flag indicating if the item is included in Monthly Recurring
              Revenue
            type:
            - boolean
            - 'null'
          item_applicability:
            description: Applicability of the item
            type:
            - string
            - 'null'
          gift_claim_redirect_url:
            description: URL to redirect for gift claim
            type:
            - string
            - 'null'
          unit:
            description: Unit associated with the item
            type:
            - string
            - 'null'
          metered:
            description: Flag indicating if the item is metered
            type:
            - boolean
            - 'null'
          usage_calculation:
            description: Calculation method used for item usage
            type:
            - string
            - 'null'
          archived_at:
            description: Date and time when the item was archived
            type:
            - integer
            - 'null'
          metadata:
            description: Additional data associated with the item
            type:
            - object
            - 'null'
            properties: {}
          external_name:
            description: Name of the item in an external system
            type:
            - string
            - 'null'
          applicable_items:
            description: Items associated with the item
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: Unique identifier for the item
                  type:
                  - string
                  - 'null'
          channel:
            description: Channel the item belongs to
            type:
            - string
            - 'null'
          object:
            description: Type of object
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  item_price_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Item Prices
        type: object
        properties:
          id:
            description: Unique identifier for the item.
            type:
            - string
            - 'null'
          name:
            description: Name of the item.
            type:
            - string
            - 'null'
          item_family_id:
            description: Identifier for the item family to which the item belongs.
            type:
            - string
            - 'null'
          item_id:
            description: Unique identifier for the item.
            type:
            - string
            - 'null'
          description:
            description: Description of the item.
            type:
            - string
            - 'null'
          status:
            description: Current status of the item (e.g., active, inactive).
            type:
            - string
            - 'null'
          external_name:
            description: External name of the item.
            type:
            - string
            - 'null'
          pricing_model:
            description: The pricing model used for the item (e.g., flat fee, usage-based).
            type:
            - string
            - 'null'
          price:
            description: Price of the item.
            type:
            - integer
            - 'null'
          price_in_decimal:
            description: Price of the item represented in decimal format.
            type:
            - string
            - 'null'
          period:
            description: Duration of the item's billing period.
            type:
            - integer
            - 'null'
          currency_code:
            description: The currency code used for pricing the item.
            type:
            - string
            - 'null'
          period_unit:
            description: Unit of measurement for the billing period duration.
            type:
            - string
            - 'null'
          trial_period:
            description: Duration of the trial period.
            type:
            - integer
            - 'null'
          trial_period_unit:
            description: Unit of measurement for the trial period duration.
            type:
            - string
            - 'null'
          trial_end_action:
            description: Action to be taken at the end of the trial period.
            type:
            - string
            - 'null'
          shipping_period:
            description: Duration of the item's shipping period.
            type:
            - integer
            - 'null'
          shipping_period_unit:
            description: Unit of measurement for the shipping period duration.
            type:
            - string
            - 'null'
          billing_cycles:
            description: Number of billing cycles for the item.
            type:
            - integer
            - 'null'
          free_quantity:
            description: Free quantity allowed for the item.
            type:
            - integer
            - 'null'
          free_quantity_in_decimal:
            description: Free quantity allowed represented in decimal format.
            type:
            - string
            - 'null'
          resource_version:
            description: Version of the item resource.
            type:
            - integer
            - 'null'
          updated_at:
            description: Date and time when the item was last updated.
            type:
            - integer
            - 'null'
          created_at:
            description: Date and time when the item was created.
            type:
            - integer
            - 'null'
          archived_at:
            description: Date and time when the item was archived.
            type:
            - integer
            - 'null'
          invoice_notes:
            description: Notes to be included in the invoice for the item.
            type:
            - string
            - 'null'
          is_taxable:
            description: Flag indicating whether the item is taxable.
            type:
            - boolean
            - 'null'
          metadata:
            description: Additional metadata associated with the item.
            type:
            - object
            - 'null'
            properties: {}
          item_type:
            description: Type of the item (e.g., product, service).
            type:
            - string
            - 'null'
          show_description_in_invoices:
            description: Flag indicating whether to show the description in invoices.
            type:
            - boolean
            - 'null'
          show_description_in_quotes:
            description: Flag indicating whether to show the description in quotes.
            type:
            - boolean
            - 'null'
          tiers:
            description: Different pricing tiers for the item.
            type:
            - array
            - 'null'
            items:
              description: Specific details for each tier such as price, quantity,
                discount, etc.
              type:
              - object
              - 'null'
              properties:
                starting_unit:
                  description: Starting unit for the tier.
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: Ending unit for the tier.
                  type:
                  - integer
                  - 'null'
                price:
                  description: Price for the tier.
                  type:
                  - integer
                  - 'null'
          tax_detail:
            description: Information about taxes associated with the item price.
            type:
            - object
            - 'null'
            properties:
              tax_profile_id:
                description: Tax profile identifier.
                type:
                - string
                - 'null'
              avalara_sale_type:
                description: Avalara sale type for tax calculation.
                type:
                - string
                - 'null'
              avalara_transaction_type:
                description: Avalara transaction type for tax calculation.
                type:
                - integer
                - 'null'
              avalara_service_type:
                description: Avalara service type for tax calculation.
                type:
                - integer
                - 'null'
              avalara_tax_code:
                description: Avalara tax code.
                type:
                - string
                - 'null'
              taxjar_product_code:
                description: TaxJar product code for tax calculation.
                type:
                - string
                - 'null'
          accounting_detail:
            description: Details related to accounting such as cost, revenue, expenses,
              etc.
            type:
            - object
            - 'null'
            properties:
              sku:
                description: Stock Keeping Unit (SKU) code of the item.
                type:
                - string
                - 'null'
              accounting_code:
                description: The accounting code associated with the item.
                type:
                - string
                - 'null'
              accounting_category1:
                description: The first accounting category.
                type:
                - string
                - 'null'
              accounting_category2:
                description: The second accounting category.
                type:
                - string
                - 'null'
              accounting_category3:
                description: The third accounting category.
                type:
                - string
                - 'null'
              accounting_category4:
                description: The fourth accounting category.
                type:
                - string
                - 'null'
          channel:
            description: The channel through which the item is sold.
            type:
            - string
            - 'null'
          object:
            description: Object type representing the item.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  payment_source_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Payment Source
        type: object
        properties:
          id:
            description: Unique identifier for the payment source
            type:
            - string
            - 'null'
          resource_version:
            description: Version of the payment source resource
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp indicating when the payment source was last updated
            type:
            - integer
            - 'null'
          created_at:
            description: Timestamp indicating when the payment source was created
            type:
            - integer
            - 'null'
          customer_id:
            description: Unique identifier for the customer associated with the payment
              source
            type:
            - string
            - 'null'
          object:
            description: Type of object, e.g., payment_source
            type:
            - string
            - 'null'
          type:
            description: Type of payment source, e.g., card, bank_account
            type:
            - string
            - 'null'
          reference_id:
            description: Reference identifier for the payment source
            type:
            - string
            - 'null'
          status:
            description: Status of the payment source, e.g., active or inactive
            type:
            - string
            - 'null'
          gateway:
            description: Name of the payment gateway used for the payment source
            type:
            - string
            - 'null'
          gateway_account_id:
            description: Identifier for the gateway account tied to the payment source
            type:
            - string
            - 'null'
          ip_address:
            description: IP address associated with the payment source
            type:
            - string
            - 'null'
          issuing_country:
            description: Country where the payment source was issued
            type:
            - string
            - 'null'
          deleted:
            description: Indicates if the payment source has been deleted
            type:
            - boolean
            - 'null'
          business_entity_id:
            description: Identifier for the business entity associated with the payment
              source
            type:
            - string
            - 'null'
          card:
            description: Data related to card payment source
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: First name of the cardholder
                type:
                - string
                - 'null'
              last_name:
                description: Last name of the cardholder
                type:
                - string
                - 'null'
              iin:
                description: Issuer Identification Number of the card
                type:
                - string
                - 'null'
              last4:
                description: Last four digits of the card number
                type:
                - string
                - 'null'
              brand:
                description: Brand of the card, e.g., Visa, Mastercard
                type:
                - string
                - 'null'
              funding_type:
                description: Type of funding, e.g., credit or debit
                type:
                - string
                - 'null'
              expiry_month:
                description: Expiry month of the card
                type:
                - integer
                - 'null'
              expiry_year:
                description: Expiry year of the card
                type:
                - integer
                - 'null'
              billing_addr1:
                description: First line of the billing address
                type:
                - string
                - 'null'
              billing_addr2:
                description: Second line of the billing address
                type:
                - string
                - 'null'
              billing_city:
                description: City of the billing address
                type:
                - string
                - 'null'
              billing_state_code:
                description: State code of the billing address
                type:
                - string
                - 'null'
              billing_state:
                description: State of the billing address
                type:
                - string
                - 'null'
              billing_country:
                description: Country of the billing address
                type:
                - string
                - 'null'
              billing_zip:
                description: ZIP or postal code of the billing address
                type:
                - string
                - 'null'
              masked_number:
                description: Masked card number for security purposes
                type:
                - string
                - 'null'
              object:
                description: Type of payment source object, e.g., card
                type:
                - string
                - 'null'
          bank_account:
            description: Data related to bank account payment source
            type:
            - object
            - 'null'
            properties:
              last4:
                description: Last four digits of the bank account number
                type:
                - string
                - 'null'
              name_on_account:
                description: Name on the bank account
                type:
                - string
                - 'null'
              first_name:
                description: First name of the account holder
                type:
                - string
                - 'null'
              last_name:
                description: Last name of the account holder
                type:
                - string
                - 'null'
              bank_name:
                description: Name of the bank associated with the account
                type:
                - string
                - 'null'
              mandate_id:
                description: Unique identifier for the mandate related to the bank
                  account
                type:
                - string
                - 'null'
              account_type:
                description: Type of bank account, e.g., checking or savings
                type:
                - string
                - 'null'
              echeck_type:
                description: Type of eCheck, if applicable
                type:
                - string
                - 'null'
              account_holder_type:
                description: Type of account holder, e.g., individual or business
                type:
                - string
                - 'null'
              email:
                description: Email associated with the bank account
                type:
                - string
                - 'null'
          amazon_payment:
            description: Data related to Amazon Pay payment source
            type:
            - object
            - 'null'
            properties:
              email:
                description: Email associated with the Amazon payment method
                type:
                - string
                - 'null'
              agreement_id:
                description: Unique identifier for the Amazon payment agreement
                type:
                - string
                - 'null'
          upi:
            description: Data related to UPI payment source
            type:
            - object
            - 'null'
            properties:
              vpa:
                description: Virtual Payment Address associated with the UPI payment
                  method
                type:
                - string
                - 'null'
          paypal:
            description: Data related to PayPal payment source
            type:
            - object
            - 'null'
            properties:
              email:
                description: Email associated with the PayPal account
                type:
                - string
                - 'null'
              agreement_id:
                description: Unique identifier for the PayPal billing agreement
                type:
                - string
                - 'null'
          mandates:
            description: Data related to mandates for payments
            type:
            - object
            - 'null'
            properties:
              id:
                description: Unique identifier for the mandate related to the payment
                  source
                type:
                - string
                - 'null'
              subscription_id:
                description: Unique identifier for the subscription associated with
                  the mandate
                type:
                - string
                - 'null'
              created_at:
                description: Timestamp indicating when the mandate associated with
                  the payment source was created
                type:
                - integer
                - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  plan_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Plan
        type: object
        properties:
          id:
            description: The ID of the plan
            type:
            - string
            - 'null'
          name:
            description: Name of the plan
            type:
            - string
            - 'null'
          invoice_name:
            description: Name used in invoices
            type:
            - string
            - 'null'
          description:
            description: Description of the plan
            type:
            - string
            - 'null'
          price:
            description: Price of the plan
            type:
            - integer
            - 'null'
          currency_code:
            description: The currency code used for pricing
            type:
            - string
            - 'null'
          period:
            description: Duration of each billing cycle
            type:
            - integer
            - 'null'
          period_unit:
            description: Unit of the billing cycle duration
            type:
            - string
            - 'null'
          trial_period:
            description: Duration of the trial period
            type:
            - integer
            - 'null'
          trial_period_unit:
            description: Unit of the trial period duration
            type:
            - string
            - 'null'
          trial_end_action:
            description: Action to take at the end of the trial period
            type:
            - string
            - 'null'
          pricing_model:
            description: Model used for pricing
            type:
            - string
            - 'null'
          free_quantity:
            description: Free quantity included in the plan
            type:
            - integer
            - 'null'
          setup_cost:
            description: One-time setup cost of the plan
            type:
            - integer
            - 'null'
          status:
            description: Status of the plan
            type:
            - string
            - 'null'
          archived_at:
            description: Timestamp when the plan was archived
            type:
            - integer
            - 'null'
          billing_cycles:
            description: Number of billing cycles for the plan
            type:
            - integer
            - 'null'
          redirect_url:
            description: URL for redirecting users
            type:
            - string
            - 'null'
          enabled_in_hosted_pages:
            description: Whether the plan is enabled in hosted pages
            type:
            - boolean
            - 'null'
          enabled_in_portal:
            description: Whether the plan is enabled in the portal
            type:
            - boolean
            - 'null'
          addon_applicability:
            description: How the add-ons are applicable to the plan
            type:
            - string
            - 'null'
          tax_code:
            description: Tax code associated with the plan
            type:
            - string
            - 'null'
          taxjar_product_code:
            description: TaxJar product code for tax calculations
            type:
            - string
            - 'null'
          avalara_sale_type:
            description: Avalara sale type for tax calculations
            type:
            - string
            - 'null'
          avalara_transaction_type:
            description: Avalara transaction type for tax calculations
            type:
            - integer
            - 'null'
          avalara_service_type:
            description: Avalara service type for tax calculations
            type:
            - integer
            - 'null'
          sku:
            description: Stock Keeping Unit (SKU) for the plan
            type:
            - string
            - 'null'
          accounting_code:
            description: The accounting code associated with the plan
            type:
            - string
            - 'null'
          accounting_category1:
            description: The first category for accounting purposes
            type:
            - string
            - 'null'
          accounting_category2:
            description: The second category for accounting purposes
            type:
            - string
            - 'null'
          accounting_category3:
            description: The third category for accounting purposes
            type:
            - string
            - 'null'
          accounting_category4:
            description: The fourth category for accounting purposes
            type:
            - string
            - 'null'
          is_shippable:
            description: Whether the plan is shippable
            type:
            - boolean
            - 'null'
          shipping_frequency_period:
            description: Frequency of shipping for physical goods
            type:
            - integer
            - 'null'
          shipping_frequency_period_unit:
            description: Unit of the shipping frequency
            type:
            - string
            - 'null'
          resource_version:
            description: Version of the plan resource
            type:
            - integer
            - 'null'
          updated_at:
            description: Timestamp when the plan was last updated
            type:
            - integer
            - 'null'
          giftable:
            description: Whether the plan is giftable
            type:
            - boolean
            - 'null'
          claim_url:
            description: URL for claiming the plan
            type:
            - string
            - 'null'
          free_quantity_in_decimal:
            description: Decimal free quantity included in the plan
            type:
            - string
            - 'null'
          price_in_decimal:
            description: Decimal price of the plan
            type:
            - string
            - 'null'
          invoice_notes:
            description: Notes included in invoices
            type:
            - string
            - 'null'
          channel:
            description: Channel associated with the plan
            type:
            - string
            - 'null'
          charge_model:
            description: The model used for charging
            type:
            - string
            - 'null'
          object:
            description: Type of object (plan)
            type:
            - string
            - 'null'
          taxable:
            description: Whether the plan is taxable
            type:
            - boolean
            - 'null'
          tax_profile_id:
            description: ID of the tax profile
            type:
            - string
            - 'null'
          meta_data:
            description: Additional metadata associated with the plan
            type:
            - object
            - 'null'
            properties: {}
          show_description_in_invoices:
            description: Whether to show the description in invoices
            type:
            - boolean
            - 'null'
          show_description_in_quotes:
            description: Whether to show the description in quotes
            type:
            - boolean
            - 'null'
          tiers:
            description: Pricing tiers for this plan
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                starting_unit:
                  description: Starting unit quantity for tiered pricing
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: Ending unit quantity for tiered pricing
                  type:
                  - integer
                  - 'null'
                price:
                  description: Price for the tier
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  description: Decimal starting unit quantity for tiered pricing
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  description: Decimal ending unit quantity for tiered pricing
                  type:
                  - string
                  - 'null'
                price_in_decimal:
                  description: Decimal price for the tier
                  type:
                  - string
                  - 'null'
          applicable_addons:
            description: Available addons that can be applied to this plan
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The ID of the applicable add-ons
                  type:
                  - string
                  - 'null'
          attached_addons:
            description: Addons currently attached to this plan
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the attached add-ons
                  type:
                  - string
                  - 'null'
                quantity:
                  description: Quantity of the attached add-ons
                  type:
                  - integer
                  - 'null'
                billing_cycles:
                  description: Number of billing cycles for the attached add-ons
                  type:
                  - integer
                  - 'null'
                type:
                  description: Type of the attached add-ons
                  type:
                  - string
                  - 'null'
                quantity_in_decimal:
                  description: Decimal quantity of the attached add-ons
                  type:
                  - string
                  - 'null'
          event_based_addons:
            description: Addons triggered based on specific events for this plan
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the event-based add-ons
                  type:
                  - string
                  - 'null'
                quantity:
                  description: Quantity of event-based add-ons
                  type:
                  - integer
                  - 'null'
                on_event:
                  description: Event triggering the charge
                  type:
                  - string
                  - 'null'
                charge_once:
                  description: Whether to charge only once for event-based add-ons
                  type:
                  - boolean
                  - 'null'
                quantity_in_decimal:
                  description: Decimal quantity of event-based add-ons
                  type:
                  - string
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  promotional_credit_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: created_at
          created_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Payment Source
        type: object
        properties:
          id:
            description: The unique identifier of the promotional credit record.
            type:
            - string
            - 'null'
          customer_id:
            description: The ID of the customer associated with the promotional credit.
            type:
            - string
            - 'null'
          type:
            description: The category or classification of the promotional credit.
            type:
            - string
            - 'null'
          amount_in_decimal:
            description: The decimal representation of the promotional credit amount.
            type:
            - string
            - 'null'
          amount:
            description: The amount of promotional credit.
            type:
            - integer
            - 'null'
          currency_code:
            description: The currency code of the promotional credit.
            type:
            - string
            - 'null'
          description:
            description: Additional information or notes about the promotional credit.
            type:
            - string
            - 'null'
          credit_type:
            description: The type of promotional credit.
            type:
            - string
            - 'null'
          reference:
            description: A reference related to the promotional credit.
            type:
            - string
            - 'null'
          closing_balance:
            description: The closing balance after using promotional credit.
            type:
            - integer
            - 'null'
          done_by:
            description: The user who initiated the use of promotional credit.
            type:
            - string
            - 'null'
          created_at:
            description: The timestamp when the promotional credit was created.
            type:
            - integer
            - 'null'
          object:
            description: The object type, usually 'credit'.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  subscription_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Subscription
        type: object
        properties:
          id:
            description: The unique ID of the subscription.
            type:
            - string
            - 'null'
          currency_code:
            description: The currency code used for the subscription.
            type:
            - string
            - 'null'
          start_date:
            description: The start date of the subscription.
            type:
            - integer
            - 'null'
          trial_end:
            description: The end date of the trial period for the subscription.
            type:
            - integer
            - 'null'
          remaining_billing_cycles:
            description: The count of remaining billing cycles for the subscription.
            type:
            - integer
            - 'null'
          po_number:
            description: The purchase order number associated with the subscription.
            type:
            - string
            - 'null'
          plan_quantity_in_decimal:
            description: The quantity of the plan in decimal format.
            type:
            - string
            - 'null'
          plan_unit_price_in_decimal:
            description: The unit price of the plan in decimal format.
            type:
            - string
            - 'null'
          customer_id:
            description: The ID of the customer associated with the subscription.
            type:
            - string
            - 'null'
          status:
            description: The current status of the subscription.
            type:
            - string
            - 'null'
          trial_start:
            description: The start date of the trial period for the subscription.
            type:
            - integer
            - 'null'
          trial_end_action:
            description: The action to be taken at the end of the trial period.
            type:
            - string
            - 'null'
          current_term_start:
            description: The start date of the current term for the subscription.
            type:
            - integer
            - 'null'
          current_term_end:
            description: The end date of the current term for the subscription.
            type:
            - integer
            - 'null'
          next_billing_at:
            description: The date and time of the next billing event for the subscription.
            type:
            - integer
            - 'null'
          created_at:
            description: The date and time of the creation of the subscription.
            type:
            - integer
            - 'null'
          started_at:
            description: The date and time when the subscription started.
            type:
            - integer
            - 'null'
          activated_at:
            description: The date and time when the subscription was activated.
            type:
            - integer
            - 'null'
          contract_term_billing_cycle_on_renewal:
            description: Indicates if the contract term billing cycle is applied on
              renewal.
            type:
            - integer
            - 'null'
          override_relationship:
            description: Indicates if the existing relationship is overridden by this
              subscription.
            type:
            - boolean
            - 'null'
          pause_date:
            description: The date on which the subscription was paused.
            type:
            - integer
            - 'null'
          resume_date:
            description: The date on which the subscription was resumed.
            type:
            - integer
            - 'null'
          cancelled_at:
            description: The date and time when the subscription was cancelled.
            type:
            - integer
            - 'null'
          cancel_reason:
            description: The reason for the cancellation of the subscription.
            type:
            - string
            - 'null'
          created_from_ip:
            description: The IP address from which the subscription was created.
            type:
            - string
            - 'null'
          resource_version:
            description: The version of the resource (subscription).
            type:
            - integer
            - 'null'
          updated_at:
            description: The date and time when the subscription was last updated.
            type:
            - integer
            - 'null'
          has_scheduled_advance_invoices:
            description: Indicates if there are scheduled advance invoices for the
              subscription.
            type:
            - boolean
            - 'null'
          has_scheduled_changes:
            description: Indicates if there are scheduled changes for the subscription.
            type:
            - boolean
            - 'null'
          payment_source_id:
            description: The ID of the payment source used for the subscription.
            type:
            - string
            - 'null'
          plan_free_quantity_in_decimal:
            description: The free quantity included in the plan in decimal format.
            type:
            - string
            - 'null'
          plan_amount_in_decimal:
            description: The total amount charged for the plan in decimal format.
            type:
            - string
            - 'null'
          cancel_schedule_created_at:
            description: The date and time when the cancellation schedule was created.
            type:
            - integer
            - 'null'
          due_invoices_count:
            description: The count of due invoices for the subscription.
            type:
            - integer
            - 'null'
          due_since:
            description: The date since which the invoices are due.
            type:
            - integer
            - 'null'
          total_dues:
            description: The total amount of dues for the subscription.
            type:
            - integer
            - 'null'
          mrr:
            description: The monthly recurring revenue generated by the subscription.
            type:
            - integer
            - 'null'
          exchange_rate:
            description: The exchange rate used for currency conversion.
            type:
            - number
            - 'null'
          base_currency_code:
            description: The base currency code used for the subscription.
            type:
            - string
            - 'null'
          invoice_notes:
            description: Any notes added to the invoices of the subscription.
            type:
            - string
            - 'null'
          metadata:
            description: Additional metadata associated with subscription
            type:
            - object
            - 'null'
            properties: {}
          deleted:
            description: Indicates if the subscription has been deleted.
            type:
            - boolean
            - 'null'
          object:
            description: The type of object (subscription).
            type:
            - string
            - 'null'
          coupon:
            description: The coupon applied to the subscription.
            type:
            - string
            - 'null'
          cancel_reason_code:
            description: The code associated with the cancellation reason.
            type:
            - string
            - 'null'
          free_period:
            description: The duration of the free period for the subscription.
            type:
            - integer
            - 'null'
          free_period_unit:
            description: The unit of the free period duration.
            type:
            - string
            - 'null'
          create_pending_invoices:
            description: Indicates if pending invoices are created.
            type:
            - boolean
            - 'null'
          auto_close_invoices:
            description: Defines if the invoices are automatically closed or not.
            type:
            - boolean
            - 'null'
          business_entity_id:
            description: The ID of the business entity to which the subscription belongs.
            type:
            - string
            - 'null'
          channel:
            description: The channel through which the subscription was acquired.
            type:
            - string
            - 'null'
          coupons:
            description: Details of applied coupons
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                coupon_id:
                  description: The ID of the applied coupon.
                  type: string
                apply_till:
                  description: The date until which the coupon can be applied.
                  type:
                  - integer
                  - 'null'
                apply_count:
                  description: The count of times the coupon can be applied.
                  type:
                  - integer
                  - 'null'
                coupon_code:
                  description: The code of the applied coupon.
                  type:
                  - string
                  - 'null'
                applied_count:
                  description: The count of times the coupon has been applied.
                  type:
                  - integer
                  - 'null'
                object:
                  description: The type of object (coupon).
                  type:
                  - string
                  - 'null'
          shipping_address:
            description: Stores the shipping address related to the subscription
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: The first name in the shipping address.
                type:
                - string
                - 'null'
              last_name:
                description: The last name in the shipping address.
                type:
                - string
                - 'null'
              email:
                description: The email address in the shipping address.
                type:
                - string
                - 'null'
              company:
                description: The company name in the shipping address.
                type:
                - string
                - 'null'
              phone:
                description: The phone number in the shipping address.
                type:
                - string
                - 'null'
              line1:
                description: The first line of the shipping address.
                type:
                - string
                - 'null'
              line2:
                description: The second line of the shipping address.
                type:
                - string
                - 'null'
              line3:
                description: The third line of the shipping address.
                type:
                - string
                - 'null'
              city:
                description: The city in the shipping address.
                type:
                - string
                - 'null'
              state_code:
                description: The state code in the shipping address.
                type:
                - string
                - 'null'
              state:
                description: The state in the shipping address.
                type:
                - string
                - 'null'
              country:
                description: The country in the shipping address.
                type:
                - string
                - 'null'
              zip:
                description: The ZIP or postal code in the shipping address.
                type:
                - string
                - 'null'
              validation_status:
                description: The validation status of the shipping address.
                type:
                - string
                - 'null'
          referral_info:
            description: Contains details related to any referral information associated
              with the subscription
            type:
            - object
            - 'null'
            properties:
              referral_code:
                description: The code associated with the referral.
                type:
                - string
                - 'null'
              coupon_code:
                description: The coupon code used for the referral.
                type:
                - string
                - 'null'
              referral_id:
                description: The unique identifier of the referral.
                type:
                - string
                - 'null'
              external_reference_id:
                description: The external reference identifier of the referral.
                type:
                - string
                - 'null'
              reward_status:
                description: The status of the reward for the referral.
                type:
                - string
                - 'null'
              referral_system:
                description: The system handling the referrals.
                type:
                - string
                - 'null'
              account_id:
                description: The account identifier of the referral.
                type:
                - string
                - 'null'
              campaign_id:
                description: The campaign identifier of the referral.
                type:
                - string
                - 'null'
              external_campaign_id:
                description: The external campaign identifier of the referral.
                type:
                - string
                - 'null'
              friend_offer_type:
                description: The type of offer for a friend in the referral program.
                type:
                - string
                - 'null'
              referrer_reward_type:
                description: The type of reward for the referrer in the referral program.
                type:
                - string
                - 'null'
              notify_referral_system:
                description: Whether to notify the referral system.
                type:
                - string
                - 'null'
              destination_url:
                description: The URL to which the referral leads.
                type:
                - string
                - 'null'
              post_purchase_widget_enabled:
                description: Whether the post-purchase widget is enabled for the referral.
                type:
                - boolean
                - 'null'
          contract_term:
            description: Contains details about the contract term of the subscription
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the contract term.
                type:
                - string
                - 'null'
              status:
                description: The status of the contract term.
                type:
                - string
                - 'null'
              contract_start:
                description: The start date of the contract.
                type:
                - integer
                - 'null'
              contract_end:
                description: The end date of the contract.
                type:
                - integer
                - 'null'
              billing_cycle:
                description: The billing cycle duration of the contract.
                type:
                - integer
                - 'null'
              action_at_term_end:
                description: The action to be taken at the end of the contract term.
                type:
                - string
                - 'null'
              total_contract_value:
                description: The total value of the contract.
                type:
                - integer
                - 'null'
              cancellation_cutoff_period:
                description: The period within which cancellation is allowed before
                  the next term.
                type:
                - integer
                - 'null'
              created_at:
                description: The timestamp when the contract term was created.
                type:
                - integer
                - 'null'
              subscription_id:
                description: The identifier of the subscription associated with the
                  contract term.
                type:
                - string
                - 'null'
              remaining_billing_cycles:
                description: The remaining billing cycles for the contract term.
                type:
                - integer
                - 'null'
          subscription_items:
            description: Lists individual items included in the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_price_id:
                  description: The unique identifier of the item price associated
                    with the subscription item.
                  type:
                  - string
                  - 'null'
                item_type:
                  description: The type of the subscription item.
                  type:
                  - string
                  - 'null'
                quantity:
                  description: The quantity of the subscription item.
                  type:
                  - integer
                  - 'null'
                quantity_in_decimal:
                  description: The quantity in decimal format for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                unit_price:
                  description: The unit price of the subscription item.
                  type:
                  - integer
                  - 'null'
                unit_price_in_decimal:
                  description: The unit price in decimal format for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                amount:
                  description: The amount charged for the subscription item.
                  type:
                  - integer
                  - 'null'
                amount_in_decimal:
                  description: The amount in decimal format for the subscription item.
                  type:
                  - string
                  - 'null'
                free_quantity:
                  description: The free quantity included with the subscription item.
                  type:
                  - integer
                  - 'null'
                free_quantity_in_decimal:
                  description: The free quantity in decimal format for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                trial_end:
                  description: The end date of the trial period for the subscription
                    item.
                  type:
                  - integer
                  - 'null'
                billing_cycles:
                  description: The number of billing cycles for the subscription item.
                  type:
                  - integer
                  - 'null'
                service_period_days:
                  description: The number of days in the service period.
                  type:
                  - integer
                  - 'null'
                charge_on_event:
                  description: The event triggering the charge for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                charge_once:
                  description: Whether the subscription item is charged only once.
                  type:
                  - boolean
                  - 'null'
                charge_on_option:
                  description: The charge option for the subscription item.
                  type:
                  - string
                  - 'null'
                object:
                  description: The type of the subscription item.
                  type:
                  - string
                  - 'null'
          item_tiers:
            description: Provides information about tiers or levels for specific subscription
              items
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_price_id:
                  description: The identifier of the item price associated with the
                    tier.
                  type:
                  - string
                  - 'null'
                starting_unit:
                  description: The starting unit of the tier.
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: The ending unit of the tier.
                  type:
                  - integer
                  - 'null'
                price:
                  description: The price of the tier.
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  description: The starting unit in decimal format for the tier.
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  description: The ending unit in decimal format for the tier.
                  type:
                  - string
                  - 'null'
                price_in_decimal:
                  description: The price in decimal format for the tier.
                  type:
                  - string
                  - 'null'
                object:
                  description: The type of the item tier.
                  type:
                  - string
                  - 'null'
          charged_items:
            description: Lists the items that have been charged as part of the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_price_id:
                  description: The identifier of the item price charged.
                  type:
                  - string
                  - 'null'
                last_charged_at:
                  description: The timestamp of the last charge for the item.
                  type:
                  - integer
                  - 'null'
                object:
                  description: The type of the charged item.
                  type:
                  - string
                  - 'null'
          plan_id:
            description: The ID of the plan associated with the subscription.
            type:
            - string
            - 'null'
          plan_quantity:
            description: The quantity of the plan included in the subscription.
            type:
            - integer
            - 'null'
          plan_unit_price:
            description: The unit price of the plan for the subscription.
            type:
            - integer
            - 'null'
          setup_fee:
            description: The setup fee charged for the subscription.
            type:
            - integer
            - 'null'
          billing_period:
            description: The billing period duration for the subscription.
            type:
            - integer
            - 'null'
          billing_period_unit:
            description: The unit of the billing period.
            type:
            - string
            - 'null'
          auto_collection:
            description: Indicates if auto-collection is enabled for the subscription.
            type:
            - string
            - 'null'
          plan_amount:
            description: The total amount charged for the plan of the subscription.
            type:
            - integer
            - 'null'
          plan_free_quantity:
            description: The free quantity included in the plan of the subscription.
            type:
            - integer
            - 'null'
          gift_id:
            description: The ID of the gift associated with the subscription.
            type:
            - string
            - 'null'
          affiliate_token:
            description: The affiliate token associated with the subscription.
            type:
            - string
            - 'null'
          offline_payment_method:
            description: The offline payment method used for the subscription.
            type:
            - string
            - 'null'
          meta_data:
            description: Additional metadata associated with subscription
            type:
            - object
            - 'null'
            properties: {}
          addons:
            description: Represents any additional features or services added to the
              subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The unique identifier of the addon.
                  type:
                  - string
                  - 'null'
                quantity:
                  description: The quantity of the addon.
                  type:
                  - integer
                  - 'null'
                unit_price:
                  description: The unit price of the addon.
                  type:
                  - integer
                  - 'null'
                amount:
                  description: The amount charged for the addon.
                  type:
                  - integer
                  - 'null'
                trial_end:
                  description: The end date of the trial period for the addon.
                  type:
                  - integer
                  - 'null'
                remaining_billing_cycles:
                  description: The remaining billing cycles for the addon.
                  type:
                  - integer
                  - 'null'
                quantity_in_decimal:
                  description: The quantity in decimal format for the addon.
                  type:
                  - string
                  - 'null'
                unit_price_in_decimal:
                  description: The unit price in decimal format for the addon.
                  type:
                  - string
                  - 'null'
                amount_in_decimal:
                  description: The amount in decimal format for the addon.
                  type:
                  - string
                  - 'null'
          event_based_addons:
            description: Specifies any event-based addons associated with the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The unique identifier of the event-based addon.
                  type:
                  - string
                  - 'null'
                quantity:
                  description: The quantity of the addon.
                  type:
                  - integer
                  - 'null'
                unit_price:
                  description: The unit price of the addon.
                  type:
                  - integer
                  - 'null'
                on_event:
                  description: The event triggering the addon charge.
                  type:
                  - string
                  - 'null'
                charge_once:
                  description: Whether the addon is charged only once.
                  type:
                  - boolean
                  - 'null'
                quantity_in_decimal:
                  description: The quantity in decimal format for the addon.
                  type:
                  - string
                  - 'null'
                unit_price_in_decimal:
                  description: The unit price in decimal format for the addon.
                  type:
                  - string
                  - 'null'
          charged_event_based_addons:
            description: Details of addons charged based on events
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The ID of the charged event-based addon.
                  type:
                  - string
                  - 'null'
                last_charged_at:
                  description: The date and time of the last charge for the addon.
                  type:
                  - integer
                  - 'null'
          discounts:
            description: Includes any discounts applied to the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The unique identifier of the discount.
                  type:
                  - string
                  - 'null'
                invoice_name:
                  description: The name of the discount on the invoice.
                  type:
                  - string
                  - 'null'
                type:
                  description: The type of the discount.
                  type:
                  - string
                  - 'null'
                percentage:
                  description: The percentage value of the discount.
                  type:
                  - number
                  - 'null'
                amount:
                  description: The amount of discount applied.
                  type:
                  - integer
                  - 'null'
                currency_code:
                  description: The currency code of the discount.
                  type:
                  - string
                  - 'null'
                duration_type:
                  description: The duration type of the discount (e.g., forever, once).
                  type:
                  - string
                  - 'null'
                period:
                  description: The period for which the discount is applicable.
                  type:
                  - integer
                  - 'null'
                period_unit:
                  description: The unit of the period (e.g., days, months).
                  type:
                  - string
                  - 'null'
                included_in_mrr:
                  description: Whether the discount is included in Monthly Recurring
                    Revenue (MRR) calculation.
                  type:
                  - boolean
                  - 'null'
                apply_on:
                  description: The item to which the discount is applied.
                  type:
                  - string
                  - 'null'
                item_price_id:
                  description: The identifier of the item price associated with the
                    discount.
                  type:
                  - string
                  - 'null'
                created_at:
                  description: The timestamp when the discount was created.
                  type:
                  - integer
                  - 'null'
                apply_till:
                  description: The expiry date until which the discount is applicable.
                  type:
                  - integer
                  - 'null'
                applied_count:
                  description: The number of times the discount has been applied.
                  type:
                  - integer
                  - 'null'
                coupon_id:
                  description: The identifier of the coupon used for the discount.
                  type:
                  - string
                  - 'null'
                index:
                  description: The index of the discount.
                  type:
                  - integer
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  subscription_with_scheduled_changes_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          field_path: []
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: DefaultErrorHandler
          response_filters:
          - http_codes:
            - 404
            action: IGNORE
            error_message: "Entity unavailable. Subscription may have been deleted."
          - http_codes:
            - 400
            action: IGNORE
            error_message_contains: "No changes are scheduled for this subscription."
            error_message: "No scheduled changes for subscription."
      partition_router:
        type: SubstreamPartitionRouter
        parent_stream_configs:
        - stream:
            retriever:
              type: SimpleRetriever
              record_selector:
                type: RecordSelector
                extractor:
                  type: DpathExtractor
                  field_path:
                  - "list"
                  - "*"
                  - "{{ parameters.get('name') }}"
              paginator:
                type: DefaultPaginator
                pagination_strategy:
                  type: "CursorPagination"
                  cursor_value: "{{ response.get('next_offset')|tojson() }}"
                  stop_condition: "{{ not response.next_offset }}"
                  page_size_option:
                    type: RequestOption
                    inject_into: request_parameter
                    field_name: limit
                    page_size: 100
                page_token_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: offset
              requester:
                type: HttpRequester
                url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
                http_method: "GET"
                authenticator:
                  type: BasicHttpAuthenticator
                  username: "{{ config['site_api_key'] }}"
                error_handler:
                  type: CompositeErrorHandler
                  error_handlers:
                  - type: DefaultErrorHandler
                    response_filters:
                    - error_message_contains: "This API operation is not enabled for
                        this site"
                      action: IGNORE
                      error_message: "Stream is available only for Product Catalog
                        1.0"
                  - type: DefaultErrorHandler
                    backoff_strategies:
                    - type: WaitTimeFromHeader
                      header: "Retry-After"
                request_parameters:
                  sort_by[asc]: updated_at
                  include_deleted: "true"
                  updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
            transformations:
            - type: CustomTransformation
              class_name: source_declarative_manifest.components.CustomFieldTransformation
            incremental_sync:
              type: DatetimeBasedCursor
              start_datetime:
                datetime: "{{ format_datetime(config['start_date'], '%s') }}"
                datetime_format: "%s"
              end_datetime:
                datetime: "{{ now_utc().strftime('%s') }}"
                datetime_format: "%s"
              datetime_format: "%s"
              cursor_granularity: PT1S
              step: P1M
              cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
                }}"
            schema_loader:
              type: InlineSchemaLoader
              schema:
                $schema: http://json-schema.org/draft-07/schema#
                name: Subscription
                type: object
                properties:
                  id:
                    description: The unique ID of the subscription.
                    type:
                    - string
                    - 'null'
                  currency_code:
                    description: The currency code used for the subscription.
                    type:
                    - string
                    - 'null'
                  start_date:
                    description: The start date of the subscription.
                    type:
                    - integer
                    - 'null'
                  trial_end:
                    description: The end date of the trial period for the subscription.
                    type:
                    - integer
                    - 'null'
                  remaining_billing_cycles:
                    description: The count of remaining billing cycles for the subscription.
                    type:
                    - integer
                    - 'null'
                  po_number:
                    description: The purchase order number associated with the subscription.
                    type:
                    - string
                    - 'null'
                  plan_quantity_in_decimal:
                    description: The quantity of the plan in decimal format.
                    type:
                    - string
                    - 'null'
                  plan_unit_price_in_decimal:
                    description: The unit price of the plan in decimal format.
                    type:
                    - string
                    - 'null'
                  customer_id:
                    description: The ID of the customer associated with the subscription.
                    type:
                    - string
                    - 'null'
                  status:
                    description: The current status of the subscription.
                    type:
                    - string
                    - 'null'
                  trial_start:
                    description: The start date of the trial period for the subscription.
                    type:
                    - integer
                    - 'null'
                  trial_end_action:
                    description: The action to be taken at the end of the trial period.
                    type:
                    - string
                    - 'null'
                  current_term_start:
                    description: The start date of the current term for the subscription.
                    type:
                    - integer
                    - 'null'
                  current_term_end:
                    description: The end date of the current term for the subscription.
                    type:
                    - integer
                    - 'null'
                  next_billing_at:
                    description: The date and time of the next billing event for the
                      subscription.
                    type:
                    - integer
                    - 'null'
                  created_at:
                    description: The date and time of the creation of the subscription.
                    type:
                    - integer
                    - 'null'
                  started_at:
                    description: The date and time when the subscription started.
                    type:
                    - integer
                    - 'null'
                  activated_at:
                    description: The date and time when the subscription was activated.
                    type:
                    - integer
                    - 'null'
                  contract_term_billing_cycle_on_renewal:
                    description: Indicates if the contract term billing cycle is applied
                      on renewal.
                    type:
                    - integer
                    - 'null'
                  override_relationship:
                    description: Indicates if the existing relationship is overridden
                      by this subscription.
                    type:
                    - boolean
                    - 'null'
                  pause_date:
                    description: The date on which the subscription was paused.
                    type:
                    - integer
                    - 'null'
                  resume_date:
                    description: The date on which the subscription was resumed.
                    type:
                    - integer
                    - 'null'
                  cancelled_at:
                    description: The date and time when the subscription was cancelled.
                    type:
                    - integer
                    - 'null'
                  cancel_reason:
                    description: The reason for the cancellation of the subscription.
                    type:
                    - string
                    - 'null'
                  created_from_ip:
                    description: The IP address from which the subscription was created.
                    type:
                    - string
                    - 'null'
                  resource_version:
                    description: The version of the resource (subscription).
                    type:
                    - integer
                    - 'null'
                  updated_at:
                    description: The date and time when the subscription was last
                      updated.
                    type:
                    - integer
                    - 'null'
                  has_scheduled_advance_invoices:
                    description: Indicates if there are scheduled advance invoices
                      for the subscription.
                    type:
                    - boolean
                    - 'null'
                  has_scheduled_changes:
                    description: Indicates if there are scheduled changes for the
                      subscription.
                    type:
                    - boolean
                    - 'null'
                  payment_source_id:
                    description: The ID of the payment source used for the subscription.
                    type:
                    - string
                    - 'null'
                  plan_free_quantity_in_decimal:
                    description: The free quantity included in the plan in decimal
                      format.
                    type:
                    - string
                    - 'null'
                  plan_amount_in_decimal:
                    description: The total amount charged for the plan in decimal
                      format.
                    type:
                    - string
                    - 'null'
                  cancel_schedule_created_at:
                    description: The date and time when the cancellation schedule
                      was created.
                    type:
                    - integer
                    - 'null'
                  due_invoices_count:
                    description: The count of due invoices for the subscription.
                    type:
                    - integer
                    - 'null'
                  due_since:
                    description: The date since which the invoices are due.
                    type:
                    - integer
                    - 'null'
                  total_dues:
                    description: The total amount of dues for the subscription.
                    type:
                    - integer
                    - 'null'
                  mrr:
                    description: The monthly recurring revenue generated by the subscription.
                    type:
                    - integer
                    - 'null'
                  exchange_rate:
                    description: The exchange rate used for currency conversion.
                    type:
                    - number
                    - 'null'
                  base_currency_code:
                    description: The base currency code used for the subscription.
                    type:
                    - string
                    - 'null'
                  invoice_notes:
                    description: Any notes added to the invoices of the subscription.
                    type:
                    - string
                    - 'null'
                  metadata:
                    description: Additional metadata associated with subscription
                    type:
                    - object
                    - 'null'
                    properties: {}
                  deleted:
                    description: Indicates if the subscription has been deleted.
                    type:
                    - boolean
                    - 'null'
                  object:
                    description: The type of object (subscription).
                    type:
                    - string
                    - 'null'
                  coupon:
                    description: The coupon applied to the subscription.
                    type:
                    - string
                    - 'null'
                  cancel_reason_code:
                    description: The code associated with the cancellation reason.
                    type:
                    - string
                    - 'null'
                  free_period:
                    description: The duration of the free period for the subscription.
                    type:
                    - integer
                    - 'null'
                  free_period_unit:
                    description: The unit of the free period duration.
                    type:
                    - string
                    - 'null'
                  create_pending_invoices:
                    description: Indicates if pending invoices are created.
                    type:
                    - boolean
                    - 'null'
                  auto_close_invoices:
                    description: Defines if the invoices are automatically closed
                      or not.
                    type:
                    - boolean
                    - 'null'
                  business_entity_id:
                    description: The ID of the business entity to which the subscription
                      belongs.
                    type:
                    - string
                    - 'null'
                  channel:
                    description: The channel through which the subscription was acquired.
                    type:
                    - string
                    - 'null'
                  coupons:
                    description: Details of applied coupons
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        coupon_id:
                          description: The ID of the applied coupon.
                          type: string
                        apply_till:
                          description: The date until which the coupon can be applied.
                          type:
                          - integer
                          - 'null'
                        apply_count:
                          description: The count of times the coupon can be applied.
                          type:
                          - integer
                          - 'null'
                        coupon_code:
                          description: The code of the applied coupon.
                          type:
                          - string
                          - 'null'
                        applied_count:
                          description: The count of times the coupon has been applied.
                          type:
                          - integer
                          - 'null'
                        object:
                          description: The type of object (coupon).
                          type:
                          - string
                          - 'null'
                  shipping_address:
                    description: Stores the shipping address related to the subscription
                    type:
                    - object
                    - 'null'
                    properties:
                      first_name:
                        description: The first name in the shipping address.
                        type:
                        - string
                        - 'null'
                      last_name:
                        description: The last name in the shipping address.
                        type:
                        - string
                        - 'null'
                      email:
                        description: The email address in the shipping address.
                        type:
                        - string
                        - 'null'
                      company:
                        description: The company name in the shipping address.
                        type:
                        - string
                        - 'null'
                      phone:
                        description: The phone number in the shipping address.
                        type:
                        - string
                        - 'null'
                      line1:
                        description: The first line of the shipping address.
                        type:
                        - string
                        - 'null'
                      line2:
                        description: The second line of the shipping address.
                        type:
                        - string
                        - 'null'
                      line3:
                        description: The third line of the shipping address.
                        type:
                        - string
                        - 'null'
                      city:
                        description: The city in the shipping address.
                        type:
                        - string
                        - 'null'
                      state_code:
                        description: The state code in the shipping address.
                        type:
                        - string
                        - 'null'
                      state:
                        description: The state in the shipping address.
                        type:
                        - string
                        - 'null'
                      country:
                        description: The country in the shipping address.
                        type:
                        - string
                        - 'null'
                      zip:
                        description: The ZIP or postal code in the shipping address.
                        type:
                        - string
                        - 'null'
                      validation_status:
                        description: The validation status of the shipping address.
                        type:
                        - string
                        - 'null'
                  referral_info:
                    description: Contains details related to any referral information
                      associated with the subscription
                    type:
                    - object
                    - 'null'
                    properties:
                      referral_code:
                        description: The code associated with the referral.
                        type:
                        - string
                        - 'null'
                      coupon_code:
                        description: The coupon code used for the referral.
                        type:
                        - string
                        - 'null'
                      referral_id:
                        description: The unique identifier of the referral.
                        type:
                        - string
                        - 'null'
                      external_reference_id:
                        description: The external reference identifier of the referral.
                        type:
                        - string
                        - 'null'
                      reward_status:
                        description: The status of the reward for the referral.
                        type:
                        - string
                        - 'null'
                      referral_system:
                        description: The system handling the referrals.
                        type:
                        - string
                        - 'null'
                      account_id:
                        description: The account identifier of the referral.
                        type:
                        - string
                        - 'null'
                      campaign_id:
                        description: The campaign identifier of the referral.
                        type:
                        - string
                        - 'null'
                      external_campaign_id:
                        description: The external campaign identifier of the referral.
                        type:
                        - string
                        - 'null'
                      friend_offer_type:
                        description: The type of offer for a friend in the referral
                          program.
                        type:
                        - string
                        - 'null'
                      referrer_reward_type:
                        description: The type of reward for the referrer in the referral
                          program.
                        type:
                        - string
                        - 'null'
                      notify_referral_system:
                        description: Whether to notify the referral system.
                        type:
                        - string
                        - 'null'
                      destination_url:
                        description: The URL to which the referral leads.
                        type:
                        - string
                        - 'null'
                      post_purchase_widget_enabled:
                        description: Whether the post-purchase widget is enabled for
                          the referral.
                        type:
                        - boolean
                        - 'null'
                  contract_term:
                    description: Contains details about the contract term of the subscription
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: The unique identifier of the contract term.
                        type:
                        - string
                        - 'null'
                      status:
                        description: The status of the contract term.
                        type:
                        - string
                        - 'null'
                      contract_start:
                        description: The start date of the contract.
                        type:
                        - integer
                        - 'null'
                      contract_end:
                        description: The end date of the contract.
                        type:
                        - integer
                        - 'null'
                      billing_cycle:
                        description: The billing cycle duration of the contract.
                        type:
                        - integer
                        - 'null'
                      action_at_term_end:
                        description: The action to be taken at the end of the contract
                          term.
                        type:
                        - string
                        - 'null'
                      total_contract_value:
                        description: The total value of the contract.
                        type:
                        - integer
                        - 'null'
                      cancellation_cutoff_period:
                        description: The period within which cancellation is allowed
                          before the next term.
                        type:
                        - integer
                        - 'null'
                      created_at:
                        description: The timestamp when the contract term was created.
                        type:
                        - integer
                        - 'null'
                      subscription_id:
                        description: The identifier of the subscription associated
                          with the contract term.
                        type:
                        - string
                        - 'null'
                      remaining_billing_cycles:
                        description: The remaining billing cycles for the contract
                          term.
                        type:
                        - integer
                        - 'null'
                  subscription_items:
                    description: Lists individual items included in the subscription
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        item_price_id:
                          description: The unique identifier of the item price associated
                            with the subscription item.
                          type:
                          - string
                          - 'null'
                        item_type:
                          description: The type of the subscription item.
                          type:
                          - string
                          - 'null'
                        quantity:
                          description: The quantity of the subscription item.
                          type:
                          - integer
                          - 'null'
                        quantity_in_decimal:
                          description: The quantity in decimal format for the subscription
                            item.
                          type:
                          - string
                          - 'null'
                        unit_price:
                          description: The unit price of the subscription item.
                          type:
                          - integer
                          - 'null'
                        unit_price_in_decimal:
                          description: The unit price in decimal format for the subscription
                            item.
                          type:
                          - string
                          - 'null'
                        amount:
                          description: The amount charged for the subscription item.
                          type:
                          - integer
                          - 'null'
                        amount_in_decimal:
                          description: The amount in decimal format for the subscription
                            item.
                          type:
                          - string
                          - 'null'
                        free_quantity:
                          description: The free quantity included with the subscription
                            item.
                          type:
                          - integer
                          - 'null'
                        free_quantity_in_decimal:
                          description: The free quantity in decimal format for the
                            subscription item.
                          type:
                          - string
                          - 'null'
                        trial_end:
                          description: The end date of the trial period for the subscription
                            item.
                          type:
                          - integer
                          - 'null'
                        billing_cycles:
                          description: The number of billing cycles for the subscription
                            item.
                          type:
                          - integer
                          - 'null'
                        service_period_days:
                          description: The number of days in the service period.
                          type:
                          - integer
                          - 'null'
                        charge_on_event:
                          description: The event triggering the charge for the subscription
                            item.
                          type:
                          - string
                          - 'null'
                        charge_once:
                          description: Whether the subscription item is charged only
                            once.
                          type:
                          - boolean
                          - 'null'
                        charge_on_option:
                          description: The charge option for the subscription item.
                          type:
                          - string
                          - 'null'
                        object:
                          description: The type of the subscription item.
                          type:
                          - string
                          - 'null'
                  item_tiers:
                    description: Provides information about tiers or levels for specific
                      subscription items
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        item_price_id:
                          description: The identifier of the item price associated
                            with the tier.
                          type:
                          - string
                          - 'null'
                        starting_unit:
                          description: The starting unit of the tier.
                          type:
                          - integer
                          - 'null'
                        ending_unit:
                          description: The ending unit of the tier.
                          type:
                          - integer
                          - 'null'
                        price:
                          description: The price of the tier.
                          type:
                          - integer
                          - 'null'
                        starting_unit_in_decimal:
                          description: The starting unit in decimal format for the
                            tier.
                          type:
                          - string
                          - 'null'
                        ending_unit_in_decimal:
                          description: The ending unit in decimal format for the tier.
                          type:
                          - string
                          - 'null'
                        price_in_decimal:
                          description: The price in decimal format for the tier.
                          type:
                          - string
                          - 'null'
                        object:
                          description: The type of the item tier.
                          type:
                          - string
                          - 'null'
                  charged_items:
                    description: Lists the items that have been charged as part of
                      the subscription
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        item_price_id:
                          description: The identifier of the item price charged.
                          type:
                          - string
                          - 'null'
                        last_charged_at:
                          description: The timestamp of the last charge for the item.
                          type:
                          - integer
                          - 'null'
                        object:
                          description: The type of the charged item.
                          type:
                          - string
                          - 'null'
                  plan_id:
                    description: The ID of the plan associated with the subscription.
                    type:
                    - string
                    - 'null'
                  plan_quantity:
                    description: The quantity of the plan included in the subscription.
                    type:
                    - integer
                    - 'null'
                  plan_unit_price:
                    description: The unit price of the plan for the subscription.
                    type:
                    - integer
                    - 'null'
                  setup_fee:
                    description: The setup fee charged for the subscription.
                    type:
                    - integer
                    - 'null'
                  billing_period:
                    description: The billing period duration for the subscription.
                    type:
                    - integer
                    - 'null'
                  billing_period_unit:
                    description: The unit of the billing period.
                    type:
                    - string
                    - 'null'
                  auto_collection:
                    description: Indicates if auto-collection is enabled for the subscription.
                    type:
                    - string
                    - 'null'
                  plan_amount:
                    description: The total amount charged for the plan of the subscription.
                    type:
                    - integer
                    - 'null'
                  plan_free_quantity:
                    description: The free quantity included in the plan of the subscription.
                    type:
                    - integer
                    - 'null'
                  gift_id:
                    description: The ID of the gift associated with the subscription.
                    type:
                    - string
                    - 'null'
                  affiliate_token:
                    description: The affiliate token associated with the subscription.
                    type:
                    - string
                    - 'null'
                  offline_payment_method:
                    description: The offline payment method used for the subscription.
                    type:
                    - string
                    - 'null'
                  meta_data:
                    description: Additional metadata associated with subscription
                    type:
                    - object
                    - 'null'
                    properties: {}
                  addons:
                    description: Represents any additional features or services added
                      to the subscription
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          description: The unique identifier of the addon.
                          type:
                          - string
                          - 'null'
                        quantity:
                          description: The quantity of the addon.
                          type:
                          - integer
                          - 'null'
                        unit_price:
                          description: The unit price of the addon.
                          type:
                          - integer
                          - 'null'
                        amount:
                          description: The amount charged for the addon.
                          type:
                          - integer
                          - 'null'
                        trial_end:
                          description: The end date of the trial period for the addon.
                          type:
                          - integer
                          - 'null'
                        remaining_billing_cycles:
                          description: The remaining billing cycles for the addon.
                          type:
                          - integer
                          - 'null'
                        quantity_in_decimal:
                          description: The quantity in decimal format for the addon.
                          type:
                          - string
                          - 'null'
                        unit_price_in_decimal:
                          description: The unit price in decimal format for the addon.
                          type:
                          - string
                          - 'null'
                        amount_in_decimal:
                          description: The amount in decimal format for the addon.
                          type:
                          - string
                          - 'null'
                  event_based_addons:
                    description: Specifies any event-based addons associated with
                      the subscription
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          description: The unique identifier of the event-based addon.
                          type:
                          - string
                          - 'null'
                        quantity:
                          description: The quantity of the addon.
                          type:
                          - integer
                          - 'null'
                        unit_price:
                          description: The unit price of the addon.
                          type:
                          - integer
                          - 'null'
                        on_event:
                          description: The event triggering the addon charge.
                          type:
                          - string
                          - 'null'
                        charge_once:
                          description: Whether the addon is charged only once.
                          type:
                          - boolean
                          - 'null'
                        quantity_in_decimal:
                          description: The quantity in decimal format for the addon.
                          type:
                          - string
                          - 'null'
                        unit_price_in_decimal:
                          description: The unit price in decimal format for the addon.
                          type:
                          - string
                          - 'null'
                  charged_event_based_addons:
                    description: Details of addons charged based on events
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          description: The ID of the charged event-based addon.
                          type:
                          - string
                          - 'null'
                        last_charged_at:
                          description: The date and time of the last charge for the
                            addon.
                          type:
                          - integer
                          - 'null'
                  discounts:
                    description: Includes any discounts applied to the subscription
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          description: The unique identifier of the discount.
                          type:
                          - string
                          - 'null'
                        invoice_name:
                          description: The name of the discount on the invoice.
                          type:
                          - string
                          - 'null'
                        type:
                          description: The type of the discount.
                          type:
                          - string
                          - 'null'
                        percentage:
                          description: The percentage value of the discount.
                          type:
                          - number
                          - 'null'
                        amount:
                          description: The amount of discount applied.
                          type:
                          - integer
                          - 'null'
                        currency_code:
                          description: The currency code of the discount.
                          type:
                          - string
                          - 'null'
                        duration_type:
                          description: The duration type of the discount (e.g., forever,
                            once).
                          type:
                          - string
                          - 'null'
                        period:
                          description: The period for which the discount is applicable.
                          type:
                          - integer
                          - 'null'
                        period_unit:
                          description: The unit of the period (e.g., days, months).
                          type:
                          - string
                          - 'null'
                        included_in_mrr:
                          description: Whether the discount is included in Monthly
                            Recurring Revenue (MRR) calculation.
                          type:
                          - boolean
                          - 'null'
                        apply_on:
                          description: The item to which the discount is applied.
                          type:
                          - string
                          - 'null'
                        item_price_id:
                          description: The identifier of the item price associated
                            with the discount.
                          type:
                          - string
                          - 'null'
                        created_at:
                          description: The timestamp when the discount was created.
                          type:
                          - integer
                          - 'null'
                        apply_till:
                          description: The expiry date until which the discount is
                            applicable.
                          type:
                          - integer
                          - 'null'
                        applied_count:
                          description: The number of times the discount has been applied.
                          type:
                          - integer
                          - 'null'
                        coupon_id:
                          description: The identifier of the coupon used for the discount.
                          type:
                          - string
                          - 'null'
                        index:
                          description: The index of the discount.
                          type:
                          - integer
                          - 'null'
                  custom_fields: _definitions.json#/definitions/custom_fields
          parent_key: "id"
          partition_field: "subscription_id"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Subscription
        type: object
        properties:
          id:
            description: The unique ID of the subscription.
            type:
            - string
            - 'null'
          currency_code:
            description: The currency code used for the subscription.
            type:
            - string
            - 'null'
          start_date:
            description: The start date of the subscription.
            type:
            - integer
            - 'null'
          trial_end:
            description: The end date of the trial period for the subscription.
            type:
            - integer
            - 'null'
          remaining_billing_cycles:
            description: The count of remaining billing cycles for the subscription.
            type:
            - integer
            - 'null'
          po_number:
            description: The purchase order number associated with the subscription.
            type:
            - string
            - 'null'
          plan_quantity_in_decimal:
            description: The quantity of the plan in decimal format.
            type:
            - string
            - 'null'
          plan_unit_price_in_decimal:
            description: The unit price of the plan in decimal format.
            type:
            - string
            - 'null'
          customer_id:
            description: The ID of the customer associated with the subscription.
            type:
            - string
            - 'null'
          status:
            description: The current status of the subscription.
            type:
            - string
            - 'null'
          trial_start:
            description: The start date of the trial period for the subscription.
            type:
            - integer
            - 'null'
          trial_end_action:
            description: The action to be taken at the end of the trial period.
            type:
            - string
            - 'null'
          current_term_start:
            description: The start date of the current term for the subscription.
            type:
            - integer
            - 'null'
          current_term_end:
            description: The end date of the current term for the subscription.
            type:
            - integer
            - 'null'
          next_billing_at:
            description: The date and time of the next billing event for the subscription.
            type:
            - integer
            - 'null'
          created_at:
            description: The date and time of the creation of the subscription.
            type:
            - integer
            - 'null'
          started_at:
            description: The date and time when the subscription started.
            type:
            - integer
            - 'null'
          activated_at:
            description: The date and time when the subscription was activated.
            type:
            - integer
            - 'null'
          contract_term_billing_cycle_on_renewal:
            description: Indicates if the contract term billing cycle is applied on
              renewal.
            type:
            - integer
            - 'null'
          override_relationship:
            description: Indicates if the existing relationship is overridden by this
              subscription.
            type:
            - boolean
            - 'null'
          pause_date:
            description: The date on which the subscription was paused.
            type:
            - integer
            - 'null'
          resume_date:
            description: The date on which the subscription was resumed.
            type:
            - integer
            - 'null'
          cancelled_at:
            description: The date and time when the subscription was cancelled.
            type:
            - integer
            - 'null'
          cancel_reason:
            description: The reason for the cancellation of the subscription.
            type:
            - string
            - 'null'
          created_from_ip:
            description: The IP address from which the subscription was created.
            type:
            - string
            - 'null'
          resource_version:
            description: The version of the resource (subscription).
            type:
            - integer
            - 'null'
          updated_at:
            description: The date and time when the subscription was last updated.
            type:
            - integer
            - 'null'
          has_scheduled_advance_invoices:
            description: Indicates if there are scheduled advance invoices for the
              subscription.
            type:
            - boolean
            - 'null'
          has_scheduled_changes:
            description: Indicates if there are scheduled changes for the subscription.
            type:
            - boolean
            - 'null'
          payment_source_id:
            description: The ID of the payment source used for the subscription.
            type:
            - string
            - 'null'
          plan_free_quantity_in_decimal:
            description: The free quantity included in the plan in decimal format.
            type:
            - string
            - 'null'
          plan_amount_in_decimal:
            description: The total amount charged for the plan in decimal format.
            type:
            - string
            - 'null'
          cancel_schedule_created_at:
            description: The date and time when the cancellation schedule was created.
            type:
            - integer
            - 'null'
          due_invoices_count:
            description: The count of due invoices for the subscription.
            type:
            - integer
            - 'null'
          due_since:
            description: The date since which the invoices are due.
            type:
            - integer
            - 'null'
          total_dues:
            description: The total amount of dues for the subscription.
            type:
            - integer
            - 'null'
          mrr:
            description: The monthly recurring revenue generated by the subscription.
            type:
            - integer
            - 'null'
          exchange_rate:
            description: The exchange rate used for currency conversion.
            type:
            - number
            - 'null'
          base_currency_code:
            description: The base currency code used for the subscription.
            type:
            - string
            - 'null'
          invoice_notes:
            description: Any notes added to the invoices of the subscription.
            type:
            - string
            - 'null'
          metadata:
            description: Additional metadata associated with subscription
            type:
            - object
            - 'null'
            properties: {}
          deleted:
            description: Indicates if the subscription has been deleted.
            type:
            - boolean
            - 'null'
          object:
            description: The type of object (subscription).
            type:
            - string
            - 'null'
          coupon:
            description: The coupon applied to the subscription.
            type:
            - string
            - 'null'
          cancel_reason_code:
            description: The code associated with the cancellation reason.
            type:
            - string
            - 'null'
          free_period:
            description: The duration of the free period for the subscription.
            type:
            - integer
            - 'null'
          free_period_unit:
            description: The unit of the free period duration.
            type:
            - string
            - 'null'
          create_pending_invoices:
            description: Indicates if pending invoices are created.
            type:
            - boolean
            - 'null'
          auto_close_invoices:
            description: Defines if the invoices are automatically closed or not.
            type:
            - boolean
            - 'null'
          business_entity_id:
            description: The ID of the business entity to which the subscription belongs.
            type:
            - string
            - 'null'
          channel:
            description: The channel through which the subscription was acquired.
            type:
            - string
            - 'null'
          coupons:
            description: Details of applied coupons
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                coupon_id:
                  description: The ID of the applied coupon.
                  type: string
                apply_till:
                  description: The date until which the coupon can be applied.
                  type:
                  - integer
                  - 'null'
                apply_count:
                  description: The count of times the coupon can be applied.
                  type:
                  - integer
                  - 'null'
                coupon_code:
                  description: The code of the applied coupon.
                  type:
                  - string
                  - 'null'
                applied_count:
                  description: The count of times the coupon has been applied.
                  type:
                  - integer
                  - 'null'
                object:
                  description: The type of object (coupon).
                  type:
                  - string
                  - 'null'
          shipping_address:
            description: Stores the shipping address related to the subscription
            type:
            - object
            - 'null'
            properties:
              first_name:
                description: The first name in the shipping address.
                type:
                - string
                - 'null'
              last_name:
                description: The last name in the shipping address.
                type:
                - string
                - 'null'
              email:
                description: The email address in the shipping address.
                type:
                - string
                - 'null'
              company:
                description: The company name in the shipping address.
                type:
                - string
                - 'null'
              phone:
                description: The phone number in the shipping address.
                type:
                - string
                - 'null'
              line1:
                description: The first line of the shipping address.
                type:
                - string
                - 'null'
              line2:
                description: The second line of the shipping address.
                type:
                - string
                - 'null'
              line3:
                description: The third line of the shipping address.
                type:
                - string
                - 'null'
              city:
                description: The city in the shipping address.
                type:
                - string
                - 'null'
              state_code:
                description: The state code in the shipping address.
                type:
                - string
                - 'null'
              state:
                description: The state in the shipping address.
                type:
                - string
                - 'null'
              country:
                description: The country in the shipping address.
                type:
                - string
                - 'null'
              zip:
                description: The ZIP or postal code in the shipping address.
                type:
                - string
                - 'null'
              validation_status:
                description: The validation status of the shipping address.
                type:
                - string
                - 'null'
          referral_info:
            description: Contains details related to any referral information associated
              with the subscription
            type:
            - object
            - 'null'
            properties:
              referral_code:
                description: The code associated with the referral.
                type:
                - string
                - 'null'
              coupon_code:
                description: The coupon code used for the referral.
                type:
                - string
                - 'null'
              referral_id:
                description: The unique identifier of the referral.
                type:
                - string
                - 'null'
              external_reference_id:
                description: The external reference identifier of the referral.
                type:
                - string
                - 'null'
              reward_status:
                description: The status of the reward for the referral.
                type:
                - string
                - 'null'
              referral_system:
                description: The system handling the referrals.
                type:
                - string
                - 'null'
              account_id:
                description: The account identifier of the referral.
                type:
                - string
                - 'null'
              campaign_id:
                description: The campaign identifier of the referral.
                type:
                - string
                - 'null'
              external_campaign_id:
                description: The external campaign identifier of the referral.
                type:
                - string
                - 'null'
              friend_offer_type:
                description: The type of offer for a friend in the referral program.
                type:
                - string
                - 'null'
              referrer_reward_type:
                description: The type of reward for the referrer in the referral program.
                type:
                - string
                - 'null'
              notify_referral_system:
                description: Whether to notify the referral system.
                type:
                - string
                - 'null'
              destination_url:
                description: The URL to which the referral leads.
                type:
                - string
                - 'null'
              post_purchase_widget_enabled:
                description: Whether the post-purchase widget is enabled for the referral.
                type:
                - boolean
                - 'null'
          contract_term:
            description: Contains details about the contract term of the subscription
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the contract term.
                type:
                - string
                - 'null'
              status:
                description: The status of the contract term.
                type:
                - string
                - 'null'
              contract_start:
                description: The start date of the contract.
                type:
                - integer
                - 'null'
              contract_end:
                description: The end date of the contract.
                type:
                - integer
                - 'null'
              billing_cycle:
                description: The billing cycle duration of the contract.
                type:
                - integer
                - 'null'
              action_at_term_end:
                description: The action to be taken at the end of the contract term.
                type:
                - string
                - 'null'
              total_contract_value:
                description: The total value of the contract.
                type:
                - integer
                - 'null'
              cancellation_cutoff_period:
                description: The period within which cancellation is allowed before
                  the next term.
                type:
                - integer
                - 'null'
              created_at:
                description: The timestamp when the contract term was created.
                type:
                - integer
                - 'null'
              subscription_id:
                description: The identifier of the subscription associated with the
                  contract term.
                type:
                - string
                - 'null'
              remaining_billing_cycles:
                description: The remaining billing cycles for the contract term.
                type:
                - integer
                - 'null'
          subscription_items:
            description: Lists individual items included in the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_price_id:
                  description: The unique identifier of the item price associated
                    with the subscription item.
                  type:
                  - string
                  - 'null'
                item_type:
                  description: The type of the subscription item.
                  type:
                  - string
                  - 'null'
                quantity:
                  description: The quantity of the subscription item.
                  type:
                  - integer
                  - 'null'
                quantity_in_decimal:
                  description: The quantity in decimal format for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                unit_price:
                  description: The unit price of the subscription item.
                  type:
                  - integer
                  - 'null'
                unit_price_in_decimal:
                  description: The unit price in decimal format for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                amount:
                  description: The amount charged for the subscription item.
                  type:
                  - integer
                  - 'null'
                amount_in_decimal:
                  description: The amount in decimal format for the subscription item.
                  type:
                  - string
                  - 'null'
                free_quantity:
                  description: The free quantity included with the subscription item.
                  type:
                  - integer
                  - 'null'
                free_quantity_in_decimal:
                  description: The free quantity in decimal format for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                trial_end:
                  description: The end date of the trial period for the subscription
                    item.
                  type:
                  - integer
                  - 'null'
                billing_cycles:
                  description: The number of billing cycles for the subscription item.
                  type:
                  - integer
                  - 'null'
                service_period_days:
                  description: The number of days in the service period.
                  type:
                  - integer
                  - 'null'
                charge_on_event:
                  description: The event triggering the charge for the subscription
                    item.
                  type:
                  - string
                  - 'null'
                charge_once:
                  description: Whether the subscription item is charged only once.
                  type:
                  - boolean
                  - 'null'
                charge_on_option:
                  description: The charge option for the subscription item.
                  type:
                  - string
                  - 'null'
                object:
                  description: The type of the subscription item.
                  type:
                  - string
                  - 'null'
          item_tiers:
            description: Provides information about tiers or levels for specific subscription
              items
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_price_id:
                  description: The identifier of the item price associated with the
                    tier.
                  type:
                  - string
                  - 'null'
                starting_unit:
                  description: The starting unit of the tier.
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: The ending unit of the tier.
                  type:
                  - integer
                  - 'null'
                price:
                  description: The price of the tier.
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  description: The starting unit in decimal format for the tier.
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  description: The ending unit in decimal format for the tier.
                  type:
                  - string
                  - 'null'
                price_in_decimal:
                  description: The price in decimal format for the tier.
                  type:
                  - string
                  - 'null'
                object:
                  description: The type of the item tier.
                  type:
                  - string
                  - 'null'
          charged_items:
            description: Lists the items that have been charged as part of the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                item_price_id:
                  description: The identifier of the item price charged.
                  type:
                  - string
                  - 'null'
                last_charged_at:
                  description: The timestamp of the last charge for the item.
                  type:
                  - integer
                  - 'null'
                object:
                  description: The type of the charged item.
                  type:
                  - string
                  - 'null'
          plan_id:
            description: The ID of the plan associated with the subscription.
            type:
            - string
            - 'null'
          plan_quantity:
            description: The quantity of the plan included in the subscription.
            type:
            - integer
            - 'null'
          plan_unit_price:
            description: The unit price of the plan for the subscription.
            type:
            - integer
            - 'null'
          setup_fee:
            description: The setup fee charged for the subscription.
            type:
            - integer
            - 'null'
          billing_period:
            description: The billing period duration for the subscription.
            type:
            - integer
            - 'null'
          billing_period_unit:
            description: The unit of the billing period.
            type:
            - string
            - 'null'
          auto_collection:
            description: Indicates if auto-collection is enabled for the subscription.
            type:
            - string
            - 'null'
          plan_amount:
            description: The total amount charged for the plan of the subscription.
            type:
            - integer
            - 'null'
          plan_free_quantity:
            description: The free quantity included in the plan of the subscription.
            type:
            - integer
            - 'null'
          gift_id:
            description: The ID of the gift associated with the subscription.
            type:
            - string
            - 'null'
          affiliate_token:
            description: The affiliate token associated with the subscription.
            type:
            - string
            - 'null'
          offline_payment_method:
            description: The offline payment method used for the subscription.
            type:
            - string
            - 'null'
          meta_data:
            description: Additional metadata associated with subscription
            type:
            - object
            - 'null'
            properties: {}
          addons:
            description: Represents any additional features or services added to the
              subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The unique identifier of the addon.
                  type:
                  - string
                  - 'null'
                quantity:
                  description: The quantity of the addon.
                  type:
                  - integer
                  - 'null'
                unit_price:
                  description: The unit price of the addon.
                  type:
                  - integer
                  - 'null'
                amount:
                  description: The amount charged for the addon.
                  type:
                  - integer
                  - 'null'
                trial_end:
                  description: The end date of the trial period for the addon.
                  type:
                  - integer
                  - 'null'
                remaining_billing_cycles:
                  description: The remaining billing cycles for the addon.
                  type:
                  - integer
                  - 'null'
                quantity_in_decimal:
                  description: The quantity in decimal format for the addon.
                  type:
                  - string
                  - 'null'
                unit_price_in_decimal:
                  description: The unit price in decimal format for the addon.
                  type:
                  - string
                  - 'null'
                amount_in_decimal:
                  description: The amount in decimal format for the addon.
                  type:
                  - string
                  - 'null'
          event_based_addons:
            description: Specifies any event-based addons associated with the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The unique identifier of the event-based addon.
                  type:
                  - string
                  - 'null'
                quantity:
                  description: The quantity of the addon.
                  type:
                  - integer
                  - 'null'
                unit_price:
                  description: The unit price of the addon.
                  type:
                  - integer
                  - 'null'
                on_event:
                  description: The event triggering the addon charge.
                  type:
                  - string
                  - 'null'
                charge_once:
                  description: Whether the addon is charged only once.
                  type:
                  - boolean
                  - 'null'
                quantity_in_decimal:
                  description: The quantity in decimal format for the addon.
                  type:
                  - string
                  - 'null'
                unit_price_in_decimal:
                  description: The unit price in decimal format for the addon.
                  type:
                  - string
                  - 'null'
          charged_event_based_addons:
            description: Details of addons charged based on events
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The ID of the charged event-based addon.
                  type:
                  - string
                  - 'null'
                last_charged_at:
                  description: The date and time of the last charge for the addon.
                  type:
                  - integer
                  - 'null'
          discounts:
            description: Includes any discounts applied to the subscription
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: The unique identifier of the discount.
                  type:
                  - string
                  - 'null'
                invoice_name:
                  description: The name of the discount on the invoice.
                  type:
                  - string
                  - 'null'
                type:
                  description: The type of the discount.
                  type:
                  - string
                  - 'null'
                percentage:
                  description: The percentage value of the discount.
                  type:
                  - number
                  - 'null'
                amount:
                  description: The amount of discount applied.
                  type:
                  - integer
                  - 'null'
                currency_code:
                  description: The currency code of the discount.
                  type:
                  - string
                  - 'null'
                duration_type:
                  description: The duration type of the discount (e.g., forever, once).
                  type:
                  - string
                  - 'null'
                period:
                  description: The period for which the discount is applicable.
                  type:
                  - integer
                  - 'null'
                period_unit:
                  description: The unit of the period (e.g., days, months).
                  type:
                  - string
                  - 'null'
                included_in_mrr:
                  description: Whether the discount is included in Monthly Recurring
                    Revenue (MRR) calculation.
                  type:
                  - boolean
                  - 'null'
                apply_on:
                  description: The item to which the discount is applied.
                  type:
                  - string
                  - 'null'
                item_price_id:
                  description: The identifier of the item price associated with the
                    discount.
                  type:
                  - string
                  - 'null'
                created_at:
                  description: The timestamp when the discount was created.
                  type:
                  - integer
                  - 'null'
                apply_till:
                  description: The expiry date until which the discount is applicable.
                  type:
                  - integer
                  - 'null'
                applied_count:
                  description: The number of times the discount has been applied.
                  type:
                  - integer
                  - 'null'
                coupon_id:
                  description: The identifier of the coupon used for the discount.
                  type:
                  - string
                  - 'null'
                index:
                  description: The index of the discount.
                  type:
                  - integer
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  transaction_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Transaction
        type: object
        properties:
          id:
            description: Unique identifier of the transaction.
            type:
            - string
            - 'null'
          customer_id:
            description: The ID of the customer associated with the transaction.
            type:
            - string
            - 'null'
          subscription_id:
            description: ID of the subscription related to the transaction.
            type:
            - string
            - 'null'
          gateway_account_id:
            description: ID of the gateway account used in the transaction.
            type:
            - string
            - 'null'
          payment_source_id:
            description: ID of the payment source used in the transaction.
            type:
            - string
            - 'null'
          payment_method:
            description: Payment method used in the transaction.
            type:
            - string
            - 'null'
          refrence_number:
            description: Reference number of the transaction.
            type:
            - string
            - 'null'
          gateway:
            description: The payment gateway used in the transaction.
            type:
            - string
            - 'null'
          type:
            description: Type of the transaction.
            type:
            - string
            - 'null'
          date:
            description: Date of the transaction.
            type:
            - integer
            - 'null'
          settled_at:
            description: Date when the transaction was settled.
            type:
            - integer
            - 'null'
          exchange_rate:
            description: Exchange rate used in the transaction.
            type:
            - number
            - 'null'
          currency_code:
            description: The currency code of the transaction.
            type:
            - string
            - 'null'
          amount:
            description: The total amount of the transaction.
            type:
            - integer
            - 'null'
          id_at_gateway:
            description: Transaction ID assigned by the gateway.
            type:
            - string
            - 'null'
          status:
            description: Status of the transaction.
            type:
            - string
            - 'null'
          fraud_flag:
            description: Flag indicating if the transaction is flagged for fraud.
            type:
            - string
            - 'null'
          initiator_type:
            description: Type of initiator involved in the transaction.
            type:
            - string
            - 'null'
          three_d_secure:
            description: Flag indicating if 3D secure was used in the transaction.
            type:
            - boolean
            - 'null'
          authorization_reason:
            description: Reason for authorization of the transaction.
            type:
            - string
            - 'null'
          error_code:
            description: Error code associated with the transaction.
            type:
            - string
            - 'null'
          voided_at:
            description: Date when the transaction was voided.
            type:
            - integer
            - 'null'
          resource_version:
            description: Resource version of the transaction.
            type:
            - integer
            - 'null'
          updated_at:
            description: Date when the transaction was last updated.
            type:
            - integer
            - 'null'
          fraud_reason:
            description: Reason for flagging the transaction as fraud.
            type:
            - string
            - 'null'
          amount_unused:
            description: The amount in the transaction that remains unused.
            type:
            - integer
            - 'null'
          masked_card_number:
            description: Masked card number used in the transaction.
            type:
            - string
            - 'null'
          reference_transaction_id:
            description: ID of the reference transaction.
            type:
            - string
            - 'null'
          refunded_txn_id:
            description: ID of the refunded transaction.
            type:
            - string
            - 'null'
          reference_authorization_id:
            description: Reference authorization ID of the transaction.
            type:
            - string
            - 'null'
          amount_capturable:
            description: The remaining amount that can be captured in the transaction.
            type:
            - integer
            - 'null'
          reversal_transaction_id:
            description: ID of the reversal transaction, if any.
            type:
            - string
            - 'null'
          deleted:
            description: Flag indicating if the transaction is deleted.
            type:
            - boolean
            - 'null'
          iin:
            description: Bank identification number of the transaction.
            type:
            - string
            - 'null'
          last4:
            description: Last 4 digits of the card used in the transaction.
            type:
            - string
            - 'null'
          merchant_reference_id:
            description: Merchant reference ID of the transaction.
            type:
            - string
            - 'null'
          base_currency_code:
            description: The base currency code of the transaction.
            type:
            - string
            - 'null'
          business_entity_id:
            description: The ID of the business entity related to the transaction.
            type:
            - string
            - 'null'
          object:
            description: Type of object representing the transaction.
            type:
            - string
            - 'null'
          error_text:
            description: Error message text of the transaction.
            type:
            - string
            - 'null'
          error_detail:
            description: Detailed error information related to the transaction.
            type:
            - string
            - 'null'
          payment_method_details:
            description: Details of the payment method used in the transaction.
            type:
            - string
            - 'null'
          reference_number:
            description: Reference number associated with the transaction.
            type:
            - string
            - 'null'
          linked_invoices:
            description: Linked invoices associated with the transaction.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                invoice_id:
                  description: ID of the linked invoice.
                  type:
                  - string
                  - 'null'
                applied_amount:
                  description: Amount applied from the linked invoice.
                  type:
                  - integer
                  - 'null'
                applied_at:
                  description: Date when the invoice amount was applied.
                  type:
                  - integer
                  - 'null'
                invoice_date:
                  description: Date of the linked invoice.
                  type:
                  - integer
                  - 'null'
                invoice_total:
                  description: Total amount of the linked invoice.
                  type:
                  - integer
                  - 'null'
                invoice_status:
                  description: Status of the linked invoice.
                  type:
                  - string
                  - 'null'
          linked_credit_notes:
            description: Linked credit notes associated with the transaction.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                cn_id:
                  description: ID of the linked credit note.
                  type:
                  - string
                  - 'null'
                applied_amount:
                  description: Amount applied from the credit note.
                  type:
                  - integer
                  - 'null'
                applied_at:
                  description: Date when the credit note was applied.
                  type:
                  - integer
                  - 'null'
                cn_reason_code:
                  description: Reason code for the credit note.
                  type:
                  - string
                  - 'null'
          cn_create_reason_code:
            description: Reason code for creating a credit note.
            type:
            - string
            - 'null'
          cn_date:
            description: Date of the credit note.
            type:
            - integer
            - 'null'
          cn_total:
            description: Total amount of the credit note.
            type:
            - integer
            - 'null'
          cn_status:
            description: Status of the credit note.
            type:
            - string
            - 'null'
          cn_reference_invoice_id:
            description: ID of the invoice referenced in the credit note.
            type:
            - string
            - 'null'
          linked_refunds:
            description: Linked refunds associated with the transaction.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                txn_id:
                  description: ID of the refunded transaction.
                  type:
                  - string
                  - 'null'
                txn_status:
                  description: Status of the refunded transaction.
                  type:
                  - string
                  - 'null'
          txn_date:
            description: Date of the transaction.
            type:
            - integer
            - 'null'
          txn_amount:
            description: Amount of the transaction.
            type:
            - integer
            - 'null'
          linked_payments:
            description: Linked payments associated with the transaction.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  description: ID of the linked payment.
                  type:
                  - string
                  - 'null'
                status:
                  description: Status of the linked payment.
                  type:
                  - string
                  - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  unbilled_charge_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
        record_filter:
          condition: "{{ record['updated_at'] >= ( stream_state.get('prior_state',
            {}).get('updated_at', 0) if stream_state else stream_slice.get('prior_state',
            {}).get('updated_at', 0) ) }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: CustomIncrementalSync
      class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
      cursor_field: "updated_at"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Unbilled Charge
        type: object
        properties:
          id:
            description: Unique ID of the unbilled charge
            type:
            - string
            - 'null'
          customer_id:
            description: ID of the customer associated with the unbilled charge
            type:
            - string
            - 'null'
          subscription_id:
            description: ID of the subscription associated with the charge
            type:
            - string
            - 'null'
          date_from:
            description: Start date of the charge period
            type:
            - integer
            - 'null'
          date_to:
            description: End date of the charge period
            type:
            - integer
            - 'null'
          unit_amount:
            description: Unit amount for each unit of the charge
            type:
            - integer
            - 'null'
          pricing_model:
            description: Pricing model used for the charge
            type:
            - string
            - 'null'
          quantity:
            description: Quantity of units for the charge
            type:
            - integer
            - 'null'
          amount:
            description: Total amount of the unbilled charge
            type:
            - integer
            - 'null'
          currency_code:
            description: Currency code of the amount
            type:
            - string
            - 'null'
          discount_amount:
            description: Amount of any discounts applied to the charge
            type:
            - integer
            - 'null'
          description:
            description: Description of the unbilled charge
            type:
            - string
            - 'null'
          entity_type:
            description: Type of entity related to the charge
            type:
            - string
            - 'null'
          entity_id:
            description: ID of the entity related to the charge
            type:
            - string
            - 'null'
          is_voided:
            description: Flag to indicate if the charge has been voided
            type:
            - boolean
            - 'null'
          voided_at:
            description: Timestamp of when the charge was voided
            type:
            - integer
            - 'null'
          unit_amount_in_decimal:
            description: Unit amount in decimal format for each unit of the charge
            type:
            - string
            - 'null'
          quantity_in_decimal:
            description: Quantity of units in decimal format for the charge
            type:
            - string
            - 'null'
          amount_in_decimal:
            description: Total amount in decimal format of the unbilled charge
            type:
            - string
            - 'null'
          updated_at:
            description: Timestamp of when the charge was last updated
            type:
            - integer
            - 'null'
          is_advance_charge:
            description: Flag to indicate if the charge is an advance charge
            type:
            - boolean
            - 'null'
          deleted:
            description: Flag to indicate if the charge has been deleted
            type:
            - boolean
            - 'null'
          tiers:
            description: Details about different tiers of unbilled charges
            type:
            - object
            - 'null'
            properties:
              starting_unit:
                description: Starting unit for the tier pricing
                type:
                - integer
                - 'null'
              ending_unit:
                description: Ending unit for the tier pricing
                type:
                - integer
                - 'null'
              quantity_used:
                description: Quantity of units used in the tier
                type:
                - integer
                - 'null'
              unit_amount:
                description: Unit amount for the tier pricing
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: Starting unit in decimal format for the tier pricing
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: Ending unit in decimal format for the tier pricing
                type:
                - string
                - 'null'
              quantity_used_in_decimal:
                description: Quantity of units used in decimal format in the tier
                type:
                - string
                - 'null'
              unit_amount_in_decimal:
                description: Unit amount in decimal format for the tier pricing
                type:
                - string
                - 'null'
          object:
            description: Type of object representing the unbilled charge
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  virtual_bank_account_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Customer
        type: object
        properties:
          id:
            description: The unique identifier of the virtual bank account
            type:
            - string
            - 'null'
          customer_id:
            description: The unique identifier of the customer associated with the
              virtual bank account
            type:
            - string
            - 'null'
          email:
            description: The email address associated with the customer's virtual
              bank account
            type:
            - string
            - 'null'
          scheme:
            description: The scheme or type of the virtual bank account
            type:
            - string
            - 'null'
          bank_name:
            description: The name of the bank of the virtual bank account
            type:
            - string
            - 'null'
          account_number:
            description: The virtual bank account number associated with the customer
            type:
            - string
            - 'null'
          routing_number:
            description: The routing number associated with the virtual bank account
            type:
            - string
            - 'null'
          swift_code:
            description: The SWIFT code associated with the virtual bank account
            type:
            - string
            - 'null'
          gateway:
            description: The payment gateway used for processing transactions with
              this virtual bank account
            type:
            - string
            - 'null'
          resource_version:
            description: The version of the virtual bank account resource
            type:
            - integer
            - 'null'
          updated_at:
            description: The date and time when the virtual bank account was last
              updated
            type:
            - integer
            - 'null'
          created_at:
            description: The date and time when the virtual bank account was created
            type:
            - integer
            - 'null'
          reference_id:
            description: A reference identifier linked to the virtual bank account
            type:
            - string
            - 'null'
          deleted:
            description: Flag indicating if the virtual bank account has been deleted
            type:
            - boolean
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  quote_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: date
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Customer
        type: object
        properties:
          id:
            description: The unique identifier of the quote.
            type:
            - string
            - 'null'
          name:
            description: The name or title of the quote.
            type:
            - string
            - 'null'
          po_number:
            description: The purchase order number associated with the quote.
            type:
            - string
            - 'null'
          customer_id:
            description: The ID of the customer associated with the quote.
            type:
            - string
            - 'null'
          subscription_id:
            description: The ID of the subscription associated with the quote.
            type:
            - string
            - 'null'
          invoice_id:
            description: The ID of the invoice associated with the quote.
            type:
            - string
            - 'null'
          status:
            description: The status of the quote (e.g., draft, sent, accepted).
            type:
            - string
            - 'null'
          operation_type:
            description: The type of operation (e.g., new, modification) performed
              on the quote.
            type:
            - string
            - 'null'
          vat_number:
            description: The VAT number associated with the quote.
            type:
            - string
            - 'null'
          price_type:
            description: The type of pricing used for the quote (e.g., fixed, variable).
            type:
            - string
            - 'null'
          valid_till:
            description: The date until which the quote remains valid.
            type:
            - integer
            - 'null'
          date:
            description: The date when the quote was generated.
            type:
            - integer
            - 'null'
          total_payable:
            description: The total amount payable for the quote after all adjustments.
            type:
            - integer
            - 'null'
          charge_on_acceptance:
            description: Whether the charge is applicable on acceptance of the quote.
            type:
            - integer
            - 'null'
          sub_total:
            description: The subtotal amount before applying discounts or taxes.
            type:
            - integer
            - 'null'
          total:
            description: The total amount of the quote including all charges.
            type:
            - integer
            - 'null'
          credits_applied:
            description: The credits applied to the quote amount.
            type:
            - integer
            - 'null'
          amount_paid:
            description: The total amount that has been paid towards the quote.
            type:
            - integer
            - 'null'
          amount_due:
            description: The total amount that is due for payment in the quote.
            type:
            - integer
            - 'null'
          version:
            description: The version of the quote data.
            type:
            - integer
            - 'null'
          resource_version:
            description: The version of the resource related to the quote.
            type:
            - integer
            - 'null'
          updated_at:
            description: The last updated timestamp for the quote data.
            type:
            - integer
            - 'null'
          vat_number_prefix:
            description: The prefix used for the VAT number in the quote.
            type:
            - string
            - 'null'
          currency_code:
            description: The currency code used for all monetary values in the quote.
            type:
            - string
            - 'null'
          notes:
            description: Any additional notes or comments related to the quote.
            type:
            - array
            - 'null'
          contract_term_start:
            description: The start date of the contract terms for the quote.
            type:
            - integer
            - 'null'
          contract_term_end:
            description: The end date of the contract terms for the quote.
            type:
            - integer
            - 'null'
          contract_term_termination_fee:
            description: The fee applicable for terminating the contract terms.
            type:
            - integer
            - 'null'
          business_entity_id:
            description: The ID of the business entity related to the quote.
            type:
            - string
            - 'null'
          line_items:
            description: Individual line items included in the quote.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  type:
                  - string
                  - 'null'
                subscription_id:
                  type:
                  - string
                  - 'null'
                date_from:
                  type:
                  - integer
                  - 'null'
                date_to:
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  type:
                  - integer
                  - 'null'
                quantity:
                  type:
                  - integer
                  - 'null'
                amount:
                  type:
                  - integer
                  - 'null'
                pricing_model:
                  type:
                  - string
                  - 'null'
                is_taxed:
                  type:
                  - boolean
                  - 'null'
                tax_amount:
                  type:
                  - integer
                  - 'null'
                tax_rate:
                  type:
                  - number
                  - 'null'
                unit_amount_in_decimal:
                  type:
                  - string
                  - 'null'
                quantity_in_decimal:
                  type:
                  - string
                  - 'null'
                amount_in_decimal:
                  type:
                  - string
                  - 'null'
                discount_amount:
                  type:
                  - integer
                  - 'null'
                item_level_discount_amount:
                  type:
                  - integer
                  - 'null'
                reference_line_item_id:
                  type:
                  - string
                  - 'null'
                description:
                  type:
                  - string
                  - 'null'
                entity_description:
                  type:
                  - string
                  - 'null'
                entity_type:
                  type:
                  - string
                  - 'null'
                tax_exempt_reason:
                  type:
                  - string
                  - 'null'
                entity_id:
                  type:
                  - string
                  - 'null'
                customer_id:
                  type:
                  - string
                  - 'null'
                metered:
                  type:
                  - boolean
                  - 'null'
                object:
                  type:
                  - string
                  - 'null'
          discounts:
            description: Discounts applied to the quote.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                amount:
                  type:
                  - integer
                  - 'null'
                description:
                  type:
                  - string
                  - 'null'
                line_item_id:
                  type:
                  - string
                  - 'null'
                entity_type:
                  type:
                  - string
                  - 'null'
                discount_type:
                  type:
                  - string
                  - 'null'
                entity_id:
                  type:
                  - string
                  - 'null'
                coupon_set_code:
                  type:
                  - string
                  - 'null'
                object:
                  type:
                  - string
                  - 'null'
          line_item_discounts:
            description: Discounts applied at the line item level.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  type:
                  - string
                  - 'null'
                discount_type:
                  type:
                  - string
                  - 'null'
                entity_id:
                  type:
                  - string
                  - 'null'
                discount_amount:
                  type:
                  - integer
                  - 'null'
                object:
                  type:
                  - string
                  - 'null'
          taxes:
            description: Taxes applied to the overall quote amount.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                name:
                  type:
                  - string
                  - 'null'
                amount:
                  type:
                  - integer
                  - 'null'
                description:
                  type:
                  - string
                  - 'null'
          line_item_taxes:
            description: Taxes applied at the line item level.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  type:
                  - string
                  - 'null'
                tax_name:
                  type:
                  - string
                  - 'null'
                tax_rate:
                  type:
                  - number
                  - 'null'
                is_partial_tax_applied:
                  type:
                  - boolean
                  - 'null'
                is_non_compliance_tax:
                  type:
                  - boolean
                  - 'null'
                taxable_amount:
                  type:
                  - integer
                  - 'null'
                tax_amount:
                  type:
                  - integer
                  - 'null'
                tax_juris_type:
                  type:
                  - string
                  - 'null'
                tax_juris_name:
                  type:
                  - string
                  - 'null'
                tax_juris_code:
                  type:
                  - string
                  - 'null'
                tax_amount_in_local_currency:
                  type:
                  - integer
                  - 'null'
                local_currency_code:
                  type:
                  - string
                  - 'null'
          line_item_tiers:
            description: Tiers related to line items in the quote.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  type:
                  - string
                  - 'null'
                starting_unit:
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  type:
                  - integer
                  - 'null'
                quantity_used:
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  type:
                  - integer
                  - 'null'
                starting_unit_in_decimal:
                  type:
                  - string
                  - 'null'
                ending_unit_in_decimal:
                  type:
                  - string
                  - 'null'
                quantity_used_in_decimal:
                  type:
                  - string
                  - 'null'
                unit_amount_in_decimal:
                  type:
                  - string
                  - 'null'
          shipping_address:
            description: The shipping address associated with the quote.
            type:
            - object
            - 'null'
            properties:
              first_name:
                type:
                - string
                - 'null'
              last_name:
                type:
                - string
                - 'null'
              email:
                type:
                - string
                - 'null'
              company:
                type:
                - string
                - 'null'
              phone:
                type:
                - string
                - 'null'
              line1:
                type:
                - string
                - 'null'
              line2:
                type:
                - string
                - 'null'
              line3:
                type:
                - string
                - 'null'
              city:
                type:
                - string
                - 'null'
              state_code:
                type:
                - string
                - 'null'
              state:
                type:
                - string
                - 'null'
              country:
                type:
                - string
                - 'null'
              zip:
                type:
                - string
                - 'null'
              validation_status:
                type:
                - string
                - 'null'
              index:
                type:
                - integer
                - 'null'
              object:
                type:
                - string
                - 'null'
          billing_address:
            description: The billing address associated with the quote.
            type:
            - object
            - 'null'
            properties:
              first_name:
                type:
                - string
                - 'null'
              last_name:
                type:
                - string
                - 'null'
              email:
                type:
                - string
                - 'null'
              company:
                type:
                - string
                - 'null'
              phone:
                type:
                - string
                - 'null'
              line1:
                type:
                - string
                - 'null'
              line2:
                type:
                - string
                - 'null'
              line3:
                type:
                - string
                - 'null'
              city:
                type:
                - string
                - 'null'
              state_code:
                type:
                - string
                - 'null'
              state:
                type:
                - string
                - 'null'
              country:
                type:
                - string
                - 'null'
              zip:
                type:
                - string
                - 'null'
              validation_status:
                type:
                - string
                - 'null'
              object:
                type:
                - string
                - 'null'
          object:
            description: The object type representing the quote.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  quote_line_group_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - http_codes:
              - 404
              action: IGNORE
              error_message: "Entity unavailable. Quote may have been deleted."
      partition_router:
        type: SubstreamPartitionRouter
        parent_stream_configs:
        - type: ParentStreamConfig
          stream:
            retriever:
              type: SimpleRetriever
              record_selector:
                type: RecordSelector
                extractor:
                  type: DpathExtractor
                  field_path:
                  - "list"
                  - "*"
                  - "{{ parameters.get('name') }}"
              paginator:
                type: DefaultPaginator
                pagination_strategy:
                  type: "CursorPagination"
                  cursor_value: "{{ response.get('next_offset')|tojson() }}"
                  stop_condition: "{{ not response.next_offset }}"
                  page_size_option:
                    type: RequestOption
                    inject_into: request_parameter
                    field_name: limit
                    page_size: 100
                page_token_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: offset
              requester:
                type: HttpRequester
                url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
                http_method: "GET"
                authenticator:
                  type: BasicHttpAuthenticator
                  username: "{{ config['site_api_key'] }}"
                error_handler:
                  type: CompositeErrorHandler
                  error_handlers:
                  - type: DefaultErrorHandler
                    response_filters:
                    - error_message_contains: "This API operation is not enabled for
                        this site"
                      action: IGNORE
                      error_message: "Stream is available only for Product Catalog
                        1.0"
                  - type: DefaultErrorHandler
                    backoff_strategies:
                    - type: WaitTimeFromHeader
                      header: "Retry-After"
                request_parameters:
                  sort_by[asc]: date
                  include_deleted: "true"
                  updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
            transformations:
            - type: CustomTransformation
              class_name: source_declarative_manifest.components.CustomFieldTransformation
            incremental_sync:
              type: DatetimeBasedCursor
              start_datetime:
                datetime: "{{ format_datetime(config['start_date'], '%s') }}"
                datetime_format: "%s"
              end_datetime:
                datetime: "{{ now_utc().strftime('%s') }}"
                datetime_format: "%s"
              datetime_format: "%s"
              cursor_granularity: PT1S
              step: P1M
              cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
                }}"
            schema_loader:
              type: InlineSchemaLoader
              schema:
                $schema: http://json-schema.org/draft-07/schema#
                name: Customer
                type: object
                properties:
                  id:
                    description: The unique identifier of the quote.
                    type:
                    - string
                    - 'null'
                  name:
                    description: The name or title of the quote.
                    type:
                    - string
                    - 'null'
                  po_number:
                    description: The purchase order number associated with the quote.
                    type:
                    - string
                    - 'null'
                  customer_id:
                    description: The ID of the customer associated with the quote.
                    type:
                    - string
                    - 'null'
                  subscription_id:
                    description: The ID of the subscription associated with the quote.
                    type:
                    - string
                    - 'null'
                  invoice_id:
                    description: The ID of the invoice associated with the quote.
                    type:
                    - string
                    - 'null'
                  status:
                    description: The status of the quote (e.g., draft, sent, accepted).
                    type:
                    - string
                    - 'null'
                  operation_type:
                    description: The type of operation (e.g., new, modification) performed
                      on the quote.
                    type:
                    - string
                    - 'null'
                  vat_number:
                    description: The VAT number associated with the quote.
                    type:
                    - string
                    - 'null'
                  price_type:
                    description: The type of pricing used for the quote (e.g., fixed,
                      variable).
                    type:
                    - string
                    - 'null'
                  valid_till:
                    description: The date until which the quote remains valid.
                    type:
                    - integer
                    - 'null'
                  date:
                    description: The date when the quote was generated.
                    type:
                    - integer
                    - 'null'
                  total_payable:
                    description: The total amount payable for the quote after all
                      adjustments.
                    type:
                    - integer
                    - 'null'
                  charge_on_acceptance:
                    description: Whether the charge is applicable on acceptance of
                      the quote.
                    type:
                    - integer
                    - 'null'
                  sub_total:
                    description: The subtotal amount before applying discounts or
                      taxes.
                    type:
                    - integer
                    - 'null'
                  total:
                    description: The total amount of the quote including all charges.
                    type:
                    - integer
                    - 'null'
                  credits_applied:
                    description: The credits applied to the quote amount.
                    type:
                    - integer
                    - 'null'
                  amount_paid:
                    description: The total amount that has been paid towards the quote.
                    type:
                    - integer
                    - 'null'
                  amount_due:
                    description: The total amount that is due for payment in the quote.
                    type:
                    - integer
                    - 'null'
                  version:
                    description: The version of the quote data.
                    type:
                    - integer
                    - 'null'
                  resource_version:
                    description: The version of the resource related to the quote.
                    type:
                    - integer
                    - 'null'
                  updated_at:
                    description: The last updated timestamp for the quote data.
                    type:
                    - integer
                    - 'null'
                  vat_number_prefix:
                    description: The prefix used for the VAT number in the quote.
                    type:
                    - string
                    - 'null'
                  currency_code:
                    description: The currency code used for all monetary values in
                      the quote.
                    type:
                    - string
                    - 'null'
                  notes:
                    description: Any additional notes or comments related to the quote.
                    type:
                    - array
                    - 'null'
                  contract_term_start:
                    description: The start date of the contract terms for the quote.
                    type:
                    - integer
                    - 'null'
                  contract_term_end:
                    description: The end date of the contract terms for the quote.
                    type:
                    - integer
                    - 'null'
                  contract_term_termination_fee:
                    description: The fee applicable for terminating the contract terms.
                    type:
                    - integer
                    - 'null'
                  business_entity_id:
                    description: The ID of the business entity related to the quote.
                    type:
                    - string
                    - 'null'
                  line_items:
                    description: Individual line items included in the quote.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        id:
                          type:
                          - string
                          - 'null'
                        subscription_id:
                          type:
                          - string
                          - 'null'
                        date_from:
                          type:
                          - integer
                          - 'null'
                        date_to:
                          type:
                          - integer
                          - 'null'
                        unit_amount:
                          type:
                          - integer
                          - 'null'
                        quantity:
                          type:
                          - integer
                          - 'null'
                        amount:
                          type:
                          - integer
                          - 'null'
                        pricing_model:
                          type:
                          - string
                          - 'null'
                        is_taxed:
                          type:
                          - boolean
                          - 'null'
                        tax_amount:
                          type:
                          - integer
                          - 'null'
                        tax_rate:
                          type:
                          - number
                          - 'null'
                        unit_amount_in_decimal:
                          type:
                          - string
                          - 'null'
                        quantity_in_decimal:
                          type:
                          - string
                          - 'null'
                        amount_in_decimal:
                          type:
                          - string
                          - 'null'
                        discount_amount:
                          type:
                          - integer
                          - 'null'
                        item_level_discount_amount:
                          type:
                          - integer
                          - 'null'
                        reference_line_item_id:
                          type:
                          - string
                          - 'null'
                        description:
                          type:
                          - string
                          - 'null'
                        entity_description:
                          type:
                          - string
                          - 'null'
                        entity_type:
                          type:
                          - string
                          - 'null'
                        tax_exempt_reason:
                          type:
                          - string
                          - 'null'
                        entity_id:
                          type:
                          - string
                          - 'null'
                        customer_id:
                          type:
                          - string
                          - 'null'
                        metered:
                          type:
                          - boolean
                          - 'null'
                        object:
                          type:
                          - string
                          - 'null'
                  discounts:
                    description: Discounts applied to the quote.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        amount:
                          type:
                          - integer
                          - 'null'
                        description:
                          type:
                          - string
                          - 'null'
                        line_item_id:
                          type:
                          - string
                          - 'null'
                        entity_type:
                          type:
                          - string
                          - 'null'
                        discount_type:
                          type:
                          - string
                          - 'null'
                        entity_id:
                          type:
                          - string
                          - 'null'
                        coupon_set_code:
                          type:
                          - string
                          - 'null'
                        object:
                          type:
                          - string
                          - 'null'
                  line_item_discounts:
                    description: Discounts applied at the line item level.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        line_item_id:
                          type:
                          - string
                          - 'null'
                        discount_type:
                          type:
                          - string
                          - 'null'
                        entity_id:
                          type:
                          - string
                          - 'null'
                        discount_amount:
                          type:
                          - integer
                          - 'null'
                        object:
                          type:
                          - string
                          - 'null'
                  taxes:
                    description: Taxes applied to the overall quote amount.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        name:
                          type:
                          - string
                          - 'null'
                        amount:
                          type:
                          - integer
                          - 'null'
                        description:
                          type:
                          - string
                          - 'null'
                  line_item_taxes:
                    description: Taxes applied at the line item level.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        line_item_id:
                          type:
                          - string
                          - 'null'
                        tax_name:
                          type:
                          - string
                          - 'null'
                        tax_rate:
                          type:
                          - number
                          - 'null'
                        is_partial_tax_applied:
                          type:
                          - boolean
                          - 'null'
                        is_non_compliance_tax:
                          type:
                          - boolean
                          - 'null'
                        taxable_amount:
                          type:
                          - integer
                          - 'null'
                        tax_amount:
                          type:
                          - integer
                          - 'null'
                        tax_juris_type:
                          type:
                          - string
                          - 'null'
                        tax_juris_name:
                          type:
                          - string
                          - 'null'
                        tax_juris_code:
                          type:
                          - string
                          - 'null'
                        tax_amount_in_local_currency:
                          type:
                          - integer
                          - 'null'
                        local_currency_code:
                          type:
                          - string
                          - 'null'
                  line_item_tiers:
                    description: Tiers related to line items in the quote.
                    type:
                    - array
                    - 'null'
                    items:
                      type:
                      - object
                      - 'null'
                      properties:
                        line_item_id:
                          type:
                          - string
                          - 'null'
                        starting_unit:
                          type:
                          - integer
                          - 'null'
                        ending_unit:
                          type:
                          - integer
                          - 'null'
                        quantity_used:
                          type:
                          - integer
                          - 'null'
                        unit_amount:
                          type:
                          - integer
                          - 'null'
                        starting_unit_in_decimal:
                          type:
                          - string
                          - 'null'
                        ending_unit_in_decimal:
                          type:
                          - string
                          - 'null'
                        quantity_used_in_decimal:
                          type:
                          - string
                          - 'null'
                        unit_amount_in_decimal:
                          type:
                          - string
                          - 'null'
                  shipping_address:
                    description: The shipping address associated with the quote.
                    type:
                    - object
                    - 'null'
                    properties:
                      first_name:
                        type:
                        - string
                        - 'null'
                      last_name:
                        type:
                        - string
                        - 'null'
                      email:
                        type:
                        - string
                        - 'null'
                      company:
                        type:
                        - string
                        - 'null'
                      phone:
                        type:
                        - string
                        - 'null'
                      line1:
                        type:
                        - string
                        - 'null'
                      line2:
                        type:
                        - string
                        - 'null'
                      line3:
                        type:
                        - string
                        - 'null'
                      city:
                        type:
                        - string
                        - 'null'
                      state_code:
                        type:
                        - string
                        - 'null'
                      state:
                        type:
                        - string
                        - 'null'
                      country:
                        type:
                        - string
                        - 'null'
                      zip:
                        type:
                        - string
                        - 'null'
                      validation_status:
                        type:
                        - string
                        - 'null'
                      index:
                        type:
                        - integer
                        - 'null'
                      object:
                        type:
                        - string
                        - 'null'
                  billing_address:
                    description: The billing address associated with the quote.
                    type:
                    - object
                    - 'null'
                    properties:
                      first_name:
                        type:
                        - string
                        - 'null'
                      last_name:
                        type:
                        - string
                        - 'null'
                      email:
                        type:
                        - string
                        - 'null'
                      company:
                        type:
                        - string
                        - 'null'
                      phone:
                        type:
                        - string
                        - 'null'
                      line1:
                        type:
                        - string
                        - 'null'
                      line2:
                        type:
                        - string
                        - 'null'
                      line3:
                        type:
                        - string
                        - 'null'
                      city:
                        type:
                        - string
                        - 'null'
                      state_code:
                        type:
                        - string
                        - 'null'
                      state:
                        type:
                        - string
                        - 'null'
                      country:
                        type:
                        - string
                        - 'null'
                      zip:
                        type:
                        - string
                        - 'null'
                      validation_status:
                        type:
                        - string
                        - 'null'
                      object:
                        type:
                        - string
                        - 'null'
                  object:
                    description: The object type representing the quote.
                    type:
                    - string
                    - 'null'
                  custom_fields: _definitions.json#/definitions/custom_fields
          parent_key: id
          partition_field: id
          incremental_dependency: true
    transformations:
    - type: AddFields
      fields:
      - path:
        - "quote_id"
        value: "{{ stream_slice.id }}"
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Quote Line Group
        type: object
        properties:
          version:
            description: The version of the quote line group.
            type:
            - integer
            - 'null'
          id:
            description: Unique identifier for the quote line group.
            type:
            - string
            - 'null'
          quote_id:
            description: Unique identifier for the quote associated with the line
              group.
            type:
            - string
            - 'null'
          sub_total:
            description: The subtotal amount of the quote line group.
            type:
            - integer
            - 'null'
          total:
            description: The total amount for the quote line group after all calculations.
            type:
            - integer
            - 'null'
          credits_applied:
            description: The amount of credits applied to the quote line group.
            type:
            - integer
            - 'null'
          amount_paid:
            description: The total amount that has been paid.
            type:
            - integer
            - 'null'
          amount_due:
            description: The total amount that is due for payment.
            type:
            - integer
            - 'null'
          charge_event:
            description: Details about the charge event associated with the quote
              line group.
            type:
            - string
            - 'null'
          billing_cycle_number:
            description: The number indicating the current billing cycle.
            type:
            - integer
            - 'null'
          line_items:
            description: Details about the line items included in the quote line group.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                id:
                  type:
                  - string
                  - 'null'
                subscription_id:
                  type:
                  - string
                  - 'null'
                date_from:
                  type:
                  - integer
                  - 'null'
                date_to:
                  type:
                  - integer
                  - 'null'
                unit_amount:
                  type:
                  - integer
                  - 'null'
                quantity:
                  type:
                  - integer
                  - 'null'
                amount:
                  type:
                  - integer
                  - 'null'
                pricing_model:
                  type:
                  - string
                  - 'null'
                is_taxed:
                  type:
                  - boolean
                  - 'null'
                tax_amount:
                  type:
                  - integer
                  - 'null'
                tax_rate:
                  type:
                  - number
                  - 'null'
                unit_amount_in_decimal:
                  type:
                  - string
                  - 'null'
                quantity_in_decimal:
                  type:
                  - string
                  - 'null'
                amount_in_decimal:
                  type:
                  - string
                  - 'null'
                discount_amount:
                  type:
                  - integer
                  - 'null'
                item_level_discount_amount:
                  type:
                  - integer
                  - 'null'
                reference_line_item_id:
                  type:
                  - string
                  - 'null'
                description:
                  type:
                  - string
                  - 'null'
                entity_description:
                  type:
                  - string
                  - 'null'
                entity_type:
                  type:
                  - string
                  - 'null'
                tax_exempt_reason:
                  type:
                  - string
                  - 'null'
                entity_id:
                  type:
                  - string
                  - 'null'
                customer_id:
                  type:
                  - string
                  - 'null'
                metered:
                  type:
                  - boolean
                  - 'null'
                object:
                  type:
                  - string
                  - 'null'
          discounts:
            description: Details about any discounts applied to the quote line group.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                amount:
                  type:
                  - integer
                  - 'null'
                description:
                  type:
                  - string
                  - 'null'
                line_item_id:
                  type:
                  - string
                  - 'null'
                entity_type:
                  type:
                  - string
                  - 'null'
                discount_type:
                  type:
                  - string
                  - 'null'
                entity_id:
                  type:
                  - string
                  - 'null'
                coupon_set_code:
                  type:
                  - string
                  - 'null'
                object:
                  type:
                  - string
                  - 'null'
          line_item_discounts:
            description: Details about any discounts applied to individual line items
              within the quote line group.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  type:
                  - string
                  - 'null'
                discount_type:
                  type:
                  - string
                  - 'null'
                entity_id:
                  type:
                  - string
                  - 'null'
                discount_amount:
                  type:
                  - integer
                  - 'null'
                object:
                  type:
                  - string
                  - 'null'
          taxes:
            description: Details about the taxes applied to the quote line group.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                name:
                  type:
                  - string
                  - 'null'
                amount:
                  type:
                  - integer
                  - 'null'
                description:
                  type:
                  - string
                  - 'null'
          line_item_taxes:
            description: Details about taxes applied to individual line items within
              the quote line group.
            type:
            - array
            - 'null'
            items:
              type:
              - object
              - 'null'
              properties:
                line_item_id:
                  type:
                  - string
                  - 'null'
                tax_name:
                  type:
                  - string
                  - 'null'
                tax_rate:
                  type:
                  - number
                  - 'null'
                is_partial_tax_applied:
                  type:
                  - boolean
                  - 'null'
                is_non_compliance_tax:
                  type:
                  - boolean
                  - 'null'
                taxable_amount:
                  type:
                  - integer
                  - 'null'
                tax_amount:
                  type:
                  - integer
                  - 'null'
                tax_juris_type:
                  type:
                  - string
                  - 'null'
                tax_juris_name:
                  type:
                  - string
                  - 'null'
                tax_juris_code:
                  type:
                  - string
                  - 'null'
                tax_amount_in_local_currency:
                  type:
                  - integer
                  - 'null'
                local_currency_code:
                  type:
                  - string
                  - 'null'
          object:
            description: Type of object representing the quote line group.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  site_migration_detail_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
        record_filter:
          condition: "{{ record['migrated_at'] >= ( stream_state.get('prior_state',
            {}).get('migrated_at', 0) if stream_state else stream_slice.get('prior_state',
            {}).get('migrated_at', 0) ) }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: CustomIncrementalSync
      class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
      cursor_field: "migrated_at"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Site Migration Detail
        type: object
        properties:
          entity_id:
            description: ID of the entity being migrated at the current site.
            type:
            - string
            - 'null'
          other_site_name:
            description: Name of the site from which the entity was migrated.
            type:
            - string
            - 'null'
          entity_id_at_other_site:
            description: ID of the entity at the other site where migration occurred.
            type:
            - string
            - 'null'
          migrated_at:
            description: Timestamp indicating when the migration took place.
            type:
            - integer
            - 'null'
          entity_type:
            description: Type of entity being migrated (e.g., customer, subscription).
            type:
            - string
            - 'null'
          status:
            description: Current status of the site migration process.
            type:
            - string
            - 'null'
          object:
            description: Type of object being migrated (e.g., user, data).
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  comment_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: created_at
          created_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Comment
        type: object
        properties:
          id:
            description: The unique identifier of the comment.
            type:
            - string
            - 'null'
          entity_type:
            description: The type of entity (e.g., customer, invoice) that the comment
              is related to.
            type:
            - string
            - 'null'
          added_by:
            description: The user who added the comment.
            type:
            - string
            - 'null'
          notes:
            description: The actual content of the comment or notes added.
            type:
            - string
            - 'null'
          created_at:
            description: The timestamp indicating when the comment was created.
            type:
            - integer
            - 'null'
          type:
            description: The type or category of the comment (e.g., general, issue).
            type:
            - string
            - 'null'
          entity_id:
            description: The unique identifier of the entity the comment is associated
              with.
            type:
            - string
            - 'null'
          object:
            description: The object to which the comment is attached.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  item_family_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Item Families
        type: object
        properties:
          id:
            description: The unique identifier for the item family.
            type:
            - string
            - 'null'
          name:
            description: The name of the item family.
            type:
            - string
            - 'null'
          description:
            description: A brief description of the item family.
            type:
            - string
            - 'null'
          status:
            description: The status of the item family.
            type:
            - string
            - 'null'
          resource_version:
            description: The resource version of the item family data.
            type:
            - integer
            - 'null'
          updated_at:
            description: The timestamp when the item family was last updated.
            type:
            - integer
            - 'null'
          channel:
            description: The channel associated with the item family.
            type:
            - string
            - 'null'
          object:
            description: The type of object, in this case, 'item_family'.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
  differential_price_stream:
    retriever:
      type: SimpleRetriever
      record_selector:
        type: RecordSelector
        extractor:
          type: DpathExtractor
          field_path:
          - "list"
          - "*"
          - "{{ parameters.get('name') }}"
      paginator:
        type: DefaultPaginator
        pagination_strategy:
          type: "CursorPagination"
          cursor_value: "{{ response.get('next_offset')|tojson() }}"
          stop_condition: "{{ not response.next_offset }}"
          page_size_option:
            type: RequestOption
            inject_into: request_parameter
            field_name: limit
            page_size: 100
        page_token_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: offset
      requester:
        type: HttpRequester
        url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
        http_method: "GET"
        authenticator:
          type: BasicHttpAuthenticator
          username: "{{ config['site_api_key'] }}"
        error_handler:
          type: CompositeErrorHandler
          error_handlers:
          - type: DefaultErrorHandler
            response_filters:
            - error_message_contains: "This API operation is not enabled for this
                site"
              action: IGNORE
              error_message: "Stream is available only for Product Catalog 1.0"
          - type: DefaultErrorHandler
            backoff_strategies:
            - type: WaitTimeFromHeader
              header: "Retry-After"
        request_parameters:
          sort_by[asc]: updated_at
          include_deleted: "true"
          updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
    transformations:
    - type: CustomTransformation
      class_name: source_declarative_manifest.components.CustomFieldTransformation
    incremental_sync:
      type: DatetimeBasedCursor
      start_datetime:
        datetime: "{{ format_datetime(config['start_date'], '%s') }}"
        datetime_format: "%s"
      end_datetime:
        datetime: "{{ now_utc().strftime('%s') }}"
        datetime_format: "%s"
      datetime_format: "%s"
      cursor_granularity: PT1S
      step: P1M
      cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
    schema_loader:
      type: InlineSchemaLoader
      schema:
        $schema: http://json-schema.org/draft-07/schema#
        name: Add-on
        type: object
        properties:
          id:
            description: The unique identifier for the differential price data.
            type:
            - string
            - 'null'
          item_price_id:
            description: The identifier of the item price related to the differential
              price.
            type:
            - string
            - 'null'
          parent_item_id:
            description: The ID of the parent item linked to this differential price
              data.
            type:
            - string
            - 'null'
          price:
            description: The price value of the differential price.
            type:
            - integer
            - 'null'
          price_in_decimal:
            description: The price value in decimal format for precise calculations.
            type:
            - string
            - 'null'
          status:
            description: The status of the differential price data (e.g., active,
              inactive).
            type:
            - string
            - 'null'
          resource_version:
            description: The version of the resource for tracking changes.
            type:
            - integer
            - 'null'
          updated_at:
            description: The timestamp when the differential price data was last updated.
            type:
            - integer
            - 'null'
          created_at:
            description: The timestamp when the differential price data was created.
            type:
            - integer
            - 'null'
          modified_at:
            description: The timestamp when the differential price data was last modified.
            type:
            - integer
            - 'null'
          currency_code:
            description: The currency code associated with the differential price
              data.
            type:
            - string
            - 'null'
          tiers:
            description: Contains information about price tiers
            type:
            - array
            - 'null'
            items:
              type: object
              properties:
                starting_unit:
                  description: The starting unit for a specific price tier.
                  type:
                  - integer
                  - 'null'
                ending_unit:
                  description: The end unit for a specific price tier.
                  type:
                  - integer
                  - 'null'
                price:
                  description: The price for the tier within specified units.
                  type:
                  - integer
                  - 'null'
          parent_periods:
            description: Contains information about the parent periods
            type:
            - array
            - 'null'
            items:
              type: object
              properties:
                period_unit:
                  description: The unit of the period (e.g., days, months) for the
                    parent item.
                  type:
                  - string
                  - 'null'
                period:
                  description: The period associated with the parent item.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - integer
                    - 'null'
          object:
            description: The object type which this data represents.
            type:
            - string
            - 'null'
          custom_fields: _definitions.json#/definitions/custom_fields
streams:
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/addons"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Add-on
      type: object
      properties:
        id:
          description: Unique identifier for the addon.
          type:
          - string
          - 'null'
        name:
          description: Name of the addon.
          type:
          - string
          - 'null'
        invoice_name:
          description: Name to be displayed on the invoice for the addon.
          type:
          - string
          - 'null'
        description:
          description: Description of the addon.
          type:
          - string
          - 'null'
        pricing_model:
          description: Model used for pricing the addon.
          type:
          - string
          - 'null'
        charge_type:
          description: Type of charge for the addon.
          type:
          - string
          - 'null'
        price:
          description: Price of the addon.
          type:
          - integer
          - 'null'
        currency_code:
          description: Currency code for the addon pricing.
          type:
          - string
          - 'null'
        period:
          description: Duration of the addon period.
          type:
          - integer
          - 'null'
        period_unit:
          description: Unit of duration for the addon period.
          type:
          - string
          - 'null'
        unit:
          description: Unit of the addon quantity.
          type:
          - string
          - 'null'
        status:
          description: Status of the addon.
          type:
          - string
          - 'null'
        archived_at:
          description: Timestamp indicating when the addon was archived.
          type:
          - integer
          - 'null'
        enabled_in_portal:
          description: Indicator for whether the addon is enabled in the customer
            portal.
          type:
          - boolean
          - 'null'
        tax_code:
          description: Tax code associated with the addon.
          type:
          - string
          - 'null'
        taxjar_product_code:
          description: TaxJar product code for tax calculation.
          type:
          - string
          - 'null'
        avalara_sale_type:
          description: Avalara sale type for tax calculation.
          type:
          - string
          - 'null'
        avalara_transaction_type:
          description: Avalara transaction type for tax calculation.
          type:
          - integer
          - 'null'
        avalara_service_type:
          description: Avalara service type for tax calculation.
          type:
          - integer
          - 'null'
        sku:
          description: Stock Keeping Unit (SKU) for the addon.
          type:
          - string
          - 'null'
        accounting_code:
          description: Accounting code for the addon.
          type:
          - string
          - 'null'
        accounting_category1:
          description: First accounting category for the addon.
          type:
          - string
          - 'null'
        accounting_category2:
          description: Second accounting category for the addon.
          type:
          - string
          - 'null'
        accounting_category3:
          description: Third accounting category for the addon.
          type:
          - string
          - 'null'
        accounting_category4:
          description: Fourth accounting category for the addon.
          type:
          - string
          - 'null'
        is_shippable:
          description: Indicator for whether the addon is shippable.
          type:
          - boolean
          - 'null'
        shipping_frequency_period:
          description: Frequency of shipping for the addon period.
          type:
          - integer
          - 'null'
        shipping_frequency_period_unit:
          description: Unit of frequency for shipping the addon.
          type:
          - string
          - 'null'
        resource_version:
          description: Version of the resource.
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp of the last update to the addon data.
          type:
          - integer
          - 'null'
        price_in_decimal:
          description: Price of the addon in decimal format.
          type:
          - string
          - 'null'
        included_in_mrr:
          description: Indicator for whether the addon is included in Monthly Recurring
            Revenue (MRR).
          type:
          - boolean
          - 'null'
        invoice_notes:
          description: Additional notes to include on the invoice for the addon.
          type:
          - string
          - 'null'
        taxable:
          description: Indicator for whether the addon is taxable.
          type:
          - boolean
          - 'null'
        tax_profile_id:
          description: Tax profile identifier for the addon.
          type:
          - string
          - 'null'
        meta_data:
          description: Additional metadata associated with the addon.
          type:
          - object
          - 'null'
          properties: {}
        show_description_in_invoices:
          description: Indicator for whether the description should appear on invoices.
          type:
          - boolean
          - 'null'
        show_description_in_quotes:
          description: Indicator for whether the description should appear on quotes.
          type:
          - boolean
          - 'null'
        channel:
          description: Channel for which the addon is applicable.
          type:
          - string
          - 'null'
        object:
          description: Type of object, in this case, addon.
          type:
          - string
          - 'null'
        type:
          description: Type of addon.
          type:
          - string
          - 'null'
        tiers:
          description: Tiers with specific pricing for the addon.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              starting_unit:
                description: Starting unit quantity for the tier.
                type:
                - integer
                - 'null'
              ending_unit:
                description: Ending unit quantity for the tier.
                type:
                - integer
                - 'null'
              price:
                description: Price of the tier.
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: Starting unit quantity in decimal for the tier.
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: Ending unit quantity in decimal for the tier.
                type:
                - string
                - 'null'
              price_in_decimal:
                description: Price of the tier in decimal format.
                type:
                - string
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "addon"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      path: "/items/{{ stream_slice.item_id }}/attached_items"
    partition_router:
      type: SubstreamPartitionRouter
      parent_stream_configs:
      - type: ParentStreamConfig
        stream:
          retriever:
            type: SimpleRetriever
            record_selector:
              type: RecordSelector
              extractor:
                type: DpathExtractor
                field_path:
                - "list"
                - "*"
                - "{{ parameters.get('name') }}"
            paginator:
              type: DefaultPaginator
              pagination_strategy:
                type: "CursorPagination"
                cursor_value: "{{ response.get('next_offset')|tojson() }}"
                stop_condition: "{{ not response.next_offset }}"
                page_size_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: limit
                  page_size: 100
              page_token_option:
                type: RequestOption
                inject_into: request_parameter
                field_name: offset
            requester:
              type: HttpRequester
              url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
              http_method: "GET"
              authenticator:
                type: BasicHttpAuthenticator
                username: "{{ config['site_api_key'] }}"
              error_handler:
                type: CompositeErrorHandler
                error_handlers:
                - type: DefaultErrorHandler
                  response_filters:
                  - error_message_contains: "This API operation is not enabled for
                      this site"
                    action: IGNORE
                    error_message: "Stream is available only for Product Catalog 1.0"
                    type: HttpResponseFilter
                - type: DefaultErrorHandler
                  backoff_strategies:
                  - type: WaitTimeFromHeader
                    header: "Retry-After"
              request_parameters:
                sort_by[asc]: updated_at
                include_deleted: "true"
                updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
              path: "/items"
          transformations:
          - type: CustomTransformation
            class_name: source_declarative_manifest.components.CustomFieldTransformation
          incremental_sync:
            type: DatetimeBasedCursor
            start_datetime:
              datetime: "{{ format_datetime(config['start_date'], '%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            end_datetime:
              datetime: "{{ now_utc().strftime('%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            datetime_format: "%s"
            cursor_granularity: PT1S
            step: P1M
            cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
              }}"
          schema_loader:
            type: InlineSchemaLoader
            schema:
              $schema: http://json-schema.org/draft-07/schema#
              name: Item
              type: object
              properties:
                id:
                  description: Unique identifier for the item
                  type:
                  - string
                  - 'null'
                name:
                  description: Name of the item
                  type:
                  - string
                  - 'null'
                description:
                  description: Description of the item
                  type:
                  - string
                  - 'null'
                status:
                  description: Status of the item
                  type:
                  - string
                  - 'null'
                resource_version:
                  description: Version of the resource
                  type:
                  - integer
                  - 'null'
                updated_at:
                  description: Date and time when the item was last updated
                  type:
                  - integer
                  - 'null'
                item_family_id:
                  description: ID of the item's family
                  type:
                  - string
                  - 'null'
                type:
                  description: Type of the item
                  type:
                  - string
                  - 'null'
                is_shippable:
                  description: Flag indicating if the item is shippable
                  type:
                  - boolean
                  - 'null'
                is_giftable:
                  description: Flag indicating if the item is giftable
                  type:
                  - boolean
                  - 'null'
                redirect_url:
                  description: URL to redirect for the item
                  type:
                  - string
                  - 'null'
                enabled_for_checkout:
                  description: Flag indicating if the item is enabled for checkout
                  type:
                  - boolean
                  - 'null'
                enabled_in_portal:
                  description: Flag indicating if the item is enabled in the portal
                  type:
                  - boolean
                  - 'null'
                included_in_mrr:
                  description: Flag indicating if the item is included in Monthly
                    Recurring Revenue
                  type:
                  - boolean
                  - 'null'
                item_applicability:
                  description: Applicability of the item
                  type:
                  - string
                  - 'null'
                gift_claim_redirect_url:
                  description: URL to redirect for gift claim
                  type:
                  - string
                  - 'null'
                unit:
                  description: Unit associated with the item
                  type:
                  - string
                  - 'null'
                metered:
                  description: Flag indicating if the item is metered
                  type:
                  - boolean
                  - 'null'
                usage_calculation:
                  description: Calculation method used for item usage
                  type:
                  - string
                  - 'null'
                archived_at:
                  description: Date and time when the item was archived
                  type:
                  - integer
                  - 'null'
                metadata:
                  description: Additional data associated with the item
                  type:
                  - object
                  - 'null'
                  properties: {}
                external_name:
                  description: Name of the item in an external system
                  type:
                  - string
                  - 'null'
                applicable_items:
                  description: Items associated with the item
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: Unique identifier for the item
                        type:
                        - string
                        - 'null'
                channel:
                  description: Channel the item belongs to
                  type:
                  - string
                  - 'null'
                object:
                  description: Type of object
                  type:
                  - string
                  - 'null'
                custom_fields: _definitions.json#/definitions/custom_fields
          type: DeclarativeStream
          name: "item"
          primary_key: "id"
        parent_key: "id"
        partition_field: "item_id"
        incremental_dependency: true
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  $comment: "As of 2/8/24 this stream should be full refresh only as there is an issue
    with state being appended rather than replaced, causing duplicates. See GH Issue:
    https://github.com/airbytehq/airbyte/issues/33854"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Attached Items
      type: object
      properties:
        id:
          description: Unique identifier for the attached item.
          type:
          - string
          - 'null'
        parent_item_id:
          description: Identifier of the parent item to which this attached item is
            attached.
          type:
          - string
          - 'null'
        item_id:
          description: Identifier of the item to which this attached item belongs.
          type:
          - string
          - 'null'
        type:
          description: Type of the attached item.
          type:
          - string
          - 'null'
        status:
          description: Current status of the attached item.
          type:
          - string
          - 'null'
        quantity:
          description: Quantity of the attached item included in the parent item.
          type:
          - integer
          - 'null'
        quantity_in_decimal:
          description: Quantity of the attached item in decimal format.
          type:
          - string
          - 'null'
        billing_cycles:
          description: Number of billing cycles associated with the attached item.
          type:
          - integer
          - 'null'
        charge_on_event:
          description: Indicates when the attached item should be charged.
          type:
          - string
          - 'null'
        charge_once:
          description: Flag to determine if the attached item should be charged only
            once.
          type:
          - boolean
          - 'null'
        created_at:
          description: Timestamp when the attached item was created.
          type:
          - integer
          - 'null'
        resource_version:
          description: Version of the attached item resource for tracking changes.
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp when the attached item was last updated.
          type:
          - integer
          - 'null'
        object:
          description: Type of object representing the attached item.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "attached_item"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/customers"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Customer
      type: object
      properties:
        id:
          description: Unique ID of the customer.
          type:
          - string
          - 'null'
        first_name:
          description: First name of the customer.
          type:
          - string
          - 'null'
        last_name:
          description: Last name of the customer.
          type:
          - string
          - 'null'
        email:
          description: Email address of the customer.
          type:
          - string
          - 'null'
        phone:
          description: Phone number of the customer.
          type:
          - string
          - 'null'
        company:
          description: Company or organization name.
          type:
          - string
          - 'null'
        vat_number:
          description: VAT number associated with the customer.
          type:
          - string
          - 'null'
        auto_collection:
          description: Configures the automatic collection settings for the customer.
          type:
          - string
          - 'null'
        offline_payment_method:
          description: Offline payment method used by the customer.
          type:
          - string
          - 'null'
        net_term_days:
          description: Number of days for net terms.
          type:
          - integer
          - 'null'
        vat_number_validated_time:
          description: Date and time when the VAT number was validated.
          type:
          - integer
          - 'null'
        vat_number_status:
          description: Status of the VAT number validation.
          type:
          - string
          - 'null'
        allow_direct_debit:
          description: Indicates if direct debit is allowed for the customer.
          type:
          - boolean
          - 'null'
        is_location_valid:
          description: Flag indicating if the customer location is valid.
          type:
          - boolean
          - 'null'
        created_at:
          description: Date and time when the customer was created.
          type:
          - integer
          - 'null'
        created_from_ip:
          description: IP address from which the customer was created.
          type:
          - string
          - 'null'
        exemption_details:
          description: Details about any exemptions applicable to the customer's account.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties: {}
        taxability:
          description: Taxability status of the customer.
          type:
          - string
          - 'null'
        entity_code:
          description: Code for the customer entity.
          type:
          - string
          - 'null'
        exempt_number:
          description: Exemption number for tax purposes.
          type:
          - string
          - 'null'
        resource_version:
          description: Version of the customer's resource.
          type:
          - integer
          - 'null'
        updated_at:
          description: Date and time when the customer record was last updated.
          type:
          - integer
          - 'null'
        locale:
          description: Locale setting for the customer.
          type:
          - string
          - 'null'
        billing_date:
          description: Date for billing cycle.
          type:
          - integer
          - 'null'
        billing_date_mode:
          description: Mode for billing date calculation.
          type:
          - string
          - 'null'
        billing_day_of_week:
          description: Day of the week for billing cycle.
          type:
          - string
          - 'null'
        billing_day_of_week_mode:
          description: Mode for billing day of the week calculation.
          type:
          - string
          - 'null'
        billing_month:
          description: Month for billing cycle.
          type:
          - integer
          - 'null'
        pii_cleared:
          description: Flag indicating if PII (Personally Identifiable Information)
            is cleared.
          type:
          - string
          - 'null'
        auto_close_invoices:
          description: Flag to automatically close invoices for the customer.
          type:
          - boolean
          - 'null'
        fraud_flag:
          description: Flag indicating if fraud is associated with the customer.
          type:
          - string
          - 'null'
        primary_payment_source_id:
          description: ID of the primary payment source for the customer.
          type:
          - string
          - 'null'
        backup_payment_source_id:
          description: ID of the backup payment source for the customer.
          type:
          - string
          - 'null'
        invoice_notes:
          description: Notes added to the customer's invoices.
          type:
          - string
          - 'null'
        preferred_currency_code:
          description: Preferred currency code for transactions.
          type:
          - string
          - 'null'
        promotional_credits:
          description: Total amount of promotional credits used.
          type:
          - integer
          - 'null'
        unbilled_charges:
          description: Total amount of unbilled charges.
          type:
          - integer
          - 'null'
        refundable_credits:
          description: Total amount of refundable credits.
          type:
          - integer
          - 'null'
        excess_payments:
          description: Total amount of excess payments by the customer.
          type:
          - integer
          - 'null'
        deleted:
          description: Flag indicating if the customer is deleted.
          type:
          - boolean
          - 'null'
        registered_for_gst:
          description: Flag indicating if the customer is registered for GST.
          type:
          - boolean
          - 'null'
        consolidated_invoicing:
          description: Flag for consolidated invoicing setting.
          type:
          - boolean
          - 'null'
        customer_type:
          description: Type of customer (e.g., individual, business).
          type:
          - string
          - 'null'
        business_customer_without_vat_number:
          description: Flag indicating business customer without a VAT number.
          type:
          - boolean
          - 'null'
        client_profile_id:
          description: Client profile ID of the customer.
          type:
          - string
          - 'null'
        use_default_hierarchy_settings:
          description: Flag indicating if default hierarchy settings are used.
          type:
          - boolean
          - 'null'
        vat_number_prefix:
          description: Prefix for the VAT number.
          type:
          - string
          - 'null'
        business_entity_id:
          description: ID of the business entity.
          type:
          - string
          - 'null'
        channel:
          description: Channel through which the customer was acquired.
          type:
          - string
          - 'null'
        object:
          description: Object type for the customer.
          type:
          - string
          - 'null'
        mrr:
          description: Monthly recurring revenue generated from the customer.
          type:
          - integer
          - 'null'
        tax_providers_fields:
          description: Fields related to tax providers.
          type:
          - array
          - 'null'
        billing_address:
          description: Customer's billing address details.
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: First name in the billing address.
              type:
              - string
              - 'null'
            last_name:
              description: Last name in the billing address.
              type:
              - string
              - 'null'
            email:
              description: Email address for billing communication.
              type:
              - string
              - 'null'
            company:
              description: Company name in the billing address.
              type:
              - string
              - 'null'
            phone:
              description: Phone number for billing contact.
              type:
              - string
              - 'null'
            line1:
              description: Address line 1 in the billing address.
              type:
              - string
              - 'null'
            line2:
              description: Address line 2 in the billing address.
              type:
              - string
              - 'null'
            line3:
              description: Address line 3 in the billing address.
              type:
              - string
              - 'null'
            city:
              description: City in the billing address.
              type:
              - string
              - 'null'
            state_code:
              description: State code in the billing address.
              type:
              - string
              - 'null'
            state:
              description: State in the billing address.
              type:
              - string
              - 'null'
            country:
              description: Country in the billing address.
              type:
              - string
              - 'null'
            zip:
              description: Zip code in the billing address.
              type:
              - string
              - 'null'
            validation_status:
              description: Validation status of the billing address.
              type:
              - string
              - 'null'
            object:
              description: Object type for billing address.
              type:
              - string
              - 'null'
        referral_urls:
          description: List of referral URLs associated with the customer.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              external_customer_id:
                description: External customer ID linked to the referral URL.
                type:
                - string
                - 'null'
              referral_sharing_url:
                description: URL for sharing the referral.
                type:
                - string
                - 'null'
              created_at:
                description: Date and time when the referral URL was created.
                type:
                - integer
                - 'null'
              updated_at:
                description: Date and time when the referral URL was last updated.
                type:
                - integer
                - 'null'
              referral_campaign_id:
                description: Campaign ID for the referral.
                type:
                - string
                - 'null'
              referral_account_id:
                description: Account ID associated with the referral.
                type:
                - string
                - 'null'
              referral_external_campaign_id:
                description: External campaign ID linked to the referral.
                type:
                - string
                - 'null'
              referral_system:
                description: System used for the referral.
                type:
                - string
                - 'null'
        contacts:
          description: List of contact details associated with the customer.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the contact.
                type:
                - string
                - 'null'
              first_name:
                description: First name of the contact.
                type:
                - string
                - 'null'
              last_name:
                description: Last name of the contact.
                type:
                - string
                - 'null'
              email:
                description: Email address of the contact.
                type:
                - string
                - 'null'
              phone:
                description: Phone number of the contact.
                type:
                - string
                - 'null'
              label:
                description: Label for the contact.
                type:
                - string
                - 'null'
              enabled:
                description: Flag indicating contact is enabled.
                type:
                - boolean
                - 'null'
              send_account_email:
                description: Permission to send account emails to the contact.
                type:
                - boolean
                - 'null'
              send_billing_email:
                description: Permission to send billing emails to the contact.
                type:
                - boolean
                - 'null'
              object:
                description: Object type for contact.
                type:
                - string
                - 'null'
        payment_method:
          description: Customer's preferred payment method details.
          type:
          - object
          - 'null'
          properties:
            type:
              description: Type of payment method.
              type:
              - string
              - 'null'
            gateway:
              description: Payment gateway used for transactions.
              type:
              - string
              - 'null'
            gateway_account_id:
              description: ID of the gateway account.
              type:
              - string
              - 'null'
            status:
              description: Status of the payment method.
              type:
              - string
              - 'null'
            reference_id:
              description: Reference ID for the payment method.
              type:
              - string
              - 'null'
            object:
              description: Object type for payment method.
              type:
              - string
              - 'null'
        balances:
          description: Customer's balance information related to their account.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              promotional_credits:
                description: Amount of promotional credits.
                type:
                - integer
                - 'null'
              excess_payments:
                description: Amount of excess payments.
                type:
                - integer
                - 'null'
              refundable_credits:
                description: Amount of refundable credits.
                type:
                - integer
                - 'null'
              unbilled_charges:
                description: Amount of unbilled charges.
                type:
                - integer
                - 'null'
              currency_code:
                description: Currency code used for the transaction.
                type:
                - string
                - 'null'
              balance_currency_code:
                description: Currency code for the balance.
                type:
                - string
                - 'null'
              object:
                description: Object type for the balance.
                type:
                - string
                - 'null'
        relationship:
          description: Details about the relationship of the customer to other entities,
            if any.
          type:
          - object
          - 'null'
          properties:
            parent_id:
              description: ID of the parent in the relationship.
              type:
              - string
              - 'null'
            payment_owner_id:
              description: ID of the payment owner in the relationship.
              type:
              - string
              - 'null'
            invoice_owner_id:
              description: ID of the invoice owner in the relationship.
              type:
              - string
              - 'null'
        parent_account_access:
          description: Information regarding the access rights of the parent account,
            if applicable.
          type:
          - object
          - 'null'
          properties:
            portal_edit_child_subscriptions:
              description: Permission to edit child subscriptions for the parent account.
              type:
              - string
              - 'null'
            portal_download_child_invoices:
              description: Permission to download child invoices for the parent account.
              type:
              - string
              - 'null'
            send_subscription_emails:
              description: Permission to send subscription emails for the parent account.
              type:
              - boolean
              - 'null'
            send_invoice_emails:
              description: Permission to send invoice emails for the parent account.
              type:
              - boolean
              - 'null'
            send_payment_emails:
              description: Permission to send payment emails for the parent account.
              type:
              - boolean
              - 'null'
        child_account_access:
          description: Information regarding the access rights of child accounts linked
            to the customer's account.
          type:
          - object
          - 'null'
          properties:
            portal_edit_child_subscriptions:
              description: Permission to edit child subscriptions.
              type:
              - string
              - 'null'
            portal_download_child_invoices:
              description: Permission to download child invoices.
              type:
              - string
              - 'null'
            send_subscription_emails:
              description: Permission to send subscription emails.
              type:
              - boolean
              - 'null'
            send_invoice_emails:
              description: Permission to send invoice emails.
              type:
              - boolean
              - 'null'
            send_payment_emails:
              description: Permission to send payment emails.
              type:
              - boolean
              - 'null'
        card_status:
          description: Status of payment card associated with the customer.
          type:
          - string
          - 'null'
        meta_data:
          description: Additional metadata associated with the customer.
          type:
          - object
          - 'null'
          properties: {}
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "customer"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/coupons"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Coupon
      type: object
      properties:
        id:
          description: Unique identifier for the coupon.
          type:
          - string
          - 'null'
        name:
          description: Name of the coupon.
          type:
          - string
          - 'null'
        invoice_name:
          description: Name displayed on invoices when the coupon is used.
          type:
          - string
          - 'null'
        discount_type:
          description: Type of discount (e.g. fixed, percentage).
          type:
          - string
          - 'null'
        discount_percentage:
          description: Percentage discount applied by the coupon.
          type:
          - number
          - 'null'
        discount_amount:
          description: The fixed discount amount applied by the coupon.
          type:
          - integer
          - 'null'
        currency_code:
          description: The currency code for the coupon (e.g. USD, EUR).
          type:
          - string
          - 'null'
        duration_type:
          description: Type of duration (e.g. forever, one-time).
          type:
          - string
          - 'null'
        duration_month:
          description: Duration of the coupon in months.
          type:
          - integer
          - 'null'
        valid_till:
          description: Date until which the coupon is valid for use.
          type:
          - integer
          - 'null'
        max_redemptions:
          description: Maximum number of times the coupon can be redeemed.
          type:
          - integer
          - 'null'
        status:
          description: Current status of the coupon (e.g. active, inactive).
          type:
          - string
          - 'null'
        apply_discount_on:
          description: Determines where the discount is applied on (e.g. subtotal,
            total).
          type:
          - string
          - 'null'
        apply_on:
          description: Specify on what type of items the coupon applies (e.g. subscription,
            addon).
          type:
          - string
          - 'null'
        created_at:
          description: Timestamp of the coupon creation.
          type:
          - integer
          - 'null'
        archived_at:
          description: Timestamp when the coupon was archived.
          type:
          - integer
          - 'null'
        resource_version:
          description: Version of the resource.
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp when the coupon was last updated.
          type:
          - integer
          - 'null'
        period:
          description: Duration or frequency for which the coupon is valid.
          type:
          - integer
          - 'null'
        period_unit:
          description: Unit of the period (e.g. days, weeks).
          type:
          - string
          - 'null'
        redemptions:
          description: Number of times the coupon has been redeemed.
          type:
          - integer
          - 'null'
        invoice_notes:
          description: Additional notes displayed on invoices when the coupon is used.
          type:
          - string
          - 'null'
        object:
          description: Type of object (usually 'coupon').
          type:
          - string
          - 'null'
        item_constraints:
          description: Constraints related to the items
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_type:
                description: The type of item to which the constraint is applied.
                type:
                - string
                - 'null'
              constraint:
                description: Specific constraints applied to items.
                type:
                - string
                - 'null'
              item_price_ids:
                description: IDs of the items with pricing constraints
                type:
                - array
                - 'null'
                items: {}
        item_constraint_criteria:
          description: Criteria for item constraints
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_type:
                description: The type of item the coupon should be applied to.
                type:
                - string
                - 'null'
              currencies:
                description: Supported currencies for the item
                type:
                - array
                - 'null'
                items: {}
              item_family_ids:
                description: Allowed item family IDs
                type:
                - array
                - 'null'
                items: {}
              item_price_periods:
                description: Valid price periods for the item
                type:
                - array
                - 'null'
                items: {}
        coupon_constraints:
          description: Represents the constraints associated with the coupon
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              entity_type:
                description: The type of entity the coupon is applicable to (e.g.
                  customer, subscription).
                type:
                - string
                - 'null'
              type:
                description: Type of constraint applied (e.g. specific item, any item).
                type:
                - string
                - 'null'
              vlaue:
                description: The specific value associated with the constraint.
                type:
                - string
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "coupon"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - http_codes:
            - 404
            action: IGNORE
            error_message: "Entity unavailable. Customer may have been deleted."
            type: HttpResponseFilter
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      path: "/customers/{{ stream_slice.id }}/contacts"
    partition_router:
      type: SubstreamPartitionRouter
      parent_stream_configs:
      - type: ParentStreamConfig
        stream:
          retriever:
            type: SimpleRetriever
            record_selector:
              type: RecordSelector
              extractor:
                type: DpathExtractor
                field_path:
                - "list"
                - "*"
                - "{{ parameters.get('name') }}"
            paginator:
              type: DefaultPaginator
              pagination_strategy:
                type: "CursorPagination"
                cursor_value: "{{ response.get('next_offset')|tojson() }}"
                stop_condition: "{{ not response.next_offset }}"
                page_size_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: limit
                  page_size: 100
              page_token_option:
                type: RequestOption
                inject_into: request_parameter
                field_name: offset
            requester:
              type: HttpRequester
              url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
              http_method: "GET"
              authenticator:
                type: BasicHttpAuthenticator
                username: "{{ config['site_api_key'] }}"
              error_handler:
                type: CompositeErrorHandler
                error_handlers:
                - type: DefaultErrorHandler
                  response_filters:
                  - error_message_contains: "This API operation is not enabled for
                      this site"
                    action: IGNORE
                    error_message: "Stream is available only for Product Catalog 1.0"
                    type: HttpResponseFilter
                - type: DefaultErrorHandler
                  backoff_strategies:
                  - type: WaitTimeFromHeader
                    header: "Retry-After"
              request_parameters:
                sort_by[asc]: updated_at
                include_deleted: "true"
                updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
              path: "/customers"
          transformations:
          - type: CustomTransformation
            class_name: source_declarative_manifest.components.CustomFieldTransformation
          incremental_sync:
            type: DatetimeBasedCursor
            start_datetime:
              datetime: "{{ format_datetime(config['start_date'], '%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            end_datetime:
              datetime: "{{ now_utc().strftime('%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            datetime_format: "%s"
            cursor_granularity: PT1S
            step: P1M
            cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
              }}"
          schema_loader:
            type: InlineSchemaLoader
            schema:
              $schema: http://json-schema.org/draft-07/schema#
              name: Customer
              type: object
              properties:
                id:
                  description: Unique ID of the customer.
                  type:
                  - string
                  - 'null'
                first_name:
                  description: First name of the customer.
                  type:
                  - string
                  - 'null'
                last_name:
                  description: Last name of the customer.
                  type:
                  - string
                  - 'null'
                email:
                  description: Email address of the customer.
                  type:
                  - string
                  - 'null'
                phone:
                  description: Phone number of the customer.
                  type:
                  - string
                  - 'null'
                company:
                  description: Company or organization name.
                  type:
                  - string
                  - 'null'
                vat_number:
                  description: VAT number associated with the customer.
                  type:
                  - string
                  - 'null'
                auto_collection:
                  description: Configures the automatic collection settings for the
                    customer.
                  type:
                  - string
                  - 'null'
                offline_payment_method:
                  description: Offline payment method used by the customer.
                  type:
                  - string
                  - 'null'
                net_term_days:
                  description: Number of days for net terms.
                  type:
                  - integer
                  - 'null'
                vat_number_validated_time:
                  description: Date and time when the VAT number was validated.
                  type:
                  - integer
                  - 'null'
                vat_number_status:
                  description: Status of the VAT number validation.
                  type:
                  - string
                  - 'null'
                allow_direct_debit:
                  description: Indicates if direct debit is allowed for the customer.
                  type:
                  - boolean
                  - 'null'
                is_location_valid:
                  description: Flag indicating if the customer location is valid.
                  type:
                  - boolean
                  - 'null'
                created_at:
                  description: Date and time when the customer was created.
                  type:
                  - integer
                  - 'null'
                created_from_ip:
                  description: IP address from which the customer was created.
                  type:
                  - string
                  - 'null'
                exemption_details:
                  description: Details about any exemptions applicable to the customer's
                    account.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties: {}
                taxability:
                  description: Taxability status of the customer.
                  type:
                  - string
                  - 'null'
                entity_code:
                  description: Code for the customer entity.
                  type:
                  - string
                  - 'null'
                exempt_number:
                  description: Exemption number for tax purposes.
                  type:
                  - string
                  - 'null'
                resource_version:
                  description: Version of the customer's resource.
                  type:
                  - integer
                  - 'null'
                updated_at:
                  description: Date and time when the customer record was last updated.
                  type:
                  - integer
                  - 'null'
                locale:
                  description: Locale setting for the customer.
                  type:
                  - string
                  - 'null'
                billing_date:
                  description: Date for billing cycle.
                  type:
                  - integer
                  - 'null'
                billing_date_mode:
                  description: Mode for billing date calculation.
                  type:
                  - string
                  - 'null'
                billing_day_of_week:
                  description: Day of the week for billing cycle.
                  type:
                  - string
                  - 'null'
                billing_day_of_week_mode:
                  description: Mode for billing day of the week calculation.
                  type:
                  - string
                  - 'null'
                billing_month:
                  description: Month for billing cycle.
                  type:
                  - integer
                  - 'null'
                pii_cleared:
                  description: Flag indicating if PII (Personally Identifiable Information)
                    is cleared.
                  type:
                  - string
                  - 'null'
                auto_close_invoices:
                  description: Flag to automatically close invoices for the customer.
                  type:
                  - boolean
                  - 'null'
                fraud_flag:
                  description: Flag indicating if fraud is associated with the customer.
                  type:
                  - string
                  - 'null'
                primary_payment_source_id:
                  description: ID of the primary payment source for the customer.
                  type:
                  - string
                  - 'null'
                backup_payment_source_id:
                  description: ID of the backup payment source for the customer.
                  type:
                  - string
                  - 'null'
                invoice_notes:
                  description: Notes added to the customer's invoices.
                  type:
                  - string
                  - 'null'
                preferred_currency_code:
                  description: Preferred currency code for transactions.
                  type:
                  - string
                  - 'null'
                promotional_credits:
                  description: Total amount of promotional credits used.
                  type:
                  - integer
                  - 'null'
                unbilled_charges:
                  description: Total amount of unbilled charges.
                  type:
                  - integer
                  - 'null'
                refundable_credits:
                  description: Total amount of refundable credits.
                  type:
                  - integer
                  - 'null'
                excess_payments:
                  description: Total amount of excess payments by the customer.
                  type:
                  - integer
                  - 'null'
                deleted:
                  description: Flag indicating if the customer is deleted.
                  type:
                  - boolean
                  - 'null'
                registered_for_gst:
                  description: Flag indicating if the customer is registered for GST.
                  type:
                  - boolean
                  - 'null'
                consolidated_invoicing:
                  description: Flag for consolidated invoicing setting.
                  type:
                  - boolean
                  - 'null'
                customer_type:
                  description: Type of customer (e.g., individual, business).
                  type:
                  - string
                  - 'null'
                business_customer_without_vat_number:
                  description: Flag indicating business customer without a VAT number.
                  type:
                  - boolean
                  - 'null'
                client_profile_id:
                  description: Client profile ID of the customer.
                  type:
                  - string
                  - 'null'
                use_default_hierarchy_settings:
                  description: Flag indicating if default hierarchy settings are used.
                  type:
                  - boolean
                  - 'null'
                vat_number_prefix:
                  description: Prefix for the VAT number.
                  type:
                  - string
                  - 'null'
                business_entity_id:
                  description: ID of the business entity.
                  type:
                  - string
                  - 'null'
                channel:
                  description: Channel through which the customer was acquired.
                  type:
                  - string
                  - 'null'
                object:
                  description: Object type for the customer.
                  type:
                  - string
                  - 'null'
                mrr:
                  description: Monthly recurring revenue generated from the customer.
                  type:
                  - integer
                  - 'null'
                tax_providers_fields:
                  description: Fields related to tax providers.
                  type:
                  - array
                  - 'null'
                billing_address:
                  description: Customer's billing address details.
                  type:
                  - object
                  - 'null'
                  properties:
                    first_name:
                      description: First name in the billing address.
                      type:
                      - string
                      - 'null'
                    last_name:
                      description: Last name in the billing address.
                      type:
                      - string
                      - 'null'
                    email:
                      description: Email address for billing communication.
                      type:
                      - string
                      - 'null'
                    company:
                      description: Company name in the billing address.
                      type:
                      - string
                      - 'null'
                    phone:
                      description: Phone number for billing contact.
                      type:
                      - string
                      - 'null'
                    line1:
                      description: Address line 1 in the billing address.
                      type:
                      - string
                      - 'null'
                    line2:
                      description: Address line 2 in the billing address.
                      type:
                      - string
                      - 'null'
                    line3:
                      description: Address line 3 in the billing address.
                      type:
                      - string
                      - 'null'
                    city:
                      description: City in the billing address.
                      type:
                      - string
                      - 'null'
                    state_code:
                      description: State code in the billing address.
                      type:
                      - string
                      - 'null'
                    state:
                      description: State in the billing address.
                      type:
                      - string
                      - 'null'
                    country:
                      description: Country in the billing address.
                      type:
                      - string
                      - 'null'
                    zip:
                      description: Zip code in the billing address.
                      type:
                      - string
                      - 'null'
                    validation_status:
                      description: Validation status of the billing address.
                      type:
                      - string
                      - 'null'
                    object:
                      description: Object type for billing address.
                      type:
                      - string
                      - 'null'
                referral_urls:
                  description: List of referral URLs associated with the customer.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      external_customer_id:
                        description: External customer ID linked to the referral URL.
                        type:
                        - string
                        - 'null'
                      referral_sharing_url:
                        description: URL for sharing the referral.
                        type:
                        - string
                        - 'null'
                      created_at:
                        description: Date and time when the referral URL was created.
                        type:
                        - integer
                        - 'null'
                      updated_at:
                        description: Date and time when the referral URL was last
                          updated.
                        type:
                        - integer
                        - 'null'
                      referral_campaign_id:
                        description: Campaign ID for the referral.
                        type:
                        - string
                        - 'null'
                      referral_account_id:
                        description: Account ID associated with the referral.
                        type:
                        - string
                        - 'null'
                      referral_external_campaign_id:
                        description: External campaign ID linked to the referral.
                        type:
                        - string
                        - 'null'
                      referral_system:
                        description: System used for the referral.
                        type:
                        - string
                        - 'null'
                contacts:
                  description: List of contact details associated with the customer.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: ID of the contact.
                        type:
                        - string
                        - 'null'
                      first_name:
                        description: First name of the contact.
                        type:
                        - string
                        - 'null'
                      last_name:
                        description: Last name of the contact.
                        type:
                        - string
                        - 'null'
                      email:
                        description: Email address of the contact.
                        type:
                        - string
                        - 'null'
                      phone:
                        description: Phone number of the contact.
                        type:
                        - string
                        - 'null'
                      label:
                        description: Label for the contact.
                        type:
                        - string
                        - 'null'
                      enabled:
                        description: Flag indicating contact is enabled.
                        type:
                        - boolean
                        - 'null'
                      send_account_email:
                        description: Permission to send account emails to the contact.
                        type:
                        - boolean
                        - 'null'
                      send_billing_email:
                        description: Permission to send billing emails to the contact.
                        type:
                        - boolean
                        - 'null'
                      object:
                        description: Object type for contact.
                        type:
                        - string
                        - 'null'
                payment_method:
                  description: Customer's preferred payment method details.
                  type:
                  - object
                  - 'null'
                  properties:
                    type:
                      description: Type of payment method.
                      type:
                      - string
                      - 'null'
                    gateway:
                      description: Payment gateway used for transactions.
                      type:
                      - string
                      - 'null'
                    gateway_account_id:
                      description: ID of the gateway account.
                      type:
                      - string
                      - 'null'
                    status:
                      description: Status of the payment method.
                      type:
                      - string
                      - 'null'
                    reference_id:
                      description: Reference ID for the payment method.
                      type:
                      - string
                      - 'null'
                    object:
                      description: Object type for payment method.
                      type:
                      - string
                      - 'null'
                balances:
                  description: Customer's balance information related to their account.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      promotional_credits:
                        description: Amount of promotional credits.
                        type:
                        - integer
                        - 'null'
                      excess_payments:
                        description: Amount of excess payments.
                        type:
                        - integer
                        - 'null'
                      refundable_credits:
                        description: Amount of refundable credits.
                        type:
                        - integer
                        - 'null'
                      unbilled_charges:
                        description: Amount of unbilled charges.
                        type:
                        - integer
                        - 'null'
                      currency_code:
                        description: Currency code used for the transaction.
                        type:
                        - string
                        - 'null'
                      balance_currency_code:
                        description: Currency code for the balance.
                        type:
                        - string
                        - 'null'
                      object:
                        description: Object type for the balance.
                        type:
                        - string
                        - 'null'
                relationship:
                  description: Details about the relationship of the customer to other
                    entities, if any.
                  type:
                  - object
                  - 'null'
                  properties:
                    parent_id:
                      description: ID of the parent in the relationship.
                      type:
                      - string
                      - 'null'
                    payment_owner_id:
                      description: ID of the payment owner in the relationship.
                      type:
                      - string
                      - 'null'
                    invoice_owner_id:
                      description: ID of the invoice owner in the relationship.
                      type:
                      - string
                      - 'null'
                parent_account_access:
                  description: Information regarding the access rights of the parent
                    account, if applicable.
                  type:
                  - object
                  - 'null'
                  properties:
                    portal_edit_child_subscriptions:
                      description: Permission to edit child subscriptions for the
                        parent account.
                      type:
                      - string
                      - 'null'
                    portal_download_child_invoices:
                      description: Permission to download child invoices for the parent
                        account.
                      type:
                      - string
                      - 'null'
                    send_subscription_emails:
                      description: Permission to send subscription emails for the
                        parent account.
                      type:
                      - boolean
                      - 'null'
                    send_invoice_emails:
                      description: Permission to send invoice emails for the parent
                        account.
                      type:
                      - boolean
                      - 'null'
                    send_payment_emails:
                      description: Permission to send payment emails for the parent
                        account.
                      type:
                      - boolean
                      - 'null'
                child_account_access:
                  description: Information regarding the access rights of child accounts
                    linked to the customer's account.
                  type:
                  - object
                  - 'null'
                  properties:
                    portal_edit_child_subscriptions:
                      description: Permission to edit child subscriptions.
                      type:
                      - string
                      - 'null'
                    portal_download_child_invoices:
                      description: Permission to download child invoices.
                      type:
                      - string
                      - 'null'
                    send_subscription_emails:
                      description: Permission to send subscription emails.
                      type:
                      - boolean
                      - 'null'
                    send_invoice_emails:
                      description: Permission to send invoice emails.
                      type:
                      - boolean
                      - 'null'
                    send_payment_emails:
                      description: Permission to send payment emails.
                      type:
                      - boolean
                      - 'null'
                card_status:
                  description: Status of payment card associated with the customer.
                  type:
                  - string
                  - 'null'
                meta_data:
                  description: Additional metadata associated with the customer.
                  type:
                  - object
                  - 'null'
                  properties: {}
                custom_fields: _definitions.json#/definitions/custom_fields
          type: DeclarativeStream
          name: "customer"
          primary_key: "id"
        parent_key: id
        partition_field: id
        incremental_dependency: true
  transformations:
  - type: AddFields
    fields:
    - path:
      - "customer_id"
      value: "{{ stream_slice.id }}"
      type: AddedFieldDefinition
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Customer
      type: object
      properties:
        email:
          description: Email address of the contact.
          type:
          - string
          - 'null'
        enabled:
          description: Indicates whether the contact is currently enabled or disabled.
          type:
          - boolean
          - 'null'
        first_name:
          description: First name of the contact.
          type:
          - string
          - 'null'
        id:
          description: Unique identifier of the contact.
          type:
          - string
          - 'null'
        customer_id:
          description: The unique identifier of the customer associated with the contact.
          type:
          - string
          - 'null'
        label:
          description: A label assigned to the contact for easy identification.
          type:
          - string
          - 'null'
        last_name:
          description: Last name of the contact.
          type:
          - string
          - 'null'
        object:
          description: Type of object, in this case, it will be 'contact'.
          type:
          - string
          - 'null'
        send_account_email:
          description: Indicates whether account-related emails are enabled for the
            contact.
          type:
          - boolean
          - 'null'
        send_billing_email:
          description: Indicates whether billing-related emails are enabled for the
            contact.
          type:
          - boolean
          - 'null'
        phone:
          description: Phone number of the contact.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "contact"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: date
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/credit_notes"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Credit Note
      type: object
      properties:
        id:
          description: The unique identifier for the credit note.
          type:
          - string
          - 'null'
        customer_id:
          description: The ID of the customer associated with the credit note.
          type:
          - string
          - 'null'
        subscription_id:
          description: The ID of the subscription associated with the credit note.
          type:
          - string
          - 'null'
        reference_invoice_id:
          description: The ID of the invoice this credit note references.
          type:
          - string
          - 'null'
        type:
          description: The type of credit note.
          type:
          - string
          - 'null'
        reason_code:
          description: The reason code for creating the credit note.
          type:
          - string
          - 'null'
        status:
          description: The status of the credit note.
          type:
          - string
          - 'null'
        vat_number:
          description: VAT number associated with the credit note.
          type:
          - string
          - 'null'
        date:
          description: The date when the credit note was created.
          type:
          - integer
          - 'null'
        price_type:
          description: The type of pricing used for the credit note.
          type:
          - string
          - 'null'
        currency_code:
          description: The currency code for the credit note.
          type:
          - string
          - 'null'
        total:
          description: The total amount of the credit note.
          type:
          - integer
          - 'null'
        amount_allocated:
          description: The amount of credits allocated.
          type:
          - integer
          - 'null'
        amount_refunded:
          description: The amount of credits refunded.
          type:
          - integer
          - 'null'
        amount_available:
          description: The amount of credits available.
          type:
          - integer
          - 'null'
        refunded_at:
          description: The date when the credit note was refunded.
          type:
          - integer
          - 'null'
        voided_at:
          description: The date when the credit note was voided.
          type:
          - integer
          - 'null'
        generated_at:
          description: The date when the credit note was generated.
          type:
          - integer
          - 'null'
        resource_version:
          description: The version of the credit note resource.
          type:
          - integer
          - 'null'
        updated_at:
          description: The date when the credit note was last updated.
          type:
          - integer
          - 'null'
        sub_total:
          description: The subtotal amount of the credit note.
          type:
          - integer
          - 'null'
        sub_total_in_local_currency:
          description: The subtotal amount in local currency.
          type:
          - integer
          - 'null'
        total_in_local_currency:
          description: The total amount in local currency.
          type:
          - integer
          - 'null'
        local_currency_code:
          description: The local currency code for the credit note.
          type:
          - string
          - 'null'
        round_off_amount:
          description: Amount rounded off for currency conversions.
          type:
          - integer
          - 'null'
        fractional_correction:
          description: Fractional correction for rounding off decimals.
          type:
          - integer
          - 'null'
          maximum: 50000
        deleted:
          description: Indicates if the credit note has been deleted.
          type:
          - boolean
          - 'null'
        create_reason_code:
          description: The reason code for creating the credit note.
          type:
          - string
          - 'null'
        vat_number_prefix:
          description: Prefix for the VAT number.
          type:
          - string
          - 'null'
        base_currency_code:
          description: The base currency code for the credit note.
          type:
          - string
          - 'null'
        business_entity_id:
          description: The ID of the business entity associated with the credit note.
          type:
          - string
          - 'null'
        channel:
          description: The channel through which the credit note was created.
          type:
          - string
          - 'null'
        exchange_rate:
          description: The exchange rate used for currency conversion.
          type:
          - number
          - 'null'
        is_digital:
          description: Indicates if the credit note is in digital format.
          type:
          - boolean
          - 'null'
        object:
          description: The object type of the credit note.
          type:
          - string
          - 'null'
        is_vat_moss_registered:
          description: Indicates if VAT MOSS registration applies.
          type:
          - boolean
          - 'null'
          $comment: Only available for accounts which have enabled taxes for EU Region
            for taxes.
        customer_notes:
          description: Notes provided by the customer for the credit note.
          type:
          - string
          - 'null'
        line_items:
          description: Details of line items in the credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The ID of the line item
                type:
                - string
                - 'null'
              subscription_id:
                description: The ID of the subscription associated with the line item
                type:
                - string
                - 'null'
              date_from:
                description: The start date for the line item
                type:
                - integer
                - 'null'
              date_to:
                description: The end date for the line item
                type:
                - integer
                - 'null'
              unit_amount:
                description: The amount per unit of the line item
                type:
                - integer
                - 'null'
              quantity:
                description: The quantity of the line item
                type:
                - integer
                - 'null'
              amount:
                description: The total amount for the line item
                type:
                - integer
                - 'null'
              pricing_model:
                description: The pricing model for the line item
                type:
                - string
                - 'null'
              is_taxed:
                description: Flag indicating if the line item is taxed
                type:
                - boolean
                - 'null'
              tax_amount:
                description: The amount of tax applied to the line item
                type:
                - integer
                - 'null'
              tax_rate:
                description: The tax rate applied to the line item
                type:
                - number
                - 'null'
              unit_amount_in_decimal:
                description: The amount per unit in decimal format
                type:
                - string
                - 'null'
              quantity_in_decimal:
                description: The quantity of the line item in decimal format
                type:
                - string
                - 'null'
              amount_in_decimal:
                description: The total amount in decimal format
                type:
                - string
                - 'null'
              discount_amount:
                description: The amount of discount applied to the line item
                type:
                - integer
                - 'null'
              item_level_discount_amount:
                description: The amount of item level discount applied
                type:
                - integer
                - 'null'
              description:
                description: The description of the line item
                type:
                - string
                - 'null'
              entity_description:
                description: The description of the entity associated with the line
                  item
                type:
                - string
                - 'null'
              entity_type:
                description: The type of entity associated with the line item
                type:
                - string
                - 'null'
              tax_exempt_reason:
                description: The reason for tax exemption
                type:
                - string
                - 'null'
              entity_id:
                description: The ID of the entity associated with the line item
                type:
                - string
                - 'null'
              customer_id:
                description: The ID of the customer associated with the line item
                type:
                - string
                - 'null'
              metered:
                description: Flag indicating if the line item is metered
                type:
                - boolean
                - 'null'
              reference_line_item_id:
                description: The reference ID of the line item
                type:
                - string
                - 'null'
              object:
                description: The object type
                type:
                - string
                - 'null'
        discounts:
          description: Details of discounts applied to the credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              amount:
                description: The amount of discount
                type:
                - integer
                - 'null'
              description:
                description: The description of the discount
                type:
                - string
                - 'null'
              entity_type:
                description: The type of entity to which the discount applies
                type:
                - string
                - 'null'
              entity_id:
                description: The ID of the entity to which the discount applies
                type:
                - string
                - 'null'
        line_item_discounts:
          description: Details of discounts applied at the line item level in the
            credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: The ID of the line item to which the discount applies
                type:
                - string
                - 'null'
              discount_type:
                description: The type of discount applied
                type:
                - string
                - 'null'
              discount_amount:
                description: The amount of the line item discount
                type:
                - integer
                - 'null'
              entity_id:
                description: The ID of the entity to which the line item discount
                  applies
                type:
                - string
                - 'null'
        line_item_tiers:
          description: Details of tiers applied to line items in the credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: The ID of the line item to which the tier applies
                type:
                - string
                - 'null'
              starting_unit:
                description: The starting unit of the tier
                type:
                - integer
                - 'null'
              ending_unit:
                description: The ending unit of the tier
                type:
                - integer
                - 'null'
              quantity_used:
                description: The quantity used under the tier
                type:
                - integer
                - 'null'
              unit_amount:
                description: The amount per unit of the tier
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: The starting unit in decimal format
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: The ending unit in decimal format
                type:
                - string
                - 'null'
              quantity_used_in_decimal:
                description: The quantity used in decimal format
                type:
                - string
                - 'null'
              unit_amount_in_decimal:
                description: The amount per unit in decimal format
                type:
                - string
                - 'null'
        taxes:
          description: List of taxes applied to the credit note
          type:
          - array
          - 'null'
          items:
            description: Details of each individual tax applied
            type:
            - object
            - 'null'
            properties:
              name:
                description: Name of the tax.
                type:
                - string
                - 'null'
              amount:
                description: The amount of taxes.
                type:
                - integer
                - 'null'
              description:
                description: Description of the tax.
                type:
                - string
                - 'null'
        line_item_taxes:
          description: Details of taxes applied at the line item level in the credit
            note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: The ID of the line item to which the tax applies
                type:
                - string
                - 'null'
              tax_name:
                description: The name of the tax
                type:
                - string
                - 'null'
              tax_rate:
                description: The tax rate applied
                type:
                - number
                - 'null'
                maximum: 100.0
              is_partial_tax_applied:
                description: Flag indicating if partial tax is applied
                type:
                - boolean
                - 'null'
              is_non_compliance_tax:
                description: Flag indicating if the tax is non-compliant
                type:
                - boolean
                - 'null'
              taxable_amount:
                description: The amount on which tax is calculated
                type:
                - integer
                - 'null'
              tax_amount:
                description: The amount of tax
                type:
                - integer
                - 'null'
              tax_juris_type:
                description: The type of jurisdiction for the tax
                type:
                - string
                - 'null'
              tax_juris_name:
                description: The jurisdiction name for the tax
                type:
                - string
                - 'null'
              tax_juris_code:
                description: The jurisdiction code for the tax
                type:
                - string
                - 'null'
              tax_amount_in_local_currency:
                description: The amount of tax in local currency
                type:
                - integer
                - 'null'
              local_currency-code:
                description: The currency code for local currency
                type:
                - string
                - 'null'
        linked_refunds:
          description: Details of linked refunds to the credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              txn_id:
                description: The ID of the refund transaction
                type:
                - string
                - 'null'
              applied_amount:
                description: The amount applied from the refund
                type:
                - integer
                - 'null'
              applied_at:
                description: The date and time the refund amount was applied
                type:
                - integer
                - 'null'
              txn_status:
                description: The status of the refund transaction
                type:
                - string
                - 'null'
              txn_date:
                description: The date of the refund transaction
                type:
                - integer
                - 'null'
              txn_amount:
                description: The total transaction amount for the refund
                type:
                - integer
                - 'null'
              refund_reason_code:
                description: The reason code for the refund
                type:
                - string
                - 'null'
        linked_tax_withheld_refunds:
          description: Details of linked tax withheld refunds to the credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The ID of the tax withheld refund
                type:
                - string
                - 'null'
              amount:
                description: The amount of tax withheld refund
                type:
                - integer
                - 'null'
              description:
                description: The description of the tax withheld refund
                type:
                - string
                - 'null'
              date:
                description: The date of the tax withheld refund
                type:
                - integer
                - 'null'
              reference_number:
                description: The reference number of the tax withheld refund
                type:
                - string
                - 'null'
        allocations:
          description: Details of allocations associated with the credit note
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              invoice_id:
                description: The ID of the invoice
                type:
                - string
                - 'null'
              allocated_amount:
                description: The amount allocated in the allocation
                type:
                - integer
                - 'null'
              allocated_at:
                description: The date and time the amount was allocated
                type:
                - integer
                - 'null'
              invoice_date:
                description: The date of the invoice
                type:
                - integer
                - 'null'
              invoice_status:
                description: The status of the invoice
                type:
                - string
                - 'null'
        shipping_address:
          description: Details of the shipping address associated with the credit
            note
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: The first name in the shipping address
              type:
              - string
              - 'null'
            last_name:
              description: The last name in the shipping address
              type:
              - string
              - 'null'
            email:
              description: The email address in the shipping address
              type:
              - string
              - 'null'
            company:
              description: The company name in the shipping address
              type:
              - string
              - 'null'
            phone:
              description: The phone number in the shipping address
              type:
              - string
              - 'null'
            line1:
              description: The first line of the address
              type:
              - string
              - 'null'
            line2:
              description: The second line of the address
              type:
              - string
              - 'null'
            line3:
              description: The third line of the address
              type:
              - string
              - 'null'
            city:
              description: The city in the shipping address
              type:
              - string
              - 'null'
            state_code:
              description: The state code in the shipping address
              type:
              - string
              - 'null'
            state:
              description: The state in the shipping address
              type:
              - string
              - 'null'
            country:
              description: The country in the shipping address
              type:
              - string
              - 'null'
            zip:
              description: The zip code in the shipping address
              type:
              - string
              - 'null'
            validation_status:
              description: The validation status of the address
              type:
              - string
              - 'null'
        billing_address:
          description: Details of the billing address associated with the credit note
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: The first name in the billing address
              type:
              - string
              - 'null'
            last_name:
              description: The last name in the billing address
              type:
              - string
              - 'null'
            email:
              description: The email address in the billing address
              type:
              - string
              - 'null'
            company:
              description: The company name in the billing address
              type:
              - string
              - 'null'
            phone:
              description: The phone number in the billing address
              type:
              - string
              - 'null'
            line1:
              description: The first line of the address
              type:
              - string
              - 'null'
            line2:
              description: The second line of the address
              type:
              - string
              - 'null'
            line3:
              description: The third line of the address
              type:
              - string
              - 'null'
            city:
              description: The city in the billing address
              type:
              - string
              - 'null'
            state_code:
              description: The state code in the billing address
              type:
              - string
              - 'null'
            state:
              description: The state in the billing address
              type:
              - string
              - 'null'
            country:
              description: The country in the billing address
              type:
              - string
              - 'null'
            zip:
              description: The zip code in the billing address
              type:
              - string
              - 'null'
            validation_status:
              description: The validation status of the address
              type:
              - string
              - 'null'
            object:
              description: The object type
              type:
              - string
              - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "credit_note"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: occurred_at
        occurred_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/events"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Event
      type: object
      properties:
        id:
          description: Unique identifier for the event data record.
          type:
          - string
          - 'null'
        occurred_at:
          description: The datetime when the event occurred.
          type:
          - integer
          - 'null'
        source:
          description: The source or origin of the event data.
          type:
          - string
          - 'null'
        user:
          description: Information about the user or entity associated with the event.
          type:
          - string
          - 'null'
        event_type:
          description: The type or category of the event.
          type:
          - string
          - 'null'
        api_version:
          description: The version of the Chargebee API being used to fetch the event
            data.
          type:
          - string
          - 'null'
        webhook_status:
          description: The status of the webhook execution for the event.
          type:
          - string
          - 'null'
        content:
          description: The specific content or information associated with the event.
          type:
          - object
          - 'null'
        object:
          description: The object or entity that the event is triggered for.
          type:
          - string
          - 'null'
        webhooks:
          description: List of webhooks associated with the event.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: Unique identifier for the webhook.
                type:
                - string
                - 'null'
              webhook_status:
                description: The status of the individual webhook related to the event.
                type:
                - string
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "event"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
      record_filter:
        condition: "{{ record['updated_at'] >= ( stream_state.get('prior_state', {}).get('updated_at',
          0) if stream_state else stream_slice.get('prior_state', {}).get('updated_at',
          0) ) }}"
        type: RecordFilter
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      path: "/gifts"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: CustomIncrementalSync
    class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
    cursor_field: "updated_at"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Gift
      type: object
      properties:
        id:
          description: Unique ID of the gift.
          type:
          - string
          - 'null'
        status:
          description: Status of the gift.
          type:
          - string
          - 'null'
        scheduled_at:
          description: Timestamp indicating when the gift is scheduled.
          type:
          - integer
          - 'null'
        auto_claim:
          description: Indicates if the gift is set to be automatically claimed by
            the recipient.
          type:
          - boolean
          - 'null'
        no_expiry:
          description: Indicates if the gift has no expiry.
          type:
          - boolean
          - 'null'
        claim_expiry_date:
          description: The date when the gift claim expires.
          type:
          - integer
          - 'null'
        resource_version:
          description: Version of the resource related to the gift.
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp of when the gift data was last updated.
          type:
          - integer
          - 'null'
        gifter:
          description: Information about the person who gave the gift
          type:
          - object
          - 'null'
          properties:
            customer_id:
              description: The ID of the customer who sent the gift.
              type:
              - string
              - 'null'
            invoice_id:
              description: The ID of the invoice associated with the gift.
              type:
              - string
              - 'null'
            signature:
              description: Signature or identifier of the gift sender.
              type:
              - string
              - 'null'
            note:
              description: Any note attached to the gift from the sender.
              type:
              - string
              - 'null'
            object:
              description: Type of object representing the gift sender.
              type:
              - string
              - 'null'
        gift_receiver:
          description: Information about the receiver of the gift
          type:
          - object
          - 'null'
          properties:
            customer_id:
              description: The ID of the customer who receives the gift.
              type:
              - string
              - 'null'
            subscription_id:
              description: The ID of the subscription associated with the gift receiver.
              type:
              - string
              - 'null'
            first_name:
              description: First name of the gift recipient.
              type:
              - string
              - 'null'
            last_name:
              description: Last name of the gift recipient.
              type:
              - string
              - 'null'
            email:
              description: Email of the gift recipient.
              type:
              - string
              - 'null'
            object:
              description: Type of object representing the gift receiver.
              type:
              - string
              - 'null'
        gift_timelines:
          description: Timeline information related to the gift
          type:
          - array
          - 'null'
          items:
            description: Details of each event in the gift timeline
            type:
            - object
            - 'null'
            properties:
              status:
                description: Status of the timeline event.
                type:
                - string
                - 'null'
              occurred_at:
                description: Timestamp of when the timeline event occurred.
                type:
                - integer
                - 'null'
              object:
                description: Type of object representing the timeline item.
                type:
                - string
                - 'null'
        object:
          description: Type of object representing the gift.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "gift"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/orders"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Order
      type: object
      additionalProperties: true
      properties:
        id:
          description: Unique identifier for the order.
          type:
          - string
          - 'null'
        document_number:
          description: Unique document number associated with the order.
          type:
          - string
          - 'null'
        invoice_id:
          description: Identifier for the invoice associated with the order.
          type:
          - string
          - 'null'
        subscription_id:
          description: Identifier for the subscription associated with the order.
          type:
          - string
          - 'null'
        customer_id:
          description: Identifier for the customer placing the order.
          type:
          - string
          - 'null'
        status:
          description: Current status of the order.
          type:
          - string
          - 'null'
        cancellation_reason:
          description: Reason for order cancellation.
          type:
          - string
          - 'null'
        payment_status:
          description: Status of payment for the order.
          type:
          - string
          - 'null'
        order_type:
          description: Type of order such as purchase order or sales order.
          type:
          - string
          - 'null'
        price_type:
          description: Type of pricing used for the order.
          type:
          - string
          - 'null'
        reference_id:
          description: Reference identifier for the order.
          type:
          - string
          - 'null'
        fulfillment_status:
          description: Status of fulfillment for the order.
          type:
          - string
          - 'null'
        order_date:
          description: Date when the order was created.
          type:
          - integer
          - 'null'
        shipping_date:
          description: Date when the order is scheduled for shipping.
          type:
          - integer
          - 'null'
        note:
          description: Additional notes or comments for the order.
          type:
          - string
          - 'null'
        tracking_id:
          description: Tracking identifier for the order shipment.
          type:
          - string
          - 'null'
        tracking_url:
          description: URL for tracking the order shipment.
          type:
          - string
          - 'null'
        batch_id:
          description: Unique identifier for the batch the order belongs to.
          type:
          - string
          - 'null'
        created_by:
          description: User or system that created the order.
          type:
          - string
          - 'null'
        shipment_carrier:
          description: Carrier for shipping the order.
          type:
          - string
          - 'null'
        invoice_round_off_amount:
          description: Round-off amount applied to the invoice.
          type:
          - integer
          - 'null'
        tax:
          description: Total tax amount for the order.
          type:
          - integer
          - 'null'
        amount_paid:
          description: Amount paid for the order.
          type:
          - integer
          - 'null'
        amount_adjusted:
          description: Adjusted amount for the order.
          type:
          - integer
          - 'null'
        refundable_credits_issued:
          description: Credits already issued for refund for the whole order.
          type:
          - integer
          - 'null'
        refundable_credits:
          description: Credits that can be refunded for the whole order.
          type:
          - integer
          - 'null'
        rounding_adjustement:
          description: Adjustment made for rounding off the order amount.
          type:
          - integer
          - 'null'
        paid_on:
          description: Timestamp when the order was paid for.
          type:
          - integer
          - 'null'
        shipping_cut_off_date:
          description: Date indicating the shipping cut-off for the order.
          type:
          - integer
          - 'null'
        created_at:
          description: Timestamp when the order was created.
          type:
          - integer
          - 'null'
        status_update_at:
          description: Timestamp when the status of the order was last updated.
          type:
          - integer
          - 'null'
        delivered_at:
          description: Timestamp when the order was delivered.
          type:
          - integer
          - 'null'
        shipped_at:
          description: Timestamp when the order was shipped.
          type:
          - integer
          - 'null'
        resource_version:
          description: Version of the resource or order data.
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp when the order data was last updated.
          type:
          - integer
          - 'null'
        cancelled_at:
          description: Timestamp when the order was cancelled.
          type:
          - integer
          - 'null'
        resent_status:
          description: Status of the resent order.
          type:
          - string
          - 'null'
        is_resent:
          description: Flag indicating if the order has been resent.
          type:
          - boolean
          - 'null'
        original_order_id:
          description: Identifier for the original order if this is a modified order.
          type:
          - string
          - 'null'
        discount:
          description: Discount amount applied to the order.
          type:
          - integer
          - 'null'
        sub_total:
          description: Sub-total amount for the order before applying taxes or discounts.
          type:
          - integer
          - 'null'
        total:
          description: Total amount including taxes and discounts for the order.
          type:
          - integer
          - 'null'
        deleted:
          description: Flag indicating if the order has been deleted.
          type:
          - boolean
          - 'null'
        currency_code:
          description: Currency code used for the order.
          type:
          - string
          - 'null'
        is_gifted:
          description: Flag indicating if the order is a gift.
          type:
          - boolean
          - 'null'
        gift_note:
          description: Note attached to any gift in the order.
          type:
          - string
          - 'null'
        gift_id:
          description: Identifier for any gift associated with the order.
          type:
          - string
          - 'null'
        resend_reason:
          description: Reason for resending the order.
          type:
          - string
          - 'null'
        business_entity_id:
          description: Identifier for the business entity associated with the order.
          type:
          - string
          - 'null'
        base_currency_code:
          description: The base currency code used for the order.
          type:
          - string
          - 'null'
        exchange_rate:
          description: Rate used for currency exchange in the order.
          type:
          - number
          - 'null'
        object:
          description: Type of object representing an order in the system.
          type:
          - string
          - 'null'
        order_line_items:
          description: List of line items in the order
          type:
          - array
          - 'null'
          items:
            description: Details of a particular line item
            type:
            - object
            - 'null'
            properties:
              id:
                description: Unique identifier for the line item.
                type:
                - string
                - 'null'
              invoice_id:
                description: Identifier for the invoice associated with the line item.
                type:
                - string
                - 'null'
              invoice_line_item_id:
                description: Identifier for the invoice line item associated with
                  the line item.
                type:
                - string
                - 'null'
              unit_price:
                description: Unit price of the line item.
                type:
                - integer
                - 'null'
              description:
                description: Description of the line item.
                type:
                - string
                - 'null'
              amount:
                description: Total amount for the line item.
                type:
                - integer
                - 'null'
              fulfillment_quantity:
                description: Quantity fulfilled for the line item.
                type:
                - integer
                - 'null'
              fulfillment_amount:
                description: Amount fulfilled for the line item.
                type:
                - integer
                - 'null'
              tax_amount:
                description: Tax amount applied to the line item.
                type:
                - integer
                - 'null'
              amount_paid:
                description: Amount paid for the line item.
                type:
                - integer
                - 'null'
              amount_adjusted:
                description: Adjusted amount for the line item.
                type:
                - integer
                - 'null'
              refundable_credits_issued:
                description: Credits already issued for refund for the line item.
                type:
                - integer
                - 'null'
              refundable_credits:
                description: Credits that can be refunded for the line item.
                type:
                - integer
                - 'null'
              is_shippable:
                description: Flag indicating if the line item is shippable.
                type:
                - boolean
                - 'null'
              sku:
                description: Stock Keeping Unit (SKU) associated with the line item.
                type:
                - string
                - 'null'
              status:
                description: Status of the line item.
                type:
                - string
                - 'null'
              entity_type:
                description: Type of entity associated with the line item.
                type:
                - string
                - 'null'
              item_level_discount_amount:
                description: Discount amount applied at the item level.
                type:
                - integer
                - 'null'
              discount_amount:
                description: Discount amount applied to the line item.
                type:
                - integer
                - 'null'
              entity_id:
                description: Identifier for the entity associated with the line item.
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the line item.
                type:
                - string
                - 'null'
        shipping_address:
          description: The shipping address for the order
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: First name in the shipping address.
              type:
              - string
              - 'null'
            last_name:
              description: Last name in the shipping address.
              type:
              - string
              - 'null'
            email:
              description: Email associated with the shipping address.
              type:
              - string
              - 'null'
            company:
              description: Company name in the shipping address.
              type:
              - string
              - 'null'
            phone:
              description: Phone number associated with the shipping address.
              type:
              - string
              - 'null'
            line1:
              description: First address line in the shipping address.
              type:
              - string
              - 'null'
            line2:
              description: Second address line in the shipping address.
              type:
              - string
              - 'null'
            line3:
              description: Third address line in the shipping address.
              type:
              - string
              - 'null'
            city:
              description: City in the shipping address.
              type:
              - string
              - 'null'
            state_code:
              description: State code of the shipping address.
              type:
              - string
              - 'null'
            state:
              description: State in the shipping address.
              type:
              - string
              - 'null'
            country:
              description: Country in the shipping address.
              type:
              - string
              - 'null'
            zip:
              description: Zip or postal code in the shipping address.
              type:
              - string
              - 'null'
            validation_status:
              description: Validation status of the shipping address.
              type:
              - string
              - 'null'
            object:
              description: Type of object representing the shipping address.
              type:
              - string
              - 'null'
        billing_address:
          description: The billing address associated with the order
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: First name in the billing address.
              type:
              - string
              - 'null'
            last_name:
              description: Last name in the billing address.
              type:
              - string
              - 'null'
            email:
              description: Email associated with the billing address.
              type:
              - string
              - 'null'
            company:
              description: Company name in the billing address.
              type:
              - string
              - 'null'
            phone:
              description: Phone number associated with the billing address.
              type:
              - string
              - 'null'
            line1:
              description: First address line in the billing address.
              type:
              - string
              - 'null'
            line2:
              description: Second address line in the billing address.
              type:
              - string
              - 'null'
            line3:
              description: Third address line in the billing address.
              type:
              - string
              - 'null'
            city:
              description: City in the billing address.
              type:
              - string
              - 'null'
            state_code:
              description: State code of the billing address.
              type:
              - string
              - 'null'
            state:
              description: State in the billing address.
              type:
              - string
              - 'null'
            country:
              description: Country in the billing address.
              type:
              - string
              - 'null'
            zip:
              description: Zip or postal code in the billing address.
              type:
              - string
              - 'null'
            validation_status:
              description: Validation status of the billing address.
              type:
              - string
              - 'null'
            object:
              description: Type of object representing the billing address.
              type:
              - string
              - 'null'
        line_item_taxes:
          description: Taxes applied to individual line items
          type:
          - array
          - 'null'
          items:
            description: Details of a particular line item tax
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: Identifier for the line item the tax is applied to.
                type:
                - string
                - 'null'
              tax_name:
                description: Name of the tax applied.
                type:
                - string
                - 'null'
              tax_rate:
                description: Rate of tax applied.
                type:
                - number
                - 'null'
              is_partial_tax_applied:
                description: Flag indicating if partial tax has been applied.
                type:
                - boolean
                - 'null'
              is_non_compliance_tax:
                description: Flag indicating if the tax is non-compliant.
                type:
                - boolean
                - 'null'
              taxable_amount:
                description: Amount on which tax is calculated.
                type:
                - integer
                - 'null'
              tax_amount:
                description: Total tax amount applied.
                type:
                - integer
                - 'null'
              tax_juris_type:
                description: Type of tax jurisdiction.
                type:
                - string
                - 'null'
              tax_juris_name:
                description: Name of the tax jurisdiction.
                type:
                - string
                - 'null'
              tax_juris_code:
                description: Code for the tax jurisdiction.
                type:
                - string
                - 'null'
              tax_amount_in_local_currency:
                description: Tax amount converted to the local currency.
                type:
                - integer
                - 'null'
              local_currency-code:
                description: Currency code used for the local tax amount.
                type:
                - string
                - 'null'
        line_item_discounts:
          description: Discounts applied to individual line items
          type:
          - array
          - 'null'
          items:
            description: Details of a particular line item discount
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: Identifier for the line item the discount is applied
                  to.
                type:
                - string
                - 'null'
              discount_type:
                description: Type of discount applied.
                type:
                - string
                - 'null'
              coupon_id:
                description: Identifier for the coupon applied for the discount.
                type:
                - string
                - 'null'
              discount_amount:
                description: Amount of the discount applied.
                type:
                - integer
                - 'null'
              entity_id:
                description: Identifier for the entity the discount is associated
                  with.
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the line item discount.
                type:
                - string
                - 'null'
        linked_credit_notes:
          description: Credit notes linked to the order
          type:
          - array
          - 'null'
          items:
            description: Details of a linked credit note
            type:
            - object
            - 'null'
            properties:
              amount:
                description: Amount associated with the credit note.
                type:
                - integer
                - 'null'
              type:
                description: Type of credit note.
                type:
                - string
                - 'null'
              id:
                description: Unique identifier for the credit note.
                type:
                - string
                - 'null'
              status:
                description: Status of the credit note.
                type:
                - string
                - 'null'
              amount_adjusted:
                description: Adjusted amount in the credit note.
                type:
                - integer
                - 'null'
              amount_refunded:
                description: Amount refunded for the credit note.
                type:
                - integer
                - 'null'
              object:
                description: Type of object representing the credit note.
                type:
                - string
                - 'null'
        resent_orders:
          description: Orders that were resent to the customer
          type:
          - array
          - 'null'
          items:
            description: Details of a resent order
            type:
            - object
            - 'null'
            properties:
              order_id:
                description: Identifier for the resent order.
                type:
                - string
                - 'null'
              reason:
                description: Reason for resenting the order.
                type:
                - string
                - 'null'
              amount:
                description: Amount for the resent order.
                type:
                - integer
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "order"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/hosted_pages"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Hosted Page
      type: object
      properties:
        id:
          description: Unique identifier for the hosted page.
          type:
          - string
          - 'null'
        type:
          description: Type of hosted page (e.g., checkout, subscription).
          type:
          - string
          - 'null'
        url:
          description: URL where the hosted page can be accessed.
          type:
          - string
          - 'null'
        state:
          description: Current state of the hosted page (e.g., active, expired).
          type:
          - string
          - 'null'
        pass_thru_content:
          description: Content that is passed through to the hosted page.
          type:
          - string
          - 'null'
        embed:
          description: Details about embedding the hosted page.
          type:
          - boolean
          - 'null'
        created_at:
          description: Timestamp indicating when the hosted page was created.
          type:
          - integer
          - 'null'
        expires_at:
          description: Timestamp specifying the expiry date of the hosted page.
          type:
          - integer
          - 'null'
        content:
          description: Content or details displayed on the hosted page.
          type:
          - object
          - 'null'
        updated_at:
          description: Timestamp indicating the last update time of the hosted page.
          type:
          - integer
          - 'null'
        resource_version:
          description: Version of the hosted page resource.
          type:
          - integer
          - 'null'
        checkout_info:
          description: Information related to the checkout process for the hosted
            page.
          type:
          - object
          - 'null'
        business_entity_id:
          description: The ID of the business entity associated with the hosted page.
          type:
          - string
          - 'null'
        object:
          description: Indicates the type of object, in this case, it would be 'hosted_page'.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "hosted_page"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/invoices"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Invoice
      type: object
      additionalProperties: true
      properties:
        id:
          description: Unique ID of the invoice
          type:
          - string
          - 'null'
        po_number:
          description: Purchase order number
          type:
          - string
          - 'null'
        customer_id:
          description: ID of the customer
          type:
          - string
          - 'null'
        subscription_id:
          description: ID of the subscription associated
          type:
          - string
          - 'null'
        recurring:
          description: Flag indicating if it's a recurring invoice
          type:
          - boolean
          - 'null'
        status:
          description: Status of the invoice
          type:
          - string
          - 'null'
        vat_number:
          description: VAT number
          type:
          - string
          - 'null'
        price_type:
          description: Type of pricing
          type:
          - string
          - 'null'
        date:
          description: Date of the invoice
          type:
          - integer
          - 'null'
        due_date:
          description: Due date for payment
          type:
          - integer
          - 'null'
        net_term_days:
          description: Net term days for payment
          type:
          - integer
          - 'null'
        exchange_rate:
          description: Exchange rate used for currency conversion
          type:
          - number
          - 'null'
        currency_code:
          description: Currency code of the invoice
          type:
          - string
          - 'null'
        total:
          description: Total amount of the invoice
          type:
          - integer
          - 'null'
        amount_paid:
          description: Amount already paid
          type:
          - integer
          - 'null'
        amount_adjusted:
          description: Total amount adjusted in the invoice
          type:
          - integer
          - 'null'
        write_off_amount:
          description: Amount written off
          type:
          - integer
          - 'null'
        credits_applied:
          description: Total credits applied to the invoice
          type:
          - integer
          - 'null'
        amount_due:
          description: Amount due for payment
          type:
          - integer
          - 'null'
        paid_at:
          description: Date when the invoice was paid
          type:
          - integer
          - 'null'
        dunning_status:
          description: Status of dunning for the invoice
          type:
          - string
          - 'null'
        next_retry_at:
          description: Date of the next payment retry
          type:
          - integer
          - 'null'
        voided_at:
          description: Date when the invoice was voided
          type:
          - integer
          - 'null'
        resource_version:
          description: Resource version of the invoice
          type:
          - integer
          - 'null'
        updated_at:
          description: Date of last update
          type:
          - integer
          - 'null'
        sub_total:
          description: Subtotal amount
          type:
          - integer
          - 'null'
        sub_total_in_local_currency:
          description: Subtotal amount in local currency
          type:
          - integer
          - 'null'
        total_in_local_currency:
          description: Total amount in local currency
          type:
          - integer
          - 'null'
        local_currency_code:
          description: Local currency code of the invoice
          type:
          - string
          - 'null'
        tax:
          description: Total tax amount
          type:
          - integer
          - 'null'
        local_currency_exchange_rate:
          description: Exchange rate for local currency conversion
          type:
          - number
          - 'null'
        first_invoice:
          description: Flag indicating whether it's the first invoice
          type:
          - boolean
          - 'null'
        new_sales_amount:
          description: New sales amount in the invoice
          type:
          - integer
          - 'null'
        has_advance_charges:
          description: Flag indicating if there are advance charges
          type:
          - boolean
          - 'null'
        term_finalized:
          description: Flag indicating if the term is finalized
          type:
          - boolean
          - 'null'
        is_gifted:
          description: Flag indicating if the invoice is gifted
          type:
          - boolean
          - 'null'
        is_digital:
          description: Flag indicating if the invoice is digital
          type:
          - boolean
          - 'null'
        generated_at:
          description: Date when the invoice was generated
          type:
          - integer
          - 'null'
        expected_payment_date:
          description: Expected date of payment
          type:
          - integer
          - 'null'
        amount_to_collect:
          description: Amount yet to be collected
          type:
          - integer
          - 'null'
        round_off_amount:
          description: Amount rounded off
          type:
          - integer
          - 'null'
        payment_owner:
          description: Owner of the payment
          type:
          - string
          - 'null'
        void_reason_code:
          description: Reason code for voiding the invoice
          type:
          - string
          - 'null'
        deleted:
          description: Flag indicating if the invoice is deleted
          type:
          - boolean
          - 'null'
        tax_category:
          description: Tax category
          type:
          - string
          - 'null'
        vat_number_prefix:
          description: Prefix for the VAT number
          type:
          - string
          - 'null'
        channel:
          description: Channel through which the invoice was generated
          type:
          - string
          - 'null'
        business_entity_id:
          description: ID of the business entity
          type:
          - string
          - 'null'
        base_currency_code:
          description: Currency code used as base for the invoice
          type:
          - string
          - 'null'
        object:
          description: Type of object
          type:
          - string
          - 'null'
        line_items:
          description: Details of individual line items in the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the line item
                type:
                - string
                - 'null'
              subscription_id:
                description: ID of the subscription associated with the line item
                type:
                - string
                - 'null'
              date_from:
                description: Start date for the line item service
                type:
                - integer
                - 'null'
              date_to:
                description: End date for the line item service
                type:
                - integer
                - 'null'
              unit_amount:
                description: Unit amount of the line item
                type:
                - integer
                - 'null'
              quantity:
                description: Quantity of the line item
                type:
                - integer
                - 'null'
              amount:
                description: Total amount for the line item
                type:
                - integer
                - 'null'
              pricing_model:
                description: Pricing model applied to the line item
                type:
                - string
                - 'null'
              is_taxed:
                description: Flag indicating if tax is applied
                type:
                - boolean
                - 'null'
              tax_amount:
                description: Total tax amount applied
                type:
                - integer
                - 'null'
              tax_rate:
                description: Rate of tax applied
                type:
                - number
                - 'null'
              unit_amount_in_decimal:
                description: Unit amount of the line item in decimal form
                type:
                - string
                - 'null'
              quantity_in_decimal:
                description: Quantity of the line item in decimal form
                type:
                - string
                - 'null'
              amount_in_decimal:
                description: Total amount in decimal form
                type:
                - string
                - 'null'
              discount_amount:
                description: Amount of discount applied
                type:
                - integer
                - 'null'
              item_level_discount_amount:
                description: Amount of discount applied at item level
                type:
                - integer
                - 'null'
              description:
                description: Description of the line item
                type:
                - string
                - 'null'
              entity_description:
                description: Description of the associated entity
                type:
                - string
                - 'null'
              entity_type:
                description: Type of associated entity
                type:
                - string
                - 'null'
              tax_exempt_reason:
                description: Reason for tax exemption
                type:
                - string
                - 'null'
              entity_id:
                description: ID of the associated entity
                type:
                - string
                - 'null'
              customer_id:
                description: ID of the customer associated with the line item
                type:
                - string
                - 'null'
              metered:
                description: Indicates if the line item is metered
                type:
                - boolean
                - 'null'
              object:
                description: Type of object representing the line item
                type:
                - string
                - 'null'
        discounts:
          description: Discount details applied to the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              amount:
                description: Amount of the discount
                type:
                - integer
                - 'null'
              description:
                description: Description of the discount
                type:
                - string
                - 'null'
              entity_type:
                description: Type of entity to which the discount is applied
                type:
                - string
                - 'null'
              entity_id:
                description: ID of the entity to which the discount is applied
                type:
                - string
                - 'null'
              coupon_set_code:
                description: Code of the coupon set if applicable
                type:
                - string
                - 'null'
              discount_type:
                description: Type of discount
                type:
                - string
                - 'null'
              discount_percentage:
                description: Percentage of the discount
                type:
                - number
                - 'null'
              object:
                description: Type of object representing the discount
                type:
                - string
                - 'null'
        line_item_discounts:
          description: Details of line item discounts
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: ID of the line item
                type:
                - string
                - 'null'
              discount_type:
                description: Type of the discount
                type:
                - string
                - 'null'
              discount_amount:
                description: Amount of the discount
                type:
                - integer
                - 'null'
              entity_id:
                description: ID of the entity associated with the discount
                type:
                - string
                - 'null'
              coupon_id:
                description: ID of the coupon applied
                type:
                - string
                - 'null'
              object:
                description: Type of object
                type:
                - string
                - 'null'
        taxes:
          description: Details of taxes applied
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              name:
                description: Name of the tax
                type:
                - string
                - 'null'
              amount:
                description: Amount of the tax
                type:
                - integer
                - 'null'
              description:
                description: Description of the tax
                type:
                - string
                - 'null'
        line_item_taxes:
          description: Tax details applied to each line item in the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: ID of the line item to which the tax is applied
                type:
                - string
                - 'null'
              tax_name:
                description: Name of the tax
                type:
                - string
                - 'null'
              tax_rate:
                description: Rate of tax applied
                type:
                - number
                - 'null'
              date_to:
                description: End date for the tax calculation
                type:
                - integer
                - 'null'
              date_from:
                description: Start date for the tax calculation
                type:
                - integer
                - 'null'
              prorated_taxable_amount:
                description: Prorated taxable amount for tax calculation
                type:
                - number
                - 'null'
              is_partial_tax_applied:
                description: Flag indicating partial tax calculation
                type:
                - boolean
                - 'null'
              is_non_compliance_tax:
                description: Flag indicating non-compliance tax
                type:
                - boolean
                - 'null'
              taxable_amount:
                description: Total taxable amount for tax calculation
                type:
                - integer
                - 'null'
              tax_amount:
                description: Amount of tax applied
                type:
                - integer
                - 'null'
              tax_juris_type:
                description: Type of tax jurisdiction
                type:
                - string
                - 'null'
              tax_juris_name:
                description: Tax jurisdiction name
                type:
                - string
                - 'null'
              tax_juris_code:
                description: Tax jurisdiction code
                type:
                - string
                - 'null'
              tax_amount_in_local_currency:
                description: Tax amount in local currency
                type:
                - integer
                - 'null'
              local_currency_code:
                description: Local currency code for the tax calculation
                type:
                - string
                - 'null'
        line_item_tiers:
          description: Tiers information for each line item in the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                description: ID of the line item to which the tier applies
                type:
                - string
                - 'null'
              starting_unit:
                description: Starting unit of tier pricing
                type:
                - integer
                - 'null'
              ending_unit:
                description: Ending unit of tier pricing
                type:
                - integer
                - 'null'
              quantity_used:
                description: Quantity used within the tier
                type:
                - integer
                - 'null'
              unit_amount:
                description: Unit amount for the tier
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: Starting unit in decimal form
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: Ending unit in decimal form
                type:
                - string
                - 'null'
              quantity_used_in_decimal:
                description: Quantity used in decimal form
                type:
                - string
                - 'null'
              unit_amount_in_decimal:
                description: Unit amount in decimal form
                type:
                - string
                - 'null'
              object:
                description: Type of object representing the line item tier
                type:
                - string
                - 'null'
        linked_payments:
          description: Details of linked payments
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              txn_id:
                description: ID of the transaction linked
                type:
                - string
                - 'null'
              applied_amount:
                description: Amount of the linked payment applied
                type:
                - integer
                - 'null'
              applied_at:
                description: Date when the linked payment was applied
                type:
                - integer
                - 'null'
              txn_status:
                description: Status of the linked transaction
                type:
                - string
                - 'null'
              txn_date:
                description: Date of the transaction
                type:
                - integer
                - 'null'
              txn_amount:
                description: Amount of the transaction linked
                type:
                - integer
                - 'null'
        dunning_attempts:
          description: Details of dunning attempts made
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              attempt:
                description: Attempt number
                type:
                - integer
                - 'null'
              transaction_id:
                description: ID of the transaction
                type:
                - string
                - 'null'
              dunning_type:
                description: Type of dunning
                type:
                - string
                - 'null'
              created_at:
                description: Creation date of the attempt
                type:
                - integer
                - 'null'
              txn_status:
                description: Status of the transaction
                type:
                - string
                - 'null'
              txn_amount:
                description: Amount of the transaction
                type:
                - integer
                - 'null'
        applied_credits:
          description: Details of credits applied to the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              cn_id:
                description: ID of the applied credit
                type:
                - string
                - 'null'
              applied_amount:
                description: Amount applied
                type:
                - integer
                - 'null'
              applied_at:
                description: Date when the credit was applied
                type:
                - integer
                - 'null'
              cn_reason_code:
                description: Reason code for the applied credit
                type:
                - string
                - 'null'
              cn_create_reason_code:
                description: Reason code for creating the applied credit
                type:
                - string
                - 'null'
              cn_date:
                description: Date of the applied credit
                type:
                - integer
                - 'null'
              cn_status:
                description: Status of the applied credit
                type:
                - string
                - 'null'
        adjustment_credit_notes:
          description: Details of adjustment credit notes applied to the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              cn_id:
                description: ID of the credit note
                type:
                - string
                - 'null'
              cn_reason_code:
                description: Reason code for the credit note
                type:
                - string
                - 'null'
              cn_create_reason_code:
                description: Reason code for creating the credit note
                type:
                - string
                - 'null'
              cn_date:
                description: Date of the credit note
                type:
                - integer
                - 'null'
              cn_total:
                description: Total amount of the credit note
                type:
                - integer
                - 'null'
              cn_status:
                description: Status of the credit note
                type:
                - string
                - 'null'
        issued_credit_notes:
          description: Details of credit notes issued
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              cn_id:
                description: ID of the issued credit note
                type:
                - string
                - 'null'
              cn_reason_code:
                description: Reason code for the issued credit note
                type:
                - string
                - 'null'
              cn_create_reason_code:
                description: Reason code for creating the issued credit note
                type:
                - string
                - 'null'
              cn_date:
                description: Date of the issued credit note
                type:
                - integer
                - 'null'
              cn_total:
                description: Total amount of the issued credit note
                type:
                - integer
                - 'null'
              cn_status:
                description: Status of the issued credit note
                type:
                - string
                - 'null'
        linked_orders:
          description: Details of linked orders to the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the order
                type:
                - string
                - 'null'
              document_number:
                description: Document number of the order
                type:
                - string
                - 'null'
              status:
                description: Current status of the order
                type:
                - string
                - 'null'
              order_type:
                description: Type of the order
                type:
                - string
                - 'null'
              reference_id:
                description: ID of the reference linked to the order
                type:
                - string
                - 'null'
              fulfillment_status:
                description: Status of order fulfillment
                type:
                - string
                - 'null'
              batch_id:
                description: ID of the order batch
                type:
                - string
                - 'null'
              created_at:
                description: Creation date of the order
                type:
                - integer
                - 'null'
        notes:
          description: Notes associated with the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              entity_type:
                description: Type of the entity related to the note
                type:
                - string
                - 'null'
              note:
                description: Content of the note
                type:
                - string
                - 'null'
              entity_id:
                description: ID of the entity related to the note
                type:
                - string
                - 'null'
        shipping_address:
          description: Details of the shipping address associated with the invoice
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: First name in the shipping address
              type:
              - string
              - 'null'
            last_name:
              description: Last name in the shipping address
              type:
              - string
              - 'null'
            email:
              description: Email address associated with the shipping address
              type:
              - string
              - 'null'
            company:
              description: Company name in the shipping address
              type:
              - string
              - 'null'
            phone:
              description: Phone number associated with the shipping address
              type:
              - string
              - 'null'
            line1:
              description: First line of the shipping address
              type:
              - string
              - 'null'
            line2:
              description: Second line of the shipping address
              type:
              - string
              - 'null'
            line3:
              description: Third line of the shipping address
              type:
              - string
              - 'null'
            city:
              description: City of the shipping address
              type:
              - string
              - 'null'
            state_code:
              description: State code of the shipping address
              type:
              - string
              - 'null'
            state:
              description: State of the shipping address
              type:
              - string
              - 'null'
            country:
              description: Country of the shipping address
              type:
              - string
              - 'null'
            zip:
              description: ZIP code of the shipping address
              type:
              - string
              - 'null'
            validation_status:
              description: Status of address validation
              type:
              - string
              - 'null'
            object:
              description: Type of object representing the shipping address
              type:
              - string
              - 'null'
        statement_descriptor:
          description: Descriptor for the statement
          type:
          - object
          - 'null'
          properties:
            id:
              description: ID of the descriptor
              type:
              - string
              - 'null'
            descriptor:
              description: Descriptor text
              type:
              - string
              - 'null'
            additional_info:
              description: Additional information for the descriptor
              type:
              - string
              - 'null'
        billing_address:
          description: Details of the billing address associated with the invoice
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: First name in the billing address
              type:
              - string
              - 'null'
            last_name:
              description: Last name in the billing address
              type:
              - string
              - 'null'
            email:
              description: Email address associated with the billing address
              type:
              - string
              - 'null'
            company:
              description: Company name in the billing address
              type:
              - string
              - 'null'
            phone:
              description: Phone number associated with the billing address
              type:
              - string
              - 'null'
            line1:
              description: First line of the billing address
              type:
              - string
              - 'null'
            line2:
              description: Second line of the billing address
              type:
              - string
              - 'null'
            line3:
              description: Third line of the billing address
              type:
              - string
              - 'null'
            city:
              description: City of the billing address
              type:
              - string
              - 'null'
            state_code:
              description: State code of the billing address
              type:
              - string
              - 'null'
            state:
              description: State of the billing address
              type:
              - string
              - 'null'
            country:
              description: Country of the billing address
              type:
              - string
              - 'null'
            zip:
              description: ZIP code of the billing address
              type:
              - string
              - 'null'
            validation_status:
              description: Status of address validation
              type:
              - string
              - 'null'
            object:
              description: Type of object representing the billing address
              type:
              - string
              - 'null'
        einvoice:
          description: Details of electronic invoice
          type:
          - object
          - 'null'
          properties:
            id:
              description: ID of the electronic invoice
              type:
              - string
              - 'null'
            reference_number:
              description: Reference number of the electronic invoice
              type:
              - string
              - 'null'
            status:
              description: Status of the electronic invoice
              type:
              - string
              - 'null'
            message:
              description: Message related to the electronic invoice
              type:
              - string
              - 'null'
        linked_taxes_withheld:
          description: Details of linked taxes withheld on the invoice
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the tax withholding
                type:
                - string
                - 'null'
              amount:
                description: Amount of tax withheld
                type:
                - integer
                - 'null'
              description:
                description: Description of the tax withholding
                type:
                - string
                - 'null'
              date:
                description: Date of tax withholding
                type:
                - integer
                - 'null'
              reference_number:
                description: Reference number of the tax withholding
                type:
                - string
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "invoice"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/items"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Item
      type: object
      properties:
        id:
          description: Unique identifier for the item
          type:
          - string
          - 'null'
        name:
          description: Name of the item
          type:
          - string
          - 'null'
        description:
          description: Description of the item
          type:
          - string
          - 'null'
        status:
          description: Status of the item
          type:
          - string
          - 'null'
        resource_version:
          description: Version of the resource
          type:
          - integer
          - 'null'
        updated_at:
          description: Date and time when the item was last updated
          type:
          - integer
          - 'null'
        item_family_id:
          description: ID of the item's family
          type:
          - string
          - 'null'
        type:
          description: Type of the item
          type:
          - string
          - 'null'
        is_shippable:
          description: Flag indicating if the item is shippable
          type:
          - boolean
          - 'null'
        is_giftable:
          description: Flag indicating if the item is giftable
          type:
          - boolean
          - 'null'
        redirect_url:
          description: URL to redirect for the item
          type:
          - string
          - 'null'
        enabled_for_checkout:
          description: Flag indicating if the item is enabled for checkout
          type:
          - boolean
          - 'null'
        enabled_in_portal:
          description: Flag indicating if the item is enabled in the portal
          type:
          - boolean
          - 'null'
        included_in_mrr:
          description: Flag indicating if the item is included in Monthly Recurring
            Revenue
          type:
          - boolean
          - 'null'
        item_applicability:
          description: Applicability of the item
          type:
          - string
          - 'null'
        gift_claim_redirect_url:
          description: URL to redirect for gift claim
          type:
          - string
          - 'null'
        unit:
          description: Unit associated with the item
          type:
          - string
          - 'null'
        metered:
          description: Flag indicating if the item is metered
          type:
          - boolean
          - 'null'
        usage_calculation:
          description: Calculation method used for item usage
          type:
          - string
          - 'null'
        archived_at:
          description: Date and time when the item was archived
          type:
          - integer
          - 'null'
        metadata:
          description: Additional data associated with the item
          type:
          - object
          - 'null'
          properties: {}
        external_name:
          description: Name of the item in an external system
          type:
          - string
          - 'null'
        applicable_items:
          description: Items associated with the item
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: Unique identifier for the item
                type:
                - string
                - 'null'
        channel:
          description: Channel the item belongs to
          type:
          - string
          - 'null'
        object:
          description: Type of object
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "item"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/item_prices"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Item Prices
      type: object
      properties:
        id:
          description: Unique identifier for the item.
          type:
          - string
          - 'null'
        name:
          description: Name of the item.
          type:
          - string
          - 'null'
        item_family_id:
          description: Identifier for the item family to which the item belongs.
          type:
          - string
          - 'null'
        item_id:
          description: Unique identifier for the item.
          type:
          - string
          - 'null'
        description:
          description: Description of the item.
          type:
          - string
          - 'null'
        status:
          description: Current status of the item (e.g., active, inactive).
          type:
          - string
          - 'null'
        external_name:
          description: External name of the item.
          type:
          - string
          - 'null'
        pricing_model:
          description: The pricing model used for the item (e.g., flat fee, usage-based).
          type:
          - string
          - 'null'
        price:
          description: Price of the item.
          type:
          - integer
          - 'null'
        price_in_decimal:
          description: Price of the item represented in decimal format.
          type:
          - string
          - 'null'
        period:
          description: Duration of the item's billing period.
          type:
          - integer
          - 'null'
        currency_code:
          description: The currency code used for pricing the item.
          type:
          - string
          - 'null'
        period_unit:
          description: Unit of measurement for the billing period duration.
          type:
          - string
          - 'null'
        trial_period:
          description: Duration of the trial period.
          type:
          - integer
          - 'null'
        trial_period_unit:
          description: Unit of measurement for the trial period duration.
          type:
          - string
          - 'null'
        trial_end_action:
          description: Action to be taken at the end of the trial period.
          type:
          - string
          - 'null'
        shipping_period:
          description: Duration of the item's shipping period.
          type:
          - integer
          - 'null'
        shipping_period_unit:
          description: Unit of measurement for the shipping period duration.
          type:
          - string
          - 'null'
        billing_cycles:
          description: Number of billing cycles for the item.
          type:
          - integer
          - 'null'
        free_quantity:
          description: Free quantity allowed for the item.
          type:
          - integer
          - 'null'
        free_quantity_in_decimal:
          description: Free quantity allowed represented in decimal format.
          type:
          - string
          - 'null'
        resource_version:
          description: Version of the item resource.
          type:
          - integer
          - 'null'
        updated_at:
          description: Date and time when the item was last updated.
          type:
          - integer
          - 'null'
        created_at:
          description: Date and time when the item was created.
          type:
          - integer
          - 'null'
        archived_at:
          description: Date and time when the item was archived.
          type:
          - integer
          - 'null'
        invoice_notes:
          description: Notes to be included in the invoice for the item.
          type:
          - string
          - 'null'
        is_taxable:
          description: Flag indicating whether the item is taxable.
          type:
          - boolean
          - 'null'
        metadata:
          description: Additional metadata associated with the item.
          type:
          - object
          - 'null'
          properties: {}
        item_type:
          description: Type of the item (e.g., product, service).
          type:
          - string
          - 'null'
        show_description_in_invoices:
          description: Flag indicating whether to show the description in invoices.
          type:
          - boolean
          - 'null'
        show_description_in_quotes:
          description: Flag indicating whether to show the description in quotes.
          type:
          - boolean
          - 'null'
        tiers:
          description: Different pricing tiers for the item.
          type:
          - array
          - 'null'
          items:
            description: Specific details for each tier such as price, quantity, discount,
              etc.
            type:
            - object
            - 'null'
            properties:
              starting_unit:
                description: Starting unit for the tier.
                type:
                - integer
                - 'null'
              ending_unit:
                description: Ending unit for the tier.
                type:
                - integer
                - 'null'
              price:
                description: Price for the tier.
                type:
                - integer
                - 'null'
        tax_detail:
          description: Information about taxes associated with the item price.
          type:
          - object
          - 'null'
          properties:
            tax_profile_id:
              description: Tax profile identifier.
              type:
              - string
              - 'null'
            avalara_sale_type:
              description: Avalara sale type for tax calculation.
              type:
              - string
              - 'null'
            avalara_transaction_type:
              description: Avalara transaction type for tax calculation.
              type:
              - integer
              - 'null'
            avalara_service_type:
              description: Avalara service type for tax calculation.
              type:
              - integer
              - 'null'
            avalara_tax_code:
              description: Avalara tax code.
              type:
              - string
              - 'null'
            taxjar_product_code:
              description: TaxJar product code for tax calculation.
              type:
              - string
              - 'null'
        accounting_detail:
          description: Details related to accounting such as cost, revenue, expenses,
            etc.
          type:
          - object
          - 'null'
          properties:
            sku:
              description: Stock Keeping Unit (SKU) code of the item.
              type:
              - string
              - 'null'
            accounting_code:
              description: The accounting code associated with the item.
              type:
              - string
              - 'null'
            accounting_category1:
              description: The first accounting category.
              type:
              - string
              - 'null'
            accounting_category2:
              description: The second accounting category.
              type:
              - string
              - 'null'
            accounting_category3:
              description: The third accounting category.
              type:
              - string
              - 'null'
            accounting_category4:
              description: The fourth accounting category.
              type:
              - string
              - 'null'
        channel:
          description: The channel through which the item is sold.
          type:
          - string
          - 'null'
        object:
          description: Object type representing the item.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "item_price"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/plans"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Plan
      type: object
      properties:
        id:
          description: The ID of the plan
          type:
          - string
          - 'null'
        name:
          description: Name of the plan
          type:
          - string
          - 'null'
        invoice_name:
          description: Name used in invoices
          type:
          - string
          - 'null'
        description:
          description: Description of the plan
          type:
          - string
          - 'null'
        price:
          description: Price of the plan
          type:
          - integer
          - 'null'
        currency_code:
          description: The currency code used for pricing
          type:
          - string
          - 'null'
        period:
          description: Duration of each billing cycle
          type:
          - integer
          - 'null'
        period_unit:
          description: Unit of the billing cycle duration
          type:
          - string
          - 'null'
        trial_period:
          description: Duration of the trial period
          type:
          - integer
          - 'null'
        trial_period_unit:
          description: Unit of the trial period duration
          type:
          - string
          - 'null'
        trial_end_action:
          description: Action to take at the end of the trial period
          type:
          - string
          - 'null'
        pricing_model:
          description: Model used for pricing
          type:
          - string
          - 'null'
        free_quantity:
          description: Free quantity included in the plan
          type:
          - integer
          - 'null'
        setup_cost:
          description: One-time setup cost of the plan
          type:
          - integer
          - 'null'
        status:
          description: Status of the plan
          type:
          - string
          - 'null'
        archived_at:
          description: Timestamp when the plan was archived
          type:
          - integer
          - 'null'
        billing_cycles:
          description: Number of billing cycles for the plan
          type:
          - integer
          - 'null'
        redirect_url:
          description: URL for redirecting users
          type:
          - string
          - 'null'
        enabled_in_hosted_pages:
          description: Whether the plan is enabled in hosted pages
          type:
          - boolean
          - 'null'
        enabled_in_portal:
          description: Whether the plan is enabled in the portal
          type:
          - boolean
          - 'null'
        addon_applicability:
          description: How the add-ons are applicable to the plan
          type:
          - string
          - 'null'
        tax_code:
          description: Tax code associated with the plan
          type:
          - string
          - 'null'
        taxjar_product_code:
          description: TaxJar product code for tax calculations
          type:
          - string
          - 'null'
        avalara_sale_type:
          description: Avalara sale type for tax calculations
          type:
          - string
          - 'null'
        avalara_transaction_type:
          description: Avalara transaction type for tax calculations
          type:
          - integer
          - 'null'
        avalara_service_type:
          description: Avalara service type for tax calculations
          type:
          - integer
          - 'null'
        sku:
          description: Stock Keeping Unit (SKU) for the plan
          type:
          - string
          - 'null'
        accounting_code:
          description: The accounting code associated with the plan
          type:
          - string
          - 'null'
        accounting_category1:
          description: The first category for accounting purposes
          type:
          - string
          - 'null'
        accounting_category2:
          description: The second category for accounting purposes
          type:
          - string
          - 'null'
        accounting_category3:
          description: The third category for accounting purposes
          type:
          - string
          - 'null'
        accounting_category4:
          description: The fourth category for accounting purposes
          type:
          - string
          - 'null'
        is_shippable:
          description: Whether the plan is shippable
          type:
          - boolean
          - 'null'
        shipping_frequency_period:
          description: Frequency of shipping for physical goods
          type:
          - integer
          - 'null'
        shipping_frequency_period_unit:
          description: Unit of the shipping frequency
          type:
          - string
          - 'null'
        resource_version:
          description: Version of the plan resource
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp when the plan was last updated
          type:
          - integer
          - 'null'
        giftable:
          description: Whether the plan is giftable
          type:
          - boolean
          - 'null'
        claim_url:
          description: URL for claiming the plan
          type:
          - string
          - 'null'
        free_quantity_in_decimal:
          description: Decimal free quantity included in the plan
          type:
          - string
          - 'null'
        price_in_decimal:
          description: Decimal price of the plan
          type:
          - string
          - 'null'
        invoice_notes:
          description: Notes included in invoices
          type:
          - string
          - 'null'
        channel:
          description: Channel associated with the plan
          type:
          - string
          - 'null'
        charge_model:
          description: The model used for charging
          type:
          - string
          - 'null'
        object:
          description: Type of object (plan)
          type:
          - string
          - 'null'
        taxable:
          description: Whether the plan is taxable
          type:
          - boolean
          - 'null'
        tax_profile_id:
          description: ID of the tax profile
          type:
          - string
          - 'null'
        meta_data:
          description: Additional metadata associated with the plan
          type:
          - object
          - 'null'
          properties: {}
        show_description_in_invoices:
          description: Whether to show the description in invoices
          type:
          - boolean
          - 'null'
        show_description_in_quotes:
          description: Whether to show the description in quotes
          type:
          - boolean
          - 'null'
        tiers:
          description: Pricing tiers for this plan
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              starting_unit:
                description: Starting unit quantity for tiered pricing
                type:
                - integer
                - 'null'
              ending_unit:
                description: Ending unit quantity for tiered pricing
                type:
                - integer
                - 'null'
              price:
                description: Price for the tier
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: Decimal starting unit quantity for tiered pricing
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: Decimal ending unit quantity for tiered pricing
                type:
                - string
                - 'null'
              price_in_decimal:
                description: Decimal price for the tier
                type:
                - string
                - 'null'
        applicable_addons:
          description: Available addons that can be applied to this plan
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The ID of the applicable add-ons
                type:
                - string
                - 'null'
        attached_addons:
          description: Addons currently attached to this plan
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the attached add-ons
                type:
                - string
                - 'null'
              quantity:
                description: Quantity of the attached add-ons
                type:
                - integer
                - 'null'
              billing_cycles:
                description: Number of billing cycles for the attached add-ons
                type:
                - integer
                - 'null'
              type:
                description: Type of the attached add-ons
                type:
                - string
                - 'null'
              quantity_in_decimal:
                description: Decimal quantity of the attached add-ons
                type:
                - string
                - 'null'
        event_based_addons:
          description: Addons triggered based on specific events for this plan
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the event-based add-ons
                type:
                - string
                - 'null'
              quantity:
                description: Quantity of event-based add-ons
                type:
                - integer
                - 'null'
              on_event:
                description: Event triggering the charge
                type:
                - string
                - 'null'
              charge_once:
                description: Whether to charge only once for event-based add-ons
                type:
                - boolean
                - 'null'
              quantity_in_decimal:
                description: Decimal quantity of event-based add-ons
                type:
                - string
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "plan"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/payment_sources"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Payment Source
      type: object
      properties:
        id:
          description: Unique identifier for the payment source
          type:
          - string
          - 'null'
        resource_version:
          description: Version of the payment source resource
          type:
          - integer
          - 'null'
        updated_at:
          description: Timestamp indicating when the payment source was last updated
          type:
          - integer
          - 'null'
        created_at:
          description: Timestamp indicating when the payment source was created
          type:
          - integer
          - 'null'
        customer_id:
          description: Unique identifier for the customer associated with the payment
            source
          type:
          - string
          - 'null'
        object:
          description: Type of object, e.g., payment_source
          type:
          - string
          - 'null'
        type:
          description: Type of payment source, e.g., card, bank_account
          type:
          - string
          - 'null'
        reference_id:
          description: Reference identifier for the payment source
          type:
          - string
          - 'null'
        status:
          description: Status of the payment source, e.g., active or inactive
          type:
          - string
          - 'null'
        gateway:
          description: Name of the payment gateway used for the payment source
          type:
          - string
          - 'null'
        gateway_account_id:
          description: Identifier for the gateway account tied to the payment source
          type:
          - string
          - 'null'
        ip_address:
          description: IP address associated with the payment source
          type:
          - string
          - 'null'
        issuing_country:
          description: Country where the payment source was issued
          type:
          - string
          - 'null'
        deleted:
          description: Indicates if the payment source has been deleted
          type:
          - boolean
          - 'null'
        business_entity_id:
          description: Identifier for the business entity associated with the payment
            source
          type:
          - string
          - 'null'
        card:
          description: Data related to card payment source
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: First name of the cardholder
              type:
              - string
              - 'null'
            last_name:
              description: Last name of the cardholder
              type:
              - string
              - 'null'
            iin:
              description: Issuer Identification Number of the card
              type:
              - string
              - 'null'
            last4:
              description: Last four digits of the card number
              type:
              - string
              - 'null'
            brand:
              description: Brand of the card, e.g., Visa, Mastercard
              type:
              - string
              - 'null'
            funding_type:
              description: Type of funding, e.g., credit or debit
              type:
              - string
              - 'null'
            expiry_month:
              description: Expiry month of the card
              type:
              - integer
              - 'null'
            expiry_year:
              description: Expiry year of the card
              type:
              - integer
              - 'null'
            billing_addr1:
              description: First line of the billing address
              type:
              - string
              - 'null'
            billing_addr2:
              description: Second line of the billing address
              type:
              - string
              - 'null'
            billing_city:
              description: City of the billing address
              type:
              - string
              - 'null'
            billing_state_code:
              description: State code of the billing address
              type:
              - string
              - 'null'
            billing_state:
              description: State of the billing address
              type:
              - string
              - 'null'
            billing_country:
              description: Country of the billing address
              type:
              - string
              - 'null'
            billing_zip:
              description: ZIP or postal code of the billing address
              type:
              - string
              - 'null'
            masked_number:
              description: Masked card number for security purposes
              type:
              - string
              - 'null'
            object:
              description: Type of payment source object, e.g., card
              type:
              - string
              - 'null'
        bank_account:
          description: Data related to bank account payment source
          type:
          - object
          - 'null'
          properties:
            last4:
              description: Last four digits of the bank account number
              type:
              - string
              - 'null'
            name_on_account:
              description: Name on the bank account
              type:
              - string
              - 'null'
            first_name:
              description: First name of the account holder
              type:
              - string
              - 'null'
            last_name:
              description: Last name of the account holder
              type:
              - string
              - 'null'
            bank_name:
              description: Name of the bank associated with the account
              type:
              - string
              - 'null'
            mandate_id:
              description: Unique identifier for the mandate related to the bank account
              type:
              - string
              - 'null'
            account_type:
              description: Type of bank account, e.g., checking or savings
              type:
              - string
              - 'null'
            echeck_type:
              description: Type of eCheck, if applicable
              type:
              - string
              - 'null'
            account_holder_type:
              description: Type of account holder, e.g., individual or business
              type:
              - string
              - 'null'
            email:
              description: Email associated with the bank account
              type:
              - string
              - 'null'
        amazon_payment:
          description: Data related to Amazon Pay payment source
          type:
          - object
          - 'null'
          properties:
            email:
              description: Email associated with the Amazon payment method
              type:
              - string
              - 'null'
            agreement_id:
              description: Unique identifier for the Amazon payment agreement
              type:
              - string
              - 'null'
        upi:
          description: Data related to UPI payment source
          type:
          - object
          - 'null'
          properties:
            vpa:
              description: Virtual Payment Address associated with the UPI payment
                method
              type:
              - string
              - 'null'
        paypal:
          description: Data related to PayPal payment source
          type:
          - object
          - 'null'
          properties:
            email:
              description: Email associated with the PayPal account
              type:
              - string
              - 'null'
            agreement_id:
              description: Unique identifier for the PayPal billing agreement
              type:
              - string
              - 'null'
        mandates:
          description: Data related to mandates for payments
          type:
          - object
          - 'null'
          properties:
            id:
              description: Unique identifier for the mandate related to the payment
                source
              type:
              - string
              - 'null'
            subscription_id:
              description: Unique identifier for the subscription associated with
                the mandate
              type:
              - string
              - 'null'
            created_at:
              description: Timestamp indicating when the mandate associated with the
                payment source was created
              type:
              - integer
              - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "payment_source"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: created_at
        created_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/promotional_credits"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Payment Source
      type: object
      properties:
        id:
          description: The unique identifier of the promotional credit record.
          type:
          - string
          - 'null'
        customer_id:
          description: The ID of the customer associated with the promotional credit.
          type:
          - string
          - 'null'
        type:
          description: The category or classification of the promotional credit.
          type:
          - string
          - 'null'
        amount_in_decimal:
          description: The decimal representation of the promotional credit amount.
          type:
          - string
          - 'null'
        amount:
          description: The amount of promotional credit.
          type:
          - integer
          - 'null'
        currency_code:
          description: The currency code of the promotional credit.
          type:
          - string
          - 'null'
        description:
          description: Additional information or notes about the promotional credit.
          type:
          - string
          - 'null'
        credit_type:
          description: The type of promotional credit.
          type:
          - string
          - 'null'
        reference:
          description: A reference related to the promotional credit.
          type:
          - string
          - 'null'
        closing_balance:
          description: The closing balance after using promotional credit.
          type:
          - integer
          - 'null'
        done_by:
          description: The user who initiated the use of promotional credit.
          type:
          - string
          - 'null'
        created_at:
          description: The timestamp when the promotional credit was created.
          type:
          - integer
          - 'null'
        object:
          description: The object type, usually 'credit'.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "promotional_credit"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/subscriptions"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Subscription
      type: object
      properties:
        id:
          description: The unique ID of the subscription.
          type:
          - string
          - 'null'
        currency_code:
          description: The currency code used for the subscription.
          type:
          - string
          - 'null'
        start_date:
          description: The start date of the subscription.
          type:
          - integer
          - 'null'
        trial_end:
          description: The end date of the trial period for the subscription.
          type:
          - integer
          - 'null'
        remaining_billing_cycles:
          description: The count of remaining billing cycles for the subscription.
          type:
          - integer
          - 'null'
        po_number:
          description: The purchase order number associated with the subscription.
          type:
          - string
          - 'null'
        plan_quantity_in_decimal:
          description: The quantity of the plan in decimal format.
          type:
          - string
          - 'null'
        plan_unit_price_in_decimal:
          description: The unit price of the plan in decimal format.
          type:
          - string
          - 'null'
        customer_id:
          description: The ID of the customer associated with the subscription.
          type:
          - string
          - 'null'
        status:
          description: The current status of the subscription.
          type:
          - string
          - 'null'
        trial_start:
          description: The start date of the trial period for the subscription.
          type:
          - integer
          - 'null'
        trial_end_action:
          description: The action to be taken at the end of the trial period.
          type:
          - string
          - 'null'
        current_term_start:
          description: The start date of the current term for the subscription.
          type:
          - integer
          - 'null'
        current_term_end:
          description: The end date of the current term for the subscription.
          type:
          - integer
          - 'null'
        next_billing_at:
          description: The date and time of the next billing event for the subscription.
          type:
          - integer
          - 'null'
        created_at:
          description: The date and time of the creation of the subscription.
          type:
          - integer
          - 'null'
        started_at:
          description: The date and time when the subscription started.
          type:
          - integer
          - 'null'
        activated_at:
          description: The date and time when the subscription was activated.
          type:
          - integer
          - 'null'
        contract_term_billing_cycle_on_renewal:
          description: Indicates if the contract term billing cycle is applied on
            renewal.
          type:
          - integer
          - 'null'
        override_relationship:
          description: Indicates if the existing relationship is overridden by this
            subscription.
          type:
          - boolean
          - 'null'
        pause_date:
          description: The date on which the subscription was paused.
          type:
          - integer
          - 'null'
        resume_date:
          description: The date on which the subscription was resumed.
          type:
          - integer
          - 'null'
        cancelled_at:
          description: The date and time when the subscription was cancelled.
          type:
          - integer
          - 'null'
        cancel_reason:
          description: The reason for the cancellation of the subscription.
          type:
          - string
          - 'null'
        created_from_ip:
          description: The IP address from which the subscription was created.
          type:
          - string
          - 'null'
        resource_version:
          description: The version of the resource (subscription).
          type:
          - integer
          - 'null'
        updated_at:
          description: The date and time when the subscription was last updated.
          type:
          - integer
          - 'null'
        has_scheduled_advance_invoices:
          description: Indicates if there are scheduled advance invoices for the subscription.
          type:
          - boolean
          - 'null'
        has_scheduled_changes:
          description: Indicates if there are scheduled changes for the subscription.
          type:
          - boolean
          - 'null'
        payment_source_id:
          description: The ID of the payment source used for the subscription.
          type:
          - string
          - 'null'
        plan_free_quantity_in_decimal:
          description: The free quantity included in the plan in decimal format.
          type:
          - string
          - 'null'
        plan_amount_in_decimal:
          description: The total amount charged for the plan in decimal format.
          type:
          - string
          - 'null'
        cancel_schedule_created_at:
          description: The date and time when the cancellation schedule was created.
          type:
          - integer
          - 'null'
        due_invoices_count:
          description: The count of due invoices for the subscription.
          type:
          - integer
          - 'null'
        due_since:
          description: The date since which the invoices are due.
          type:
          - integer
          - 'null'
        total_dues:
          description: The total amount of dues for the subscription.
          type:
          - integer
          - 'null'
        mrr:
          description: The monthly recurring revenue generated by the subscription.
          type:
          - integer
          - 'null'
        exchange_rate:
          description: The exchange rate used for currency conversion.
          type:
          - number
          - 'null'
        base_currency_code:
          description: The base currency code used for the subscription.
          type:
          - string
          - 'null'
        invoice_notes:
          description: Any notes added to the invoices of the subscription.
          type:
          - string
          - 'null'
        metadata:
          description: Additional metadata associated with subscription
          type:
          - object
          - 'null'
          properties: {}
        deleted:
          description: Indicates if the subscription has been deleted.
          type:
          - boolean
          - 'null'
        object:
          description: The type of object (subscription).
          type:
          - string
          - 'null'
        coupon:
          description: The coupon applied to the subscription.
          type:
          - string
          - 'null'
        cancel_reason_code:
          description: The code associated with the cancellation reason.
          type:
          - string
          - 'null'
        free_period:
          description: The duration of the free period for the subscription.
          type:
          - integer
          - 'null'
        free_period_unit:
          description: The unit of the free period duration.
          type:
          - string
          - 'null'
        create_pending_invoices:
          description: Indicates if pending invoices are created.
          type:
          - boolean
          - 'null'
        auto_close_invoices:
          description: Defines if the invoices are automatically closed or not.
          type:
          - boolean
          - 'null'
        business_entity_id:
          description: The ID of the business entity to which the subscription belongs.
          type:
          - string
          - 'null'
        channel:
          description: The channel through which the subscription was acquired.
          type:
          - string
          - 'null'
        coupons:
          description: Details of applied coupons
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              coupon_id:
                description: The ID of the applied coupon.
                type: string
              apply_till:
                description: The date until which the coupon can be applied.
                type:
                - integer
                - 'null'
              apply_count:
                description: The count of times the coupon can be applied.
                type:
                - integer
                - 'null'
              coupon_code:
                description: The code of the applied coupon.
                type:
                - string
                - 'null'
              applied_count:
                description: The count of times the coupon has been applied.
                type:
                - integer
                - 'null'
              object:
                description: The type of object (coupon).
                type:
                - string
                - 'null'
        shipping_address:
          description: Stores the shipping address related to the subscription
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: The first name in the shipping address.
              type:
              - string
              - 'null'
            last_name:
              description: The last name in the shipping address.
              type:
              - string
              - 'null'
            email:
              description: The email address in the shipping address.
              type:
              - string
              - 'null'
            company:
              description: The company name in the shipping address.
              type:
              - string
              - 'null'
            phone:
              description: The phone number in the shipping address.
              type:
              - string
              - 'null'
            line1:
              description: The first line of the shipping address.
              type:
              - string
              - 'null'
            line2:
              description: The second line of the shipping address.
              type:
              - string
              - 'null'
            line3:
              description: The third line of the shipping address.
              type:
              - string
              - 'null'
            city:
              description: The city in the shipping address.
              type:
              - string
              - 'null'
            state_code:
              description: The state code in the shipping address.
              type:
              - string
              - 'null'
            state:
              description: The state in the shipping address.
              type:
              - string
              - 'null'
            country:
              description: The country in the shipping address.
              type:
              - string
              - 'null'
            zip:
              description: The ZIP or postal code in the shipping address.
              type:
              - string
              - 'null'
            validation_status:
              description: The validation status of the shipping address.
              type:
              - string
              - 'null'
        referral_info:
          description: Contains details related to any referral information associated
            with the subscription
          type:
          - object
          - 'null'
          properties:
            referral_code:
              description: The code associated with the referral.
              type:
              - string
              - 'null'
            coupon_code:
              description: The coupon code used for the referral.
              type:
              - string
              - 'null'
            referral_id:
              description: The unique identifier of the referral.
              type:
              - string
              - 'null'
            external_reference_id:
              description: The external reference identifier of the referral.
              type:
              - string
              - 'null'
            reward_status:
              description: The status of the reward for the referral.
              type:
              - string
              - 'null'
            referral_system:
              description: The system handling the referrals.
              type:
              - string
              - 'null'
            account_id:
              description: The account identifier of the referral.
              type:
              - string
              - 'null'
            campaign_id:
              description: The campaign identifier of the referral.
              type:
              - string
              - 'null'
            external_campaign_id:
              description: The external campaign identifier of the referral.
              type:
              - string
              - 'null'
            friend_offer_type:
              description: The type of offer for a friend in the referral program.
              type:
              - string
              - 'null'
            referrer_reward_type:
              description: The type of reward for the referrer in the referral program.
              type:
              - string
              - 'null'
            notify_referral_system:
              description: Whether to notify the referral system.
              type:
              - string
              - 'null'
            destination_url:
              description: The URL to which the referral leads.
              type:
              - string
              - 'null'
            post_purchase_widget_enabled:
              description: Whether the post-purchase widget is enabled for the referral.
              type:
              - boolean
              - 'null'
        contract_term:
          description: Contains details about the contract term of the subscription
          type:
          - object
          - 'null'
          properties:
            id:
              description: The unique identifier of the contract term.
              type:
              - string
              - 'null'
            status:
              description: The status of the contract term.
              type:
              - string
              - 'null'
            contract_start:
              description: The start date of the contract.
              type:
              - integer
              - 'null'
            contract_end:
              description: The end date of the contract.
              type:
              - integer
              - 'null'
            billing_cycle:
              description: The billing cycle duration of the contract.
              type:
              - integer
              - 'null'
            action_at_term_end:
              description: The action to be taken at the end of the contract term.
              type:
              - string
              - 'null'
            total_contract_value:
              description: The total value of the contract.
              type:
              - integer
              - 'null'
            cancellation_cutoff_period:
              description: The period within which cancellation is allowed before
                the next term.
              type:
              - integer
              - 'null'
            created_at:
              description: The timestamp when the contract term was created.
              type:
              - integer
              - 'null'
            subscription_id:
              description: The identifier of the subscription associated with the
                contract term.
              type:
              - string
              - 'null'
            remaining_billing_cycles:
              description: The remaining billing cycles for the contract term.
              type:
              - integer
              - 'null'
        subscription_items:
          description: Lists individual items included in the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_price_id:
                description: The unique identifier of the item price associated with
                  the subscription item.
                type:
                - string
                - 'null'
              item_type:
                description: The type of the subscription item.
                type:
                - string
                - 'null'
              quantity:
                description: The quantity of the subscription item.
                type:
                - integer
                - 'null'
              quantity_in_decimal:
                description: The quantity in decimal format for the subscription item.
                type:
                - string
                - 'null'
              unit_price:
                description: The unit price of the subscription item.
                type:
                - integer
                - 'null'
              unit_price_in_decimal:
                description: The unit price in decimal format for the subscription
                  item.
                type:
                - string
                - 'null'
              amount:
                description: The amount charged for the subscription item.
                type:
                - integer
                - 'null'
              amount_in_decimal:
                description: The amount in decimal format for the subscription item.
                type:
                - string
                - 'null'
              free_quantity:
                description: The free quantity included with the subscription item.
                type:
                - integer
                - 'null'
              free_quantity_in_decimal:
                description: The free quantity in decimal format for the subscription
                  item.
                type:
                - string
                - 'null'
              trial_end:
                description: The end date of the trial period for the subscription
                  item.
                type:
                - integer
                - 'null'
              billing_cycles:
                description: The number of billing cycles for the subscription item.
                type:
                - integer
                - 'null'
              service_period_days:
                description: The number of days in the service period.
                type:
                - integer
                - 'null'
              charge_on_event:
                description: The event triggering the charge for the subscription
                  item.
                type:
                - string
                - 'null'
              charge_once:
                description: Whether the subscription item is charged only once.
                type:
                - boolean
                - 'null'
              charge_on_option:
                description: The charge option for the subscription item.
                type:
                - string
                - 'null'
              object:
                description: The type of the subscription item.
                type:
                - string
                - 'null'
        item_tiers:
          description: Provides information about tiers or levels for specific subscription
            items
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_price_id:
                description: The identifier of the item price associated with the
                  tier.
                type:
                - string
                - 'null'
              starting_unit:
                description: The starting unit of the tier.
                type:
                - integer
                - 'null'
              ending_unit:
                description: The ending unit of the tier.
                type:
                - integer
                - 'null'
              price:
                description: The price of the tier.
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: The starting unit in decimal format for the tier.
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: The ending unit in decimal format for the tier.
                type:
                - string
                - 'null'
              price_in_decimal:
                description: The price in decimal format for the tier.
                type:
                - string
                - 'null'
              object:
                description: The type of the item tier.
                type:
                - string
                - 'null'
        charged_items:
          description: Lists the items that have been charged as part of the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_price_id:
                description: The identifier of the item price charged.
                type:
                - string
                - 'null'
              last_charged_at:
                description: The timestamp of the last charge for the item.
                type:
                - integer
                - 'null'
              object:
                description: The type of the charged item.
                type:
                - string
                - 'null'
        plan_id:
          description: The ID of the plan associated with the subscription.
          type:
          - string
          - 'null'
        plan_quantity:
          description: The quantity of the plan included in the subscription.
          type:
          - integer
          - 'null'
        plan_unit_price:
          description: The unit price of the plan for the subscription.
          type:
          - integer
          - 'null'
        setup_fee:
          description: The setup fee charged for the subscription.
          type:
          - integer
          - 'null'
        billing_period:
          description: The billing period duration for the subscription.
          type:
          - integer
          - 'null'
        billing_period_unit:
          description: The unit of the billing period.
          type:
          - string
          - 'null'
        auto_collection:
          description: Indicates if auto-collection is enabled for the subscription.
          type:
          - string
          - 'null'
        plan_amount:
          description: The total amount charged for the plan of the subscription.
          type:
          - integer
          - 'null'
        plan_free_quantity:
          description: The free quantity included in the plan of the subscription.
          type:
          - integer
          - 'null'
        gift_id:
          description: The ID of the gift associated with the subscription.
          type:
          - string
          - 'null'
        affiliate_token:
          description: The affiliate token associated with the subscription.
          type:
          - string
          - 'null'
        offline_payment_method:
          description: The offline payment method used for the subscription.
          type:
          - string
          - 'null'
        meta_data:
          description: Additional metadata associated with subscription
          type:
          - object
          - 'null'
          properties: {}
        addons:
          description: Represents any additional features or services added to the
            subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the addon.
                type:
                - string
                - 'null'
              quantity:
                description: The quantity of the addon.
                type:
                - integer
                - 'null'
              unit_price:
                description: The unit price of the addon.
                type:
                - integer
                - 'null'
              amount:
                description: The amount charged for the addon.
                type:
                - integer
                - 'null'
              trial_end:
                description: The end date of the trial period for the addon.
                type:
                - integer
                - 'null'
              remaining_billing_cycles:
                description: The remaining billing cycles for the addon.
                type:
                - integer
                - 'null'
              quantity_in_decimal:
                description: The quantity in decimal format for the addon.
                type:
                - string
                - 'null'
              unit_price_in_decimal:
                description: The unit price in decimal format for the addon.
                type:
                - string
                - 'null'
              amount_in_decimal:
                description: The amount in decimal format for the addon.
                type:
                - string
                - 'null'
        event_based_addons:
          description: Specifies any event-based addons associated with the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the event-based addon.
                type:
                - string
                - 'null'
              quantity:
                description: The quantity of the addon.
                type:
                - integer
                - 'null'
              unit_price:
                description: The unit price of the addon.
                type:
                - integer
                - 'null'
              on_event:
                description: The event triggering the addon charge.
                type:
                - string
                - 'null'
              charge_once:
                description: Whether the addon is charged only once.
                type:
                - boolean
                - 'null'
              quantity_in_decimal:
                description: The quantity in decimal format for the addon.
                type:
                - string
                - 'null'
              unit_price_in_decimal:
                description: The unit price in decimal format for the addon.
                type:
                - string
                - 'null'
        charged_event_based_addons:
          description: Details of addons charged based on events
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The ID of the charged event-based addon.
                type:
                - string
                - 'null'
              last_charged_at:
                description: The date and time of the last charge for the addon.
                type:
                - integer
                - 'null'
        discounts:
          description: Includes any discounts applied to the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the discount.
                type:
                - string
                - 'null'
              invoice_name:
                description: The name of the discount on the invoice.
                type:
                - string
                - 'null'
              type:
                description: The type of the discount.
                type:
                - string
                - 'null'
              percentage:
                description: The percentage value of the discount.
                type:
                - number
                - 'null'
              amount:
                description: The amount of discount applied.
                type:
                - integer
                - 'null'
              currency_code:
                description: The currency code of the discount.
                type:
                - string
                - 'null'
              duration_type:
                description: The duration type of the discount (e.g., forever, once).
                type:
                - string
                - 'null'
              period:
                description: The period for which the discount is applicable.
                type:
                - integer
                - 'null'
              period_unit:
                description: The unit of the period (e.g., days, months).
                type:
                - string
                - 'null'
              included_in_mrr:
                description: Whether the discount is included in Monthly Recurring
                  Revenue (MRR) calculation.
                type:
                - boolean
                - 'null'
              apply_on:
                description: The item to which the discount is applied.
                type:
                - string
                - 'null'
              item_price_id:
                description: The identifier of the item price associated with the
                  discount.
                type:
                - string
                - 'null'
              created_at:
                description: The timestamp when the discount was created.
                type:
                - integer
                - 'null'
              apply_till:
                description: The expiry date until which the discount is applicable.
                type:
                - integer
                - 'null'
              applied_count:
                description: The number of times the discount has been applied.
                type:
                - integer
                - 'null'
              coupon_id:
                description: The identifier of the coupon used for the discount.
                type:
                - string
                - 'null'
              index:
                description: The index of the discount.
                type:
                - integer
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "subscription"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        field_path: []
        type: DpathExtractor
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: DefaultErrorHandler
        response_filters:
        - http_codes:
          - 404
          action: IGNORE
          error_message: "Entity unavailable. Subscription may have been deleted."
          type: HttpResponseFilter
        - http_codes:
          - 400
          action: IGNORE
          error_message_contains: "No changes are scheduled for this subscription."
          error_message: "No scheduled changes for subscription."
          type: HttpResponseFilter
      path: "/subscriptions/{{ stream_slice.subscription_id }}/retrieve_with_scheduled_changes"
    partition_router:
      type: SubstreamPartitionRouter
      parent_stream_configs:
      - stream:
          retriever:
            type: SimpleRetriever
            record_selector:
              type: RecordSelector
              extractor:
                type: DpathExtractor
                field_path:
                - "list"
                - "*"
                - "{{ parameters.get('name') }}"
            paginator:
              type: DefaultPaginator
              pagination_strategy:
                type: "CursorPagination"
                cursor_value: "{{ response.get('next_offset')|tojson() }}"
                stop_condition: "{{ not response.next_offset }}"
                page_size_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: limit
                  page_size: 100
              page_token_option:
                type: RequestOption
                inject_into: request_parameter
                field_name: offset
            requester:
              type: HttpRequester
              url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
              http_method: "GET"
              authenticator:
                type: BasicHttpAuthenticator
                username: "{{ config['site_api_key'] }}"
              error_handler:
                type: CompositeErrorHandler
                error_handlers:
                - type: DefaultErrorHandler
                  response_filters:
                  - error_message_contains: "This API operation is not enabled for
                      this site"
                    action: IGNORE
                    error_message: "Stream is available only for Product Catalog 1.0"
                    type: HttpResponseFilter
                - type: DefaultErrorHandler
                  backoff_strategies:
                  - type: WaitTimeFromHeader
                    header: "Retry-After"
              request_parameters:
                sort_by[asc]: updated_at
                include_deleted: "true"
                updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
              path: "/subscriptions"
          transformations:
          - type: CustomTransformation
            class_name: source_declarative_manifest.components.CustomFieldTransformation
          incremental_sync:
            type: DatetimeBasedCursor
            start_datetime:
              datetime: "{{ format_datetime(config['start_date'], '%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            end_datetime:
              datetime: "{{ now_utc().strftime('%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            datetime_format: "%s"
            cursor_granularity: PT1S
            step: P1M
            cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
              }}"
          schema_loader:
            type: InlineSchemaLoader
            schema:
              $schema: http://json-schema.org/draft-07/schema#
              name: Subscription
              type: object
              properties:
                id:
                  description: The unique ID of the subscription.
                  type:
                  - string
                  - 'null'
                currency_code:
                  description: The currency code used for the subscription.
                  type:
                  - string
                  - 'null'
                start_date:
                  description: The start date of the subscription.
                  type:
                  - integer
                  - 'null'
                trial_end:
                  description: The end date of the trial period for the subscription.
                  type:
                  - integer
                  - 'null'
                remaining_billing_cycles:
                  description: The count of remaining billing cycles for the subscription.
                  type:
                  - integer
                  - 'null'
                po_number:
                  description: The purchase order number associated with the subscription.
                  type:
                  - string
                  - 'null'
                plan_quantity_in_decimal:
                  description: The quantity of the plan in decimal format.
                  type:
                  - string
                  - 'null'
                plan_unit_price_in_decimal:
                  description: The unit price of the plan in decimal format.
                  type:
                  - string
                  - 'null'
                customer_id:
                  description: The ID of the customer associated with the subscription.
                  type:
                  - string
                  - 'null'
                status:
                  description: The current status of the subscription.
                  type:
                  - string
                  - 'null'
                trial_start:
                  description: The start date of the trial period for the subscription.
                  type:
                  - integer
                  - 'null'
                trial_end_action:
                  description: The action to be taken at the end of the trial period.
                  type:
                  - string
                  - 'null'
                current_term_start:
                  description: The start date of the current term for the subscription.
                  type:
                  - integer
                  - 'null'
                current_term_end:
                  description: The end date of the current term for the subscription.
                  type:
                  - integer
                  - 'null'
                next_billing_at:
                  description: The date and time of the next billing event for the
                    subscription.
                  type:
                  - integer
                  - 'null'
                created_at:
                  description: The date and time of the creation of the subscription.
                  type:
                  - integer
                  - 'null'
                started_at:
                  description: The date and time when the subscription started.
                  type:
                  - integer
                  - 'null'
                activated_at:
                  description: The date and time when the subscription was activated.
                  type:
                  - integer
                  - 'null'
                contract_term_billing_cycle_on_renewal:
                  description: Indicates if the contract term billing cycle is applied
                    on renewal.
                  type:
                  - integer
                  - 'null'
                override_relationship:
                  description: Indicates if the existing relationship is overridden
                    by this subscription.
                  type:
                  - boolean
                  - 'null'
                pause_date:
                  description: The date on which the subscription was paused.
                  type:
                  - integer
                  - 'null'
                resume_date:
                  description: The date on which the subscription was resumed.
                  type:
                  - integer
                  - 'null'
                cancelled_at:
                  description: The date and time when the subscription was cancelled.
                  type:
                  - integer
                  - 'null'
                cancel_reason:
                  description: The reason for the cancellation of the subscription.
                  type:
                  - string
                  - 'null'
                created_from_ip:
                  description: The IP address from which the subscription was created.
                  type:
                  - string
                  - 'null'
                resource_version:
                  description: The version of the resource (subscription).
                  type:
                  - integer
                  - 'null'
                updated_at:
                  description: The date and time when the subscription was last updated.
                  type:
                  - integer
                  - 'null'
                has_scheduled_advance_invoices:
                  description: Indicates if there are scheduled advance invoices for
                    the subscription.
                  type:
                  - boolean
                  - 'null'
                has_scheduled_changes:
                  description: Indicates if there are scheduled changes for the subscription.
                  type:
                  - boolean
                  - 'null'
                payment_source_id:
                  description: The ID of the payment source used for the subscription.
                  type:
                  - string
                  - 'null'
                plan_free_quantity_in_decimal:
                  description: The free quantity included in the plan in decimal format.
                  type:
                  - string
                  - 'null'
                plan_amount_in_decimal:
                  description: The total amount charged for the plan in decimal format.
                  type:
                  - string
                  - 'null'
                cancel_schedule_created_at:
                  description: The date and time when the cancellation schedule was
                    created.
                  type:
                  - integer
                  - 'null'
                due_invoices_count:
                  description: The count of due invoices for the subscription.
                  type:
                  - integer
                  - 'null'
                due_since:
                  description: The date since which the invoices are due.
                  type:
                  - integer
                  - 'null'
                total_dues:
                  description: The total amount of dues for the subscription.
                  type:
                  - integer
                  - 'null'
                mrr:
                  description: The monthly recurring revenue generated by the subscription.
                  type:
                  - integer
                  - 'null'
                exchange_rate:
                  description: The exchange rate used for currency conversion.
                  type:
                  - number
                  - 'null'
                base_currency_code:
                  description: The base currency code used for the subscription.
                  type:
                  - string
                  - 'null'
                invoice_notes:
                  description: Any notes added to the invoices of the subscription.
                  type:
                  - string
                  - 'null'
                metadata:
                  description: Additional metadata associated with subscription
                  type:
                  - object
                  - 'null'
                  properties: {}
                deleted:
                  description: Indicates if the subscription has been deleted.
                  type:
                  - boolean
                  - 'null'
                object:
                  description: The type of object (subscription).
                  type:
                  - string
                  - 'null'
                coupon:
                  description: The coupon applied to the subscription.
                  type:
                  - string
                  - 'null'
                cancel_reason_code:
                  description: The code associated with the cancellation reason.
                  type:
                  - string
                  - 'null'
                free_period:
                  description: The duration of the free period for the subscription.
                  type:
                  - integer
                  - 'null'
                free_period_unit:
                  description: The unit of the free period duration.
                  type:
                  - string
                  - 'null'
                create_pending_invoices:
                  description: Indicates if pending invoices are created.
                  type:
                  - boolean
                  - 'null'
                auto_close_invoices:
                  description: Defines if the invoices are automatically closed or
                    not.
                  type:
                  - boolean
                  - 'null'
                business_entity_id:
                  description: The ID of the business entity to which the subscription
                    belongs.
                  type:
                  - string
                  - 'null'
                channel:
                  description: The channel through which the subscription was acquired.
                  type:
                  - string
                  - 'null'
                coupons:
                  description: Details of applied coupons
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      coupon_id:
                        description: The ID of the applied coupon.
                        type: string
                      apply_till:
                        description: The date until which the coupon can be applied.
                        type:
                        - integer
                        - 'null'
                      apply_count:
                        description: The count of times the coupon can be applied.
                        type:
                        - integer
                        - 'null'
                      coupon_code:
                        description: The code of the applied coupon.
                        type:
                        - string
                        - 'null'
                      applied_count:
                        description: The count of times the coupon has been applied.
                        type:
                        - integer
                        - 'null'
                      object:
                        description: The type of object (coupon).
                        type:
                        - string
                        - 'null'
                shipping_address:
                  description: Stores the shipping address related to the subscription
                  type:
                  - object
                  - 'null'
                  properties:
                    first_name:
                      description: The first name in the shipping address.
                      type:
                      - string
                      - 'null'
                    last_name:
                      description: The last name in the shipping address.
                      type:
                      - string
                      - 'null'
                    email:
                      description: The email address in the shipping address.
                      type:
                      - string
                      - 'null'
                    company:
                      description: The company name in the shipping address.
                      type:
                      - string
                      - 'null'
                    phone:
                      description: The phone number in the shipping address.
                      type:
                      - string
                      - 'null'
                    line1:
                      description: The first line of the shipping address.
                      type:
                      - string
                      - 'null'
                    line2:
                      description: The second line of the shipping address.
                      type:
                      - string
                      - 'null'
                    line3:
                      description: The third line of the shipping address.
                      type:
                      - string
                      - 'null'
                    city:
                      description: The city in the shipping address.
                      type:
                      - string
                      - 'null'
                    state_code:
                      description: The state code in the shipping address.
                      type:
                      - string
                      - 'null'
                    state:
                      description: The state in the shipping address.
                      type:
                      - string
                      - 'null'
                    country:
                      description: The country in the shipping address.
                      type:
                      - string
                      - 'null'
                    zip:
                      description: The ZIP or postal code in the shipping address.
                      type:
                      - string
                      - 'null'
                    validation_status:
                      description: The validation status of the shipping address.
                      type:
                      - string
                      - 'null'
                referral_info:
                  description: Contains details related to any referral information
                    associated with the subscription
                  type:
                  - object
                  - 'null'
                  properties:
                    referral_code:
                      description: The code associated with the referral.
                      type:
                      - string
                      - 'null'
                    coupon_code:
                      description: The coupon code used for the referral.
                      type:
                      - string
                      - 'null'
                    referral_id:
                      description: The unique identifier of the referral.
                      type:
                      - string
                      - 'null'
                    external_reference_id:
                      description: The external reference identifier of the referral.
                      type:
                      - string
                      - 'null'
                    reward_status:
                      description: The status of the reward for the referral.
                      type:
                      - string
                      - 'null'
                    referral_system:
                      description: The system handling the referrals.
                      type:
                      - string
                      - 'null'
                    account_id:
                      description: The account identifier of the referral.
                      type:
                      - string
                      - 'null'
                    campaign_id:
                      description: The campaign identifier of the referral.
                      type:
                      - string
                      - 'null'
                    external_campaign_id:
                      description: The external campaign identifier of the referral.
                      type:
                      - string
                      - 'null'
                    friend_offer_type:
                      description: The type of offer for a friend in the referral
                        program.
                      type:
                      - string
                      - 'null'
                    referrer_reward_type:
                      description: The type of reward for the referrer in the referral
                        program.
                      type:
                      - string
                      - 'null'
                    notify_referral_system:
                      description: Whether to notify the referral system.
                      type:
                      - string
                      - 'null'
                    destination_url:
                      description: The URL to which the referral leads.
                      type:
                      - string
                      - 'null'
                    post_purchase_widget_enabled:
                      description: Whether the post-purchase widget is enabled for
                        the referral.
                      type:
                      - boolean
                      - 'null'
                contract_term:
                  description: Contains details about the contract term of the subscription
                  type:
                  - object
                  - 'null'
                  properties:
                    id:
                      description: The unique identifier of the contract term.
                      type:
                      - string
                      - 'null'
                    status:
                      description: The status of the contract term.
                      type:
                      - string
                      - 'null'
                    contract_start:
                      description: The start date of the contract.
                      type:
                      - integer
                      - 'null'
                    contract_end:
                      description: The end date of the contract.
                      type:
                      - integer
                      - 'null'
                    billing_cycle:
                      description: The billing cycle duration of the contract.
                      type:
                      - integer
                      - 'null'
                    action_at_term_end:
                      description: The action to be taken at the end of the contract
                        term.
                      type:
                      - string
                      - 'null'
                    total_contract_value:
                      description: The total value of the contract.
                      type:
                      - integer
                      - 'null'
                    cancellation_cutoff_period:
                      description: The period within which cancellation is allowed
                        before the next term.
                      type:
                      - integer
                      - 'null'
                    created_at:
                      description: The timestamp when the contract term was created.
                      type:
                      - integer
                      - 'null'
                    subscription_id:
                      description: The identifier of the subscription associated with
                        the contract term.
                      type:
                      - string
                      - 'null'
                    remaining_billing_cycles:
                      description: The remaining billing cycles for the contract term.
                      type:
                      - integer
                      - 'null'
                subscription_items:
                  description: Lists individual items included in the subscription
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      item_price_id:
                        description: The unique identifier of the item price associated
                          with the subscription item.
                        type:
                        - string
                        - 'null'
                      item_type:
                        description: The type of the subscription item.
                        type:
                        - string
                        - 'null'
                      quantity:
                        description: The quantity of the subscription item.
                        type:
                        - integer
                        - 'null'
                      quantity_in_decimal:
                        description: The quantity in decimal format for the subscription
                          item.
                        type:
                        - string
                        - 'null'
                      unit_price:
                        description: The unit price of the subscription item.
                        type:
                        - integer
                        - 'null'
                      unit_price_in_decimal:
                        description: The unit price in decimal format for the subscription
                          item.
                        type:
                        - string
                        - 'null'
                      amount:
                        description: The amount charged for the subscription item.
                        type:
                        - integer
                        - 'null'
                      amount_in_decimal:
                        description: The amount in decimal format for the subscription
                          item.
                        type:
                        - string
                        - 'null'
                      free_quantity:
                        description: The free quantity included with the subscription
                          item.
                        type:
                        - integer
                        - 'null'
                      free_quantity_in_decimal:
                        description: The free quantity in decimal format for the subscription
                          item.
                        type:
                        - string
                        - 'null'
                      trial_end:
                        description: The end date of the trial period for the subscription
                          item.
                        type:
                        - integer
                        - 'null'
                      billing_cycles:
                        description: The number of billing cycles for the subscription
                          item.
                        type:
                        - integer
                        - 'null'
                      service_period_days:
                        description: The number of days in the service period.
                        type:
                        - integer
                        - 'null'
                      charge_on_event:
                        description: The event triggering the charge for the subscription
                          item.
                        type:
                        - string
                        - 'null'
                      charge_once:
                        description: Whether the subscription item is charged only
                          once.
                        type:
                        - boolean
                        - 'null'
                      charge_on_option:
                        description: The charge option for the subscription item.
                        type:
                        - string
                        - 'null'
                      object:
                        description: The type of the subscription item.
                        type:
                        - string
                        - 'null'
                item_tiers:
                  description: Provides information about tiers or levels for specific
                    subscription items
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      item_price_id:
                        description: The identifier of the item price associated with
                          the tier.
                        type:
                        - string
                        - 'null'
                      starting_unit:
                        description: The starting unit of the tier.
                        type:
                        - integer
                        - 'null'
                      ending_unit:
                        description: The ending unit of the tier.
                        type:
                        - integer
                        - 'null'
                      price:
                        description: The price of the tier.
                        type:
                        - integer
                        - 'null'
                      starting_unit_in_decimal:
                        description: The starting unit in decimal format for the tier.
                        type:
                        - string
                        - 'null'
                      ending_unit_in_decimal:
                        description: The ending unit in decimal format for the tier.
                        type:
                        - string
                        - 'null'
                      price_in_decimal:
                        description: The price in decimal format for the tier.
                        type:
                        - string
                        - 'null'
                      object:
                        description: The type of the item tier.
                        type:
                        - string
                        - 'null'
                charged_items:
                  description: Lists the items that have been charged as part of the
                    subscription
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      item_price_id:
                        description: The identifier of the item price charged.
                        type:
                        - string
                        - 'null'
                      last_charged_at:
                        description: The timestamp of the last charge for the item.
                        type:
                        - integer
                        - 'null'
                      object:
                        description: The type of the charged item.
                        type:
                        - string
                        - 'null'
                plan_id:
                  description: The ID of the plan associated with the subscription.
                  type:
                  - string
                  - 'null'
                plan_quantity:
                  description: The quantity of the plan included in the subscription.
                  type:
                  - integer
                  - 'null'
                plan_unit_price:
                  description: The unit price of the plan for the subscription.
                  type:
                  - integer
                  - 'null'
                setup_fee:
                  description: The setup fee charged for the subscription.
                  type:
                  - integer
                  - 'null'
                billing_period:
                  description: The billing period duration for the subscription.
                  type:
                  - integer
                  - 'null'
                billing_period_unit:
                  description: The unit of the billing period.
                  type:
                  - string
                  - 'null'
                auto_collection:
                  description: Indicates if auto-collection is enabled for the subscription.
                  type:
                  - string
                  - 'null'
                plan_amount:
                  description: The total amount charged for the plan of the subscription.
                  type:
                  - integer
                  - 'null'
                plan_free_quantity:
                  description: The free quantity included in the plan of the subscription.
                  type:
                  - integer
                  - 'null'
                gift_id:
                  description: The ID of the gift associated with the subscription.
                  type:
                  - string
                  - 'null'
                affiliate_token:
                  description: The affiliate token associated with the subscription.
                  type:
                  - string
                  - 'null'
                offline_payment_method:
                  description: The offline payment method used for the subscription.
                  type:
                  - string
                  - 'null'
                meta_data:
                  description: Additional metadata associated with subscription
                  type:
                  - object
                  - 'null'
                  properties: {}
                addons:
                  description: Represents any additional features or services added
                    to the subscription
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: The unique identifier of the addon.
                        type:
                        - string
                        - 'null'
                      quantity:
                        description: The quantity of the addon.
                        type:
                        - integer
                        - 'null'
                      unit_price:
                        description: The unit price of the addon.
                        type:
                        - integer
                        - 'null'
                      amount:
                        description: The amount charged for the addon.
                        type:
                        - integer
                        - 'null'
                      trial_end:
                        description: The end date of the trial period for the addon.
                        type:
                        - integer
                        - 'null'
                      remaining_billing_cycles:
                        description: The remaining billing cycles for the addon.
                        type:
                        - integer
                        - 'null'
                      quantity_in_decimal:
                        description: The quantity in decimal format for the addon.
                        type:
                        - string
                        - 'null'
                      unit_price_in_decimal:
                        description: The unit price in decimal format for the addon.
                        type:
                        - string
                        - 'null'
                      amount_in_decimal:
                        description: The amount in decimal format for the addon.
                        type:
                        - string
                        - 'null'
                event_based_addons:
                  description: Specifies any event-based addons associated with the
                    subscription
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: The unique identifier of the event-based addon.
                        type:
                        - string
                        - 'null'
                      quantity:
                        description: The quantity of the addon.
                        type:
                        - integer
                        - 'null'
                      unit_price:
                        description: The unit price of the addon.
                        type:
                        - integer
                        - 'null'
                      on_event:
                        description: The event triggering the addon charge.
                        type:
                        - string
                        - 'null'
                      charge_once:
                        description: Whether the addon is charged only once.
                        type:
                        - boolean
                        - 'null'
                      quantity_in_decimal:
                        description: The quantity in decimal format for the addon.
                        type:
                        - string
                        - 'null'
                      unit_price_in_decimal:
                        description: The unit price in decimal format for the addon.
                        type:
                        - string
                        - 'null'
                charged_event_based_addons:
                  description: Details of addons charged based on events
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: The ID of the charged event-based addon.
                        type:
                        - string
                        - 'null'
                      last_charged_at:
                        description: The date and time of the last charge for the
                          addon.
                        type:
                        - integer
                        - 'null'
                discounts:
                  description: Includes any discounts applied to the subscription
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        description: The unique identifier of the discount.
                        type:
                        - string
                        - 'null'
                      invoice_name:
                        description: The name of the discount on the invoice.
                        type:
                        - string
                        - 'null'
                      type:
                        description: The type of the discount.
                        type:
                        - string
                        - 'null'
                      percentage:
                        description: The percentage value of the discount.
                        type:
                        - number
                        - 'null'
                      amount:
                        description: The amount of discount applied.
                        type:
                        - integer
                        - 'null'
                      currency_code:
                        description: The currency code of the discount.
                        type:
                        - string
                        - 'null'
                      duration_type:
                        description: The duration type of the discount (e.g., forever,
                          once).
                        type:
                        - string
                        - 'null'
                      period:
                        description: The period for which the discount is applicable.
                        type:
                        - integer
                        - 'null'
                      period_unit:
                        description: The unit of the period (e.g., days, months).
                        type:
                        - string
                        - 'null'
                      included_in_mrr:
                        description: Whether the discount is included in Monthly Recurring
                          Revenue (MRR) calculation.
                        type:
                        - boolean
                        - 'null'
                      apply_on:
                        description: The item to which the discount is applied.
                        type:
                        - string
                        - 'null'
                      item_price_id:
                        description: The identifier of the item price associated with
                          the discount.
                        type:
                        - string
                        - 'null'
                      created_at:
                        description: The timestamp when the discount was created.
                        type:
                        - integer
                        - 'null'
                      apply_till:
                        description: The expiry date until which the discount is applicable.
                        type:
                        - integer
                        - 'null'
                      applied_count:
                        description: The number of times the discount has been applied.
                        type:
                        - integer
                        - 'null'
                      coupon_id:
                        description: The identifier of the coupon used for the discount.
                        type:
                        - string
                        - 'null'
                      index:
                        description: The index of the discount.
                        type:
                        - integer
                        - 'null'
                custom_fields: _definitions.json#/definitions/custom_fields
          type: DeclarativeStream
          name: "subscription"
          primary_key: "id"
        parent_key: "id"
        partition_field: "subscription_id"
        type: ParentStreamConfig
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Subscription
      type: object
      properties:
        id:
          description: The unique ID of the subscription.
          type:
          - string
          - 'null'
        currency_code:
          description: The currency code used for the subscription.
          type:
          - string
          - 'null'
        start_date:
          description: The start date of the subscription.
          type:
          - integer
          - 'null'
        trial_end:
          description: The end date of the trial period for the subscription.
          type:
          - integer
          - 'null'
        remaining_billing_cycles:
          description: The count of remaining billing cycles for the subscription.
          type:
          - integer
          - 'null'
        po_number:
          description: The purchase order number associated with the subscription.
          type:
          - string
          - 'null'
        plan_quantity_in_decimal:
          description: The quantity of the plan in decimal format.
          type:
          - string
          - 'null'
        plan_unit_price_in_decimal:
          description: The unit price of the plan in decimal format.
          type:
          - string
          - 'null'
        customer_id:
          description: The ID of the customer associated with the subscription.
          type:
          - string
          - 'null'
        status:
          description: The current status of the subscription.
          type:
          - string
          - 'null'
        trial_start:
          description: The start date of the trial period for the subscription.
          type:
          - integer
          - 'null'
        trial_end_action:
          description: The action to be taken at the end of the trial period.
          type:
          - string
          - 'null'
        current_term_start:
          description: The start date of the current term for the subscription.
          type:
          - integer
          - 'null'
        current_term_end:
          description: The end date of the current term for the subscription.
          type:
          - integer
          - 'null'
        next_billing_at:
          description: The date and time of the next billing event for the subscription.
          type:
          - integer
          - 'null'
        created_at:
          description: The date and time of the creation of the subscription.
          type:
          - integer
          - 'null'
        started_at:
          description: The date and time when the subscription started.
          type:
          - integer
          - 'null'
        activated_at:
          description: The date and time when the subscription was activated.
          type:
          - integer
          - 'null'
        contract_term_billing_cycle_on_renewal:
          description: Indicates if the contract term billing cycle is applied on
            renewal.
          type:
          - integer
          - 'null'
        override_relationship:
          description: Indicates if the existing relationship is overridden by this
            subscription.
          type:
          - boolean
          - 'null'
        pause_date:
          description: The date on which the subscription was paused.
          type:
          - integer
          - 'null'
        resume_date:
          description: The date on which the subscription was resumed.
          type:
          - integer
          - 'null'
        cancelled_at:
          description: The date and time when the subscription was cancelled.
          type:
          - integer
          - 'null'
        cancel_reason:
          description: The reason for the cancellation of the subscription.
          type:
          - string
          - 'null'
        created_from_ip:
          description: The IP address from which the subscription was created.
          type:
          - string
          - 'null'
        resource_version:
          description: The version of the resource (subscription).
          type:
          - integer
          - 'null'
        updated_at:
          description: The date and time when the subscription was last updated.
          type:
          - integer
          - 'null'
        has_scheduled_advance_invoices:
          description: Indicates if there are scheduled advance invoices for the subscription.
          type:
          - boolean
          - 'null'
        has_scheduled_changes:
          description: Indicates if there are scheduled changes for the subscription.
          type:
          - boolean
          - 'null'
        payment_source_id:
          description: The ID of the payment source used for the subscription.
          type:
          - string
          - 'null'
        plan_free_quantity_in_decimal:
          description: The free quantity included in the plan in decimal format.
          type:
          - string
          - 'null'
        plan_amount_in_decimal:
          description: The total amount charged for the plan in decimal format.
          type:
          - string
          - 'null'
        cancel_schedule_created_at:
          description: The date and time when the cancellation schedule was created.
          type:
          - integer
          - 'null'
        due_invoices_count:
          description: The count of due invoices for the subscription.
          type:
          - integer
          - 'null'
        due_since:
          description: The date since which the invoices are due.
          type:
          - integer
          - 'null'
        total_dues:
          description: The total amount of dues for the subscription.
          type:
          - integer
          - 'null'
        mrr:
          description: The monthly recurring revenue generated by the subscription.
          type:
          - integer
          - 'null'
        exchange_rate:
          description: The exchange rate used for currency conversion.
          type:
          - number
          - 'null'
        base_currency_code:
          description: The base currency code used for the subscription.
          type:
          - string
          - 'null'
        invoice_notes:
          description: Any notes added to the invoices of the subscription.
          type:
          - string
          - 'null'
        metadata:
          description: Additional metadata associated with subscription
          type:
          - object
          - 'null'
          properties: {}
        deleted:
          description: Indicates if the subscription has been deleted.
          type:
          - boolean
          - 'null'
        object:
          description: The type of object (subscription).
          type:
          - string
          - 'null'
        coupon:
          description: The coupon applied to the subscription.
          type:
          - string
          - 'null'
        cancel_reason_code:
          description: The code associated with the cancellation reason.
          type:
          - string
          - 'null'
        free_period:
          description: The duration of the free period for the subscription.
          type:
          - integer
          - 'null'
        free_period_unit:
          description: The unit of the free period duration.
          type:
          - string
          - 'null'
        create_pending_invoices:
          description: Indicates if pending invoices are created.
          type:
          - boolean
          - 'null'
        auto_close_invoices:
          description: Defines if the invoices are automatically closed or not.
          type:
          - boolean
          - 'null'
        business_entity_id:
          description: The ID of the business entity to which the subscription belongs.
          type:
          - string
          - 'null'
        channel:
          description: The channel through which the subscription was acquired.
          type:
          - string
          - 'null'
        coupons:
          description: Details of applied coupons
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              coupon_id:
                description: The ID of the applied coupon.
                type: string
              apply_till:
                description: The date until which the coupon can be applied.
                type:
                - integer
                - 'null'
              apply_count:
                description: The count of times the coupon can be applied.
                type:
                - integer
                - 'null'
              coupon_code:
                description: The code of the applied coupon.
                type:
                - string
                - 'null'
              applied_count:
                description: The count of times the coupon has been applied.
                type:
                - integer
                - 'null'
              object:
                description: The type of object (coupon).
                type:
                - string
                - 'null'
        shipping_address:
          description: Stores the shipping address related to the subscription
          type:
          - object
          - 'null'
          properties:
            first_name:
              description: The first name in the shipping address.
              type:
              - string
              - 'null'
            last_name:
              description: The last name in the shipping address.
              type:
              - string
              - 'null'
            email:
              description: The email address in the shipping address.
              type:
              - string
              - 'null'
            company:
              description: The company name in the shipping address.
              type:
              - string
              - 'null'
            phone:
              description: The phone number in the shipping address.
              type:
              - string
              - 'null'
            line1:
              description: The first line of the shipping address.
              type:
              - string
              - 'null'
            line2:
              description: The second line of the shipping address.
              type:
              - string
              - 'null'
            line3:
              description: The third line of the shipping address.
              type:
              - string
              - 'null'
            city:
              description: The city in the shipping address.
              type:
              - string
              - 'null'
            state_code:
              description: The state code in the shipping address.
              type:
              - string
              - 'null'
            state:
              description: The state in the shipping address.
              type:
              - string
              - 'null'
            country:
              description: The country in the shipping address.
              type:
              - string
              - 'null'
            zip:
              description: The ZIP or postal code in the shipping address.
              type:
              - string
              - 'null'
            validation_status:
              description: The validation status of the shipping address.
              type:
              - string
              - 'null'
        referral_info:
          description: Contains details related to any referral information associated
            with the subscription
          type:
          - object
          - 'null'
          properties:
            referral_code:
              description: The code associated with the referral.
              type:
              - string
              - 'null'
            coupon_code:
              description: The coupon code used for the referral.
              type:
              - string
              - 'null'
            referral_id:
              description: The unique identifier of the referral.
              type:
              - string
              - 'null'
            external_reference_id:
              description: The external reference identifier of the referral.
              type:
              - string
              - 'null'
            reward_status:
              description: The status of the reward for the referral.
              type:
              - string
              - 'null'
            referral_system:
              description: The system handling the referrals.
              type:
              - string
              - 'null'
            account_id:
              description: The account identifier of the referral.
              type:
              - string
              - 'null'
            campaign_id:
              description: The campaign identifier of the referral.
              type:
              - string
              - 'null'
            external_campaign_id:
              description: The external campaign identifier of the referral.
              type:
              - string
              - 'null'
            friend_offer_type:
              description: The type of offer for a friend in the referral program.
              type:
              - string
              - 'null'
            referrer_reward_type:
              description: The type of reward for the referrer in the referral program.
              type:
              - string
              - 'null'
            notify_referral_system:
              description: Whether to notify the referral system.
              type:
              - string
              - 'null'
            destination_url:
              description: The URL to which the referral leads.
              type:
              - string
              - 'null'
            post_purchase_widget_enabled:
              description: Whether the post-purchase widget is enabled for the referral.
              type:
              - boolean
              - 'null'
        contract_term:
          description: Contains details about the contract term of the subscription
          type:
          - object
          - 'null'
          properties:
            id:
              description: The unique identifier of the contract term.
              type:
              - string
              - 'null'
            status:
              description: The status of the contract term.
              type:
              - string
              - 'null'
            contract_start:
              description: The start date of the contract.
              type:
              - integer
              - 'null'
            contract_end:
              description: The end date of the contract.
              type:
              - integer
              - 'null'
            billing_cycle:
              description: The billing cycle duration of the contract.
              type:
              - integer
              - 'null'
            action_at_term_end:
              description: The action to be taken at the end of the contract term.
              type:
              - string
              - 'null'
            total_contract_value:
              description: The total value of the contract.
              type:
              - integer
              - 'null'
            cancellation_cutoff_period:
              description: The period within which cancellation is allowed before
                the next term.
              type:
              - integer
              - 'null'
            created_at:
              description: The timestamp when the contract term was created.
              type:
              - integer
              - 'null'
            subscription_id:
              description: The identifier of the subscription associated with the
                contract term.
              type:
              - string
              - 'null'
            remaining_billing_cycles:
              description: The remaining billing cycles for the contract term.
              type:
              - integer
              - 'null'
        subscription_items:
          description: Lists individual items included in the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_price_id:
                description: The unique identifier of the item price associated with
                  the subscription item.
                type:
                - string
                - 'null'
              item_type:
                description: The type of the subscription item.
                type:
                - string
                - 'null'
              quantity:
                description: The quantity of the subscription item.
                type:
                - integer
                - 'null'
              quantity_in_decimal:
                description: The quantity in decimal format for the subscription item.
                type:
                - string
                - 'null'
              unit_price:
                description: The unit price of the subscription item.
                type:
                - integer
                - 'null'
              unit_price_in_decimal:
                description: The unit price in decimal format for the subscription
                  item.
                type:
                - string
                - 'null'
              amount:
                description: The amount charged for the subscription item.
                type:
                - integer
                - 'null'
              amount_in_decimal:
                description: The amount in decimal format for the subscription item.
                type:
                - string
                - 'null'
              free_quantity:
                description: The free quantity included with the subscription item.
                type:
                - integer
                - 'null'
              free_quantity_in_decimal:
                description: The free quantity in decimal format for the subscription
                  item.
                type:
                - string
                - 'null'
              trial_end:
                description: The end date of the trial period for the subscription
                  item.
                type:
                - integer
                - 'null'
              billing_cycles:
                description: The number of billing cycles for the subscription item.
                type:
                - integer
                - 'null'
              service_period_days:
                description: The number of days in the service period.
                type:
                - integer
                - 'null'
              charge_on_event:
                description: The event triggering the charge for the subscription
                  item.
                type:
                - string
                - 'null'
              charge_once:
                description: Whether the subscription item is charged only once.
                type:
                - boolean
                - 'null'
              charge_on_option:
                description: The charge option for the subscription item.
                type:
                - string
                - 'null'
              object:
                description: The type of the subscription item.
                type:
                - string
                - 'null'
        item_tiers:
          description: Provides information about tiers or levels for specific subscription
            items
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_price_id:
                description: The identifier of the item price associated with the
                  tier.
                type:
                - string
                - 'null'
              starting_unit:
                description: The starting unit of the tier.
                type:
                - integer
                - 'null'
              ending_unit:
                description: The ending unit of the tier.
                type:
                - integer
                - 'null'
              price:
                description: The price of the tier.
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                description: The starting unit in decimal format for the tier.
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                description: The ending unit in decimal format for the tier.
                type:
                - string
                - 'null'
              price_in_decimal:
                description: The price in decimal format for the tier.
                type:
                - string
                - 'null'
              object:
                description: The type of the item tier.
                type:
                - string
                - 'null'
        charged_items:
          description: Lists the items that have been charged as part of the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              item_price_id:
                description: The identifier of the item price charged.
                type:
                - string
                - 'null'
              last_charged_at:
                description: The timestamp of the last charge for the item.
                type:
                - integer
                - 'null'
              object:
                description: The type of the charged item.
                type:
                - string
                - 'null'
        plan_id:
          description: The ID of the plan associated with the subscription.
          type:
          - string
          - 'null'
        plan_quantity:
          description: The quantity of the plan included in the subscription.
          type:
          - integer
          - 'null'
        plan_unit_price:
          description: The unit price of the plan for the subscription.
          type:
          - integer
          - 'null'
        setup_fee:
          description: The setup fee charged for the subscription.
          type:
          - integer
          - 'null'
        billing_period:
          description: The billing period duration for the subscription.
          type:
          - integer
          - 'null'
        billing_period_unit:
          description: The unit of the billing period.
          type:
          - string
          - 'null'
        auto_collection:
          description: Indicates if auto-collection is enabled for the subscription.
          type:
          - string
          - 'null'
        plan_amount:
          description: The total amount charged for the plan of the subscription.
          type:
          - integer
          - 'null'
        plan_free_quantity:
          description: The free quantity included in the plan of the subscription.
          type:
          - integer
          - 'null'
        gift_id:
          description: The ID of the gift associated with the subscription.
          type:
          - string
          - 'null'
        affiliate_token:
          description: The affiliate token associated with the subscription.
          type:
          - string
          - 'null'
        offline_payment_method:
          description: The offline payment method used for the subscription.
          type:
          - string
          - 'null'
        meta_data:
          description: Additional metadata associated with subscription
          type:
          - object
          - 'null'
          properties: {}
        addons:
          description: Represents any additional features or services added to the
            subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the addon.
                type:
                - string
                - 'null'
              quantity:
                description: The quantity of the addon.
                type:
                - integer
                - 'null'
              unit_price:
                description: The unit price of the addon.
                type:
                - integer
                - 'null'
              amount:
                description: The amount charged for the addon.
                type:
                - integer
                - 'null'
              trial_end:
                description: The end date of the trial period for the addon.
                type:
                - integer
                - 'null'
              remaining_billing_cycles:
                description: The remaining billing cycles for the addon.
                type:
                - integer
                - 'null'
              quantity_in_decimal:
                description: The quantity in decimal format for the addon.
                type:
                - string
                - 'null'
              unit_price_in_decimal:
                description: The unit price in decimal format for the addon.
                type:
                - string
                - 'null'
              amount_in_decimal:
                description: The amount in decimal format for the addon.
                type:
                - string
                - 'null'
        event_based_addons:
          description: Specifies any event-based addons associated with the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the event-based addon.
                type:
                - string
                - 'null'
              quantity:
                description: The quantity of the addon.
                type:
                - integer
                - 'null'
              unit_price:
                description: The unit price of the addon.
                type:
                - integer
                - 'null'
              on_event:
                description: The event triggering the addon charge.
                type:
                - string
                - 'null'
              charge_once:
                description: Whether the addon is charged only once.
                type:
                - boolean
                - 'null'
              quantity_in_decimal:
                description: The quantity in decimal format for the addon.
                type:
                - string
                - 'null'
              unit_price_in_decimal:
                description: The unit price in decimal format for the addon.
                type:
                - string
                - 'null'
        charged_event_based_addons:
          description: Details of addons charged based on events
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The ID of the charged event-based addon.
                type:
                - string
                - 'null'
              last_charged_at:
                description: The date and time of the last charge for the addon.
                type:
                - integer
                - 'null'
        discounts:
          description: Includes any discounts applied to the subscription
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: The unique identifier of the discount.
                type:
                - string
                - 'null'
              invoice_name:
                description: The name of the discount on the invoice.
                type:
                - string
                - 'null'
              type:
                description: The type of the discount.
                type:
                - string
                - 'null'
              percentage:
                description: The percentage value of the discount.
                type:
                - number
                - 'null'
              amount:
                description: The amount of discount applied.
                type:
                - integer
                - 'null'
              currency_code:
                description: The currency code of the discount.
                type:
                - string
                - 'null'
              duration_type:
                description: The duration type of the discount (e.g., forever, once).
                type:
                - string
                - 'null'
              period:
                description: The period for which the discount is applicable.
                type:
                - integer
                - 'null'
              period_unit:
                description: The unit of the period (e.g., days, months).
                type:
                - string
                - 'null'
              included_in_mrr:
                description: Whether the discount is included in Monthly Recurring
                  Revenue (MRR) calculation.
                type:
                - boolean
                - 'null'
              apply_on:
                description: The item to which the discount is applied.
                type:
                - string
                - 'null'
              item_price_id:
                description: The identifier of the item price associated with the
                  discount.
                type:
                - string
                - 'null'
              created_at:
                description: The timestamp when the discount was created.
                type:
                - integer
                - 'null'
              apply_till:
                description: The expiry date until which the discount is applicable.
                type:
                - integer
                - 'null'
              applied_count:
                description: The number of times the discount has been applied.
                type:
                - integer
                - 'null'
              coupon_id:
                description: The identifier of the coupon used for the discount.
                type:
                - string
                - 'null'
              index:
                description: The index of the discount.
                type:
                - integer
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "subscription_with_scheduled_changes"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/transactions"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Transaction
      type: object
      properties:
        id:
          description: Unique identifier of the transaction.
          type:
          - string
          - 'null'
        customer_id:
          description: The ID of the customer associated with the transaction.
          type:
          - string
          - 'null'
        subscription_id:
          description: ID of the subscription related to the transaction.
          type:
          - string
          - 'null'
        gateway_account_id:
          description: ID of the gateway account used in the transaction.
          type:
          - string
          - 'null'
        payment_source_id:
          description: ID of the payment source used in the transaction.
          type:
          - string
          - 'null'
        payment_method:
          description: Payment method used in the transaction.
          type:
          - string
          - 'null'
        refrence_number:
          description: Reference number of the transaction.
          type:
          - string
          - 'null'
        gateway:
          description: The payment gateway used in the transaction.
          type:
          - string
          - 'null'
        type:
          description: Type of the transaction.
          type:
          - string
          - 'null'
        date:
          description: Date of the transaction.
          type:
          - integer
          - 'null'
        settled_at:
          description: Date when the transaction was settled.
          type:
          - integer
          - 'null'
        exchange_rate:
          description: Exchange rate used in the transaction.
          type:
          - number
          - 'null'
        currency_code:
          description: The currency code of the transaction.
          type:
          - string
          - 'null'
        amount:
          description: The total amount of the transaction.
          type:
          - integer
          - 'null'
        id_at_gateway:
          description: Transaction ID assigned by the gateway.
          type:
          - string
          - 'null'
        status:
          description: Status of the transaction.
          type:
          - string
          - 'null'
        fraud_flag:
          description: Flag indicating if the transaction is flagged for fraud.
          type:
          - string
          - 'null'
        initiator_type:
          description: Type of initiator involved in the transaction.
          type:
          - string
          - 'null'
        three_d_secure:
          description: Flag indicating if 3D secure was used in the transaction.
          type:
          - boolean
          - 'null'
        authorization_reason:
          description: Reason for authorization of the transaction.
          type:
          - string
          - 'null'
        error_code:
          description: Error code associated with the transaction.
          type:
          - string
          - 'null'
        voided_at:
          description: Date when the transaction was voided.
          type:
          - integer
          - 'null'
        resource_version:
          description: Resource version of the transaction.
          type:
          - integer
          - 'null'
        updated_at:
          description: Date when the transaction was last updated.
          type:
          - integer
          - 'null'
        fraud_reason:
          description: Reason for flagging the transaction as fraud.
          type:
          - string
          - 'null'
        amount_unused:
          description: The amount in the transaction that remains unused.
          type:
          - integer
          - 'null'
        masked_card_number:
          description: Masked card number used in the transaction.
          type:
          - string
          - 'null'
        reference_transaction_id:
          description: ID of the reference transaction.
          type:
          - string
          - 'null'
        refunded_txn_id:
          description: ID of the refunded transaction.
          type:
          - string
          - 'null'
        reference_authorization_id:
          description: Reference authorization ID of the transaction.
          type:
          - string
          - 'null'
        amount_capturable:
          description: The remaining amount that can be captured in the transaction.
          type:
          - integer
          - 'null'
        reversal_transaction_id:
          description: ID of the reversal transaction, if any.
          type:
          - string
          - 'null'
        deleted:
          description: Flag indicating if the transaction is deleted.
          type:
          - boolean
          - 'null'
        iin:
          description: Bank identification number of the transaction.
          type:
          - string
          - 'null'
        last4:
          description: Last 4 digits of the card used in the transaction.
          type:
          - string
          - 'null'
        merchant_reference_id:
          description: Merchant reference ID of the transaction.
          type:
          - string
          - 'null'
        base_currency_code:
          description: The base currency code of the transaction.
          type:
          - string
          - 'null'
        business_entity_id:
          description: The ID of the business entity related to the transaction.
          type:
          - string
          - 'null'
        object:
          description: Type of object representing the transaction.
          type:
          - string
          - 'null'
        error_text:
          description: Error message text of the transaction.
          type:
          - string
          - 'null'
        error_detail:
          description: Detailed error information related to the transaction.
          type:
          - string
          - 'null'
        payment_method_details:
          description: Details of the payment method used in the transaction.
          type:
          - string
          - 'null'
        reference_number:
          description: Reference number associated with the transaction.
          type:
          - string
          - 'null'
        linked_invoices:
          description: Linked invoices associated with the transaction.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              invoice_id:
                description: ID of the linked invoice.
                type:
                - string
                - 'null'
              applied_amount:
                description: Amount applied from the linked invoice.
                type:
                - integer
                - 'null'
              applied_at:
                description: Date when the invoice amount was applied.
                type:
                - integer
                - 'null'
              invoice_date:
                description: Date of the linked invoice.
                type:
                - integer
                - 'null'
              invoice_total:
                description: Total amount of the linked invoice.
                type:
                - integer
                - 'null'
              invoice_status:
                description: Status of the linked invoice.
                type:
                - string
                - 'null'
        linked_credit_notes:
          description: Linked credit notes associated with the transaction.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              cn_id:
                description: ID of the linked credit note.
                type:
                - string
                - 'null'
              applied_amount:
                description: Amount applied from the credit note.
                type:
                - integer
                - 'null'
              applied_at:
                description: Date when the credit note was applied.
                type:
                - integer
                - 'null'
              cn_reason_code:
                description: Reason code for the credit note.
                type:
                - string
                - 'null'
        cn_create_reason_code:
          description: Reason code for creating a credit note.
          type:
          - string
          - 'null'
        cn_date:
          description: Date of the credit note.
          type:
          - integer
          - 'null'
        cn_total:
          description: Total amount of the credit note.
          type:
          - integer
          - 'null'
        cn_status:
          description: Status of the credit note.
          type:
          - string
          - 'null'
        cn_reference_invoice_id:
          description: ID of the invoice referenced in the credit note.
          type:
          - string
          - 'null'
        linked_refunds:
          description: Linked refunds associated with the transaction.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              txn_id:
                description: ID of the refunded transaction.
                type:
                - string
                - 'null'
              txn_status:
                description: Status of the refunded transaction.
                type:
                - string
                - 'null'
        txn_date:
          description: Date of the transaction.
          type:
          - integer
          - 'null'
        txn_amount:
          description: Amount of the transaction.
          type:
          - integer
          - 'null'
        linked_payments:
          description: Linked payments associated with the transaction.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                description: ID of the linked payment.
                type:
                - string
                - 'null'
              status:
                description: Status of the linked payment.
                type:
                - string
                - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "transaction"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
      record_filter:
        condition: "{{ record['updated_at'] >= ( stream_state.get('prior_state', {}).get('updated_at',
          0) if stream_state else stream_slice.get('prior_state', {}).get('updated_at',
          0) ) }}"
        type: RecordFilter
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      path: "/unbilled_charges"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: CustomIncrementalSync
    class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
    cursor_field: "updated_at"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Unbilled Charge
      type: object
      properties:
        id:
          description: Unique ID of the unbilled charge
          type:
          - string
          - 'null'
        customer_id:
          description: ID of the customer associated with the unbilled charge
          type:
          - string
          - 'null'
        subscription_id:
          description: ID of the subscription associated with the charge
          type:
          - string
          - 'null'
        date_from:
          description: Start date of the charge period
          type:
          - integer
          - 'null'
        date_to:
          description: End date of the charge period
          type:
          - integer
          - 'null'
        unit_amount:
          description: Unit amount for each unit of the charge
          type:
          - integer
          - 'null'
        pricing_model:
          description: Pricing model used for the charge
          type:
          - string
          - 'null'
        quantity:
          description: Quantity of units for the charge
          type:
          - integer
          - 'null'
        amount:
          description: Total amount of the unbilled charge
          type:
          - integer
          - 'null'
        currency_code:
          description: Currency code of the amount
          type:
          - string
          - 'null'
        discount_amount:
          description: Amount of any discounts applied to the charge
          type:
          - integer
          - 'null'
        description:
          description: Description of the unbilled charge
          type:
          - string
          - 'null'
        entity_type:
          description: Type of entity related to the charge
          type:
          - string
          - 'null'
        entity_id:
          description: ID of the entity related to the charge
          type:
          - string
          - 'null'
        is_voided:
          description: Flag to indicate if the charge has been voided
          type:
          - boolean
          - 'null'
        voided_at:
          description: Timestamp of when the charge was voided
          type:
          - integer
          - 'null'
        unit_amount_in_decimal:
          description: Unit amount in decimal format for each unit of the charge
          type:
          - string
          - 'null'
        quantity_in_decimal:
          description: Quantity of units in decimal format for the charge
          type:
          - string
          - 'null'
        amount_in_decimal:
          description: Total amount in decimal format of the unbilled charge
          type:
          - string
          - 'null'
        updated_at:
          description: Timestamp of when the charge was last updated
          type:
          - integer
          - 'null'
        is_advance_charge:
          description: Flag to indicate if the charge is an advance charge
          type:
          - boolean
          - 'null'
        deleted:
          description: Flag to indicate if the charge has been deleted
          type:
          - boolean
          - 'null'
        tiers:
          description: Details about different tiers of unbilled charges
          type:
          - object
          - 'null'
          properties:
            starting_unit:
              description: Starting unit for the tier pricing
              type:
              - integer
              - 'null'
            ending_unit:
              description: Ending unit for the tier pricing
              type:
              - integer
              - 'null'
            quantity_used:
              description: Quantity of units used in the tier
              type:
              - integer
              - 'null'
            unit_amount:
              description: Unit amount for the tier pricing
              type:
              - integer
              - 'null'
            starting_unit_in_decimal:
              description: Starting unit in decimal format for the tier pricing
              type:
              - string
              - 'null'
            ending_unit_in_decimal:
              description: Ending unit in decimal format for the tier pricing
              type:
              - string
              - 'null'
            quantity_used_in_decimal:
              description: Quantity of units used in decimal format in the tier
              type:
              - string
              - 'null'
            unit_amount_in_decimal:
              description: Unit amount in decimal format for the tier pricing
              type:
              - string
              - 'null'
        object:
          description: Type of object representing the unbilled charge
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "unbilled_charge"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/virtual_bank_accounts"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Customer
      type: object
      properties:
        id:
          description: The unique identifier of the virtual bank account
          type:
          - string
          - 'null'
        customer_id:
          description: The unique identifier of the customer associated with the virtual
            bank account
          type:
          - string
          - 'null'
        email:
          description: The email address associated with the customer's virtual bank
            account
          type:
          - string
          - 'null'
        scheme:
          description: The scheme or type of the virtual bank account
          type:
          - string
          - 'null'
        bank_name:
          description: The name of the bank of the virtual bank account
          type:
          - string
          - 'null'
        account_number:
          description: The virtual bank account number associated with the customer
          type:
          - string
          - 'null'
        routing_number:
          description: The routing number associated with the virtual bank account
          type:
          - string
          - 'null'
        swift_code:
          description: The SWIFT code associated with the virtual bank account
          type:
          - string
          - 'null'
        gateway:
          description: The payment gateway used for processing transactions with this
            virtual bank account
          type:
          - string
          - 'null'
        resource_version:
          description: The version of the virtual bank account resource
          type:
          - integer
          - 'null'
        updated_at:
          description: The date and time when the virtual bank account was last updated
          type:
          - integer
          - 'null'
        created_at:
          description: The date and time when the virtual bank account was created
          type:
          - integer
          - 'null'
        reference_id:
          description: A reference identifier linked to the virtual bank account
          type:
          - string
          - 'null'
        deleted:
          description: Flag indicating if the virtual bank account has been deleted
          type:
          - boolean
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "virtual_bank_account"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: date
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/quotes"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Customer
      type: object
      properties:
        id:
          description: The unique identifier of the quote.
          type:
          - string
          - 'null'
        name:
          description: The name or title of the quote.
          type:
          - string
          - 'null'
        po_number:
          description: The purchase order number associated with the quote.
          type:
          - string
          - 'null'
        customer_id:
          description: The ID of the customer associated with the quote.
          type:
          - string
          - 'null'
        subscription_id:
          description: The ID of the subscription associated with the quote.
          type:
          - string
          - 'null'
        invoice_id:
          description: The ID of the invoice associated with the quote.
          type:
          - string
          - 'null'
        status:
          description: The status of the quote (e.g., draft, sent, accepted).
          type:
          - string
          - 'null'
        operation_type:
          description: The type of operation (e.g., new, modification) performed on
            the quote.
          type:
          - string
          - 'null'
        vat_number:
          description: The VAT number associated with the quote.
          type:
          - string
          - 'null'
        price_type:
          description: The type of pricing used for the quote (e.g., fixed, variable).
          type:
          - string
          - 'null'
        valid_till:
          description: The date until which the quote remains valid.
          type:
          - integer
          - 'null'
        date:
          description: The date when the quote was generated.
          type:
          - integer
          - 'null'
        total_payable:
          description: The total amount payable for the quote after all adjustments.
          type:
          - integer
          - 'null'
        charge_on_acceptance:
          description: Whether the charge is applicable on acceptance of the quote.
          type:
          - integer
          - 'null'
        sub_total:
          description: The subtotal amount before applying discounts or taxes.
          type:
          - integer
          - 'null'
        total:
          description: The total amount of the quote including all charges.
          type:
          - integer
          - 'null'
        credits_applied:
          description: The credits applied to the quote amount.
          type:
          - integer
          - 'null'
        amount_paid:
          description: The total amount that has been paid towards the quote.
          type:
          - integer
          - 'null'
        amount_due:
          description: The total amount that is due for payment in the quote.
          type:
          - integer
          - 'null'
        version:
          description: The version of the quote data.
          type:
          - integer
          - 'null'
        resource_version:
          description: The version of the resource related to the quote.
          type:
          - integer
          - 'null'
        updated_at:
          description: The last updated timestamp for the quote data.
          type:
          - integer
          - 'null'
        vat_number_prefix:
          description: The prefix used for the VAT number in the quote.
          type:
          - string
          - 'null'
        currency_code:
          description: The currency code used for all monetary values in the quote.
          type:
          - string
          - 'null'
        notes:
          description: Any additional notes or comments related to the quote.
          type:
          - array
          - 'null'
        contract_term_start:
          description: The start date of the contract terms for the quote.
          type:
          - integer
          - 'null'
        contract_term_end:
          description: The end date of the contract terms for the quote.
          type:
          - integer
          - 'null'
        contract_term_termination_fee:
          description: The fee applicable for terminating the contract terms.
          type:
          - integer
          - 'null'
        business_entity_id:
          description: The ID of the business entity related to the quote.
          type:
          - string
          - 'null'
        line_items:
          description: Individual line items included in the quote.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                type:
                - string
                - 'null'
              subscription_id:
                type:
                - string
                - 'null'
              date_from:
                type:
                - integer
                - 'null'
              date_to:
                type:
                - integer
                - 'null'
              unit_amount:
                type:
                - integer
                - 'null'
              quantity:
                type:
                - integer
                - 'null'
              amount:
                type:
                - integer
                - 'null'
              pricing_model:
                type:
                - string
                - 'null'
              is_taxed:
                type:
                - boolean
                - 'null'
              tax_amount:
                type:
                - integer
                - 'null'
              tax_rate:
                type:
                - number
                - 'null'
              unit_amount_in_decimal:
                type:
                - string
                - 'null'
              quantity_in_decimal:
                type:
                - string
                - 'null'
              amount_in_decimal:
                type:
                - string
                - 'null'
              discount_amount:
                type:
                - integer
                - 'null'
              item_level_discount_amount:
                type:
                - integer
                - 'null'
              reference_line_item_id:
                type:
                - string
                - 'null'
              description:
                type:
                - string
                - 'null'
              entity_description:
                type:
                - string
                - 'null'
              entity_type:
                type:
                - string
                - 'null'
              tax_exempt_reason:
                type:
                - string
                - 'null'
              entity_id:
                type:
                - string
                - 'null'
              customer_id:
                type:
                - string
                - 'null'
              metered:
                type:
                - boolean
                - 'null'
              object:
                type:
                - string
                - 'null'
        discounts:
          description: Discounts applied to the quote.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              amount:
                type:
                - integer
                - 'null'
              description:
                type:
                - string
                - 'null'
              line_item_id:
                type:
                - string
                - 'null'
              entity_type:
                type:
                - string
                - 'null'
              discount_type:
                type:
                - string
                - 'null'
              entity_id:
                type:
                - string
                - 'null'
              coupon_set_code:
                type:
                - string
                - 'null'
              object:
                type:
                - string
                - 'null'
        line_item_discounts:
          description: Discounts applied at the line item level.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                type:
                - string
                - 'null'
              discount_type:
                type:
                - string
                - 'null'
              entity_id:
                type:
                - string
                - 'null'
              discount_amount:
                type:
                - integer
                - 'null'
              object:
                type:
                - string
                - 'null'
        taxes:
          description: Taxes applied to the overall quote amount.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              name:
                type:
                - string
                - 'null'
              amount:
                type:
                - integer
                - 'null'
              description:
                type:
                - string
                - 'null'
        line_item_taxes:
          description: Taxes applied at the line item level.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                type:
                - string
                - 'null'
              tax_name:
                type:
                - string
                - 'null'
              tax_rate:
                type:
                - number
                - 'null'
              is_partial_tax_applied:
                type:
                - boolean
                - 'null'
              is_non_compliance_tax:
                type:
                - boolean
                - 'null'
              taxable_amount:
                type:
                - integer
                - 'null'
              tax_amount:
                type:
                - integer
                - 'null'
              tax_juris_type:
                type:
                - string
                - 'null'
              tax_juris_name:
                type:
                - string
                - 'null'
              tax_juris_code:
                type:
                - string
                - 'null'
              tax_amount_in_local_currency:
                type:
                - integer
                - 'null'
              local_currency_code:
                type:
                - string
                - 'null'
        line_item_tiers:
          description: Tiers related to line items in the quote.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                type:
                - string
                - 'null'
              starting_unit:
                type:
                - integer
                - 'null'
              ending_unit:
                type:
                - integer
                - 'null'
              quantity_used:
                type:
                - integer
                - 'null'
              unit_amount:
                type:
                - integer
                - 'null'
              starting_unit_in_decimal:
                type:
                - string
                - 'null'
              ending_unit_in_decimal:
                type:
                - string
                - 'null'
              quantity_used_in_decimal:
                type:
                - string
                - 'null'
              unit_amount_in_decimal:
                type:
                - string
                - 'null'
        shipping_address:
          description: The shipping address associated with the quote.
          type:
          - object
          - 'null'
          properties:
            first_name:
              type:
              - string
              - 'null'
            last_name:
              type:
              - string
              - 'null'
            email:
              type:
              - string
              - 'null'
            company:
              type:
              - string
              - 'null'
            phone:
              type:
              - string
              - 'null'
            line1:
              type:
              - string
              - 'null'
            line2:
              type:
              - string
              - 'null'
            line3:
              type:
              - string
              - 'null'
            city:
              type:
              - string
              - 'null'
            state_code:
              type:
              - string
              - 'null'
            state:
              type:
              - string
              - 'null'
            country:
              type:
              - string
              - 'null'
            zip:
              type:
              - string
              - 'null'
            validation_status:
              type:
              - string
              - 'null'
            index:
              type:
              - integer
              - 'null'
            object:
              type:
              - string
              - 'null'
        billing_address:
          description: The billing address associated with the quote.
          type:
          - object
          - 'null'
          properties:
            first_name:
              type:
              - string
              - 'null'
            last_name:
              type:
              - string
              - 'null'
            email:
              type:
              - string
              - 'null'
            company:
              type:
              - string
              - 'null'
            phone:
              type:
              - string
              - 'null'
            line1:
              type:
              - string
              - 'null'
            line2:
              type:
              - string
              - 'null'
            line3:
              type:
              - string
              - 'null'
            city:
              type:
              - string
              - 'null'
            state_code:
              type:
              - string
              - 'null'
            state:
              type:
              - string
              - 'null'
            country:
              type:
              - string
              - 'null'
            zip:
              type:
              - string
              - 'null'
            validation_status:
              type:
              - string
              - 'null'
            object:
              type:
              - string
              - 'null'
        object:
          description: The object type representing the quote.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "quote"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - http_codes:
            - 404
            action: IGNORE
            error_message: "Entity unavailable. Quote may have been deleted."
            type: HttpResponseFilter
      path: "/quotes/{{ stream_slice.id }}/quote_line_groups"
    partition_router:
      type: SubstreamPartitionRouter
      parent_stream_configs:
      - type: ParentStreamConfig
        stream:
          retriever:
            type: SimpleRetriever
            record_selector:
              type: RecordSelector
              extractor:
                type: DpathExtractor
                field_path:
                - "list"
                - "*"
                - "{{ parameters.get('name') }}"
            paginator:
              type: DefaultPaginator
              pagination_strategy:
                type: "CursorPagination"
                cursor_value: "{{ response.get('next_offset')|tojson() }}"
                stop_condition: "{{ not response.next_offset }}"
                page_size_option:
                  type: RequestOption
                  inject_into: request_parameter
                  field_name: limit
                  page_size: 100
              page_token_option:
                type: RequestOption
                inject_into: request_parameter
                field_name: offset
            requester:
              type: HttpRequester
              url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
              http_method: "GET"
              authenticator:
                type: BasicHttpAuthenticator
                username: "{{ config['site_api_key'] }}"
              error_handler:
                type: CompositeErrorHandler
                error_handlers:
                - type: DefaultErrorHandler
                  response_filters:
                  - error_message_contains: "This API operation is not enabled for
                      this site"
                    action: IGNORE
                    error_message: "Stream is available only for Product Catalog 1.0"
                    type: HttpResponseFilter
                - type: DefaultErrorHandler
                  backoff_strategies:
                  - type: WaitTimeFromHeader
                    header: "Retry-After"
              request_parameters:
                sort_by[asc]: date
                include_deleted: "true"
                updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
              path: "/quotes"
          transformations:
          - type: CustomTransformation
            class_name: source_declarative_manifest.components.CustomFieldTransformation
          incremental_sync:
            type: DatetimeBasedCursor
            start_datetime:
              datetime: "{{ format_datetime(config['start_date'], '%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            end_datetime:
              datetime: "{{ now_utc().strftime('%s') }}"
              datetime_format: "%s"
              type: MinMaxDatetime
            datetime_format: "%s"
            cursor_granularity: PT1S
            step: P1M
            cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at')
              }}"
          schema_loader:
            type: InlineSchemaLoader
            schema:
              $schema: http://json-schema.org/draft-07/schema#
              name: Customer
              type: object
              properties:
                id:
                  description: The unique identifier of the quote.
                  type:
                  - string
                  - 'null'
                name:
                  description: The name or title of the quote.
                  type:
                  - string
                  - 'null'
                po_number:
                  description: The purchase order number associated with the quote.
                  type:
                  - string
                  - 'null'
                customer_id:
                  description: The ID of the customer associated with the quote.
                  type:
                  - string
                  - 'null'
                subscription_id:
                  description: The ID of the subscription associated with the quote.
                  type:
                  - string
                  - 'null'
                invoice_id:
                  description: The ID of the invoice associated with the quote.
                  type:
                  - string
                  - 'null'
                status:
                  description: The status of the quote (e.g., draft, sent, accepted).
                  type:
                  - string
                  - 'null'
                operation_type:
                  description: The type of operation (e.g., new, modification) performed
                    on the quote.
                  type:
                  - string
                  - 'null'
                vat_number:
                  description: The VAT number associated with the quote.
                  type:
                  - string
                  - 'null'
                price_type:
                  description: The type of pricing used for the quote (e.g., fixed,
                    variable).
                  type:
                  - string
                  - 'null'
                valid_till:
                  description: The date until which the quote remains valid.
                  type:
                  - integer
                  - 'null'
                date:
                  description: The date when the quote was generated.
                  type:
                  - integer
                  - 'null'
                total_payable:
                  description: The total amount payable for the quote after all adjustments.
                  type:
                  - integer
                  - 'null'
                charge_on_acceptance:
                  description: Whether the charge is applicable on acceptance of the
                    quote.
                  type:
                  - integer
                  - 'null'
                sub_total:
                  description: The subtotal amount before applying discounts or taxes.
                  type:
                  - integer
                  - 'null'
                total:
                  description: The total amount of the quote including all charges.
                  type:
                  - integer
                  - 'null'
                credits_applied:
                  description: The credits applied to the quote amount.
                  type:
                  - integer
                  - 'null'
                amount_paid:
                  description: The total amount that has been paid towards the quote.
                  type:
                  - integer
                  - 'null'
                amount_due:
                  description: The total amount that is due for payment in the quote.
                  type:
                  - integer
                  - 'null'
                version:
                  description: The version of the quote data.
                  type:
                  - integer
                  - 'null'
                resource_version:
                  description: The version of the resource related to the quote.
                  type:
                  - integer
                  - 'null'
                updated_at:
                  description: The last updated timestamp for the quote data.
                  type:
                  - integer
                  - 'null'
                vat_number_prefix:
                  description: The prefix used for the VAT number in the quote.
                  type:
                  - string
                  - 'null'
                currency_code:
                  description: The currency code used for all monetary values in the
                    quote.
                  type:
                  - string
                  - 'null'
                notes:
                  description: Any additional notes or comments related to the quote.
                  type:
                  - array
                  - 'null'
                contract_term_start:
                  description: The start date of the contract terms for the quote.
                  type:
                  - integer
                  - 'null'
                contract_term_end:
                  description: The end date of the contract terms for the quote.
                  type:
                  - integer
                  - 'null'
                contract_term_termination_fee:
                  description: The fee applicable for terminating the contract terms.
                  type:
                  - integer
                  - 'null'
                business_entity_id:
                  description: The ID of the business entity related to the quote.
                  type:
                  - string
                  - 'null'
                line_items:
                  description: Individual line items included in the quote.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      id:
                        type:
                        - string
                        - 'null'
                      subscription_id:
                        type:
                        - string
                        - 'null'
                      date_from:
                        type:
                        - integer
                        - 'null'
                      date_to:
                        type:
                        - integer
                        - 'null'
                      unit_amount:
                        type:
                        - integer
                        - 'null'
                      quantity:
                        type:
                        - integer
                        - 'null'
                      amount:
                        type:
                        - integer
                        - 'null'
                      pricing_model:
                        type:
                        - string
                        - 'null'
                      is_taxed:
                        type:
                        - boolean
                        - 'null'
                      tax_amount:
                        type:
                        - integer
                        - 'null'
                      tax_rate:
                        type:
                        - number
                        - 'null'
                      unit_amount_in_decimal:
                        type:
                        - string
                        - 'null'
                      quantity_in_decimal:
                        type:
                        - string
                        - 'null'
                      amount_in_decimal:
                        type:
                        - string
                        - 'null'
                      discount_amount:
                        type:
                        - integer
                        - 'null'
                      item_level_discount_amount:
                        type:
                        - integer
                        - 'null'
                      reference_line_item_id:
                        type:
                        - string
                        - 'null'
                      description:
                        type:
                        - string
                        - 'null'
                      entity_description:
                        type:
                        - string
                        - 'null'
                      entity_type:
                        type:
                        - string
                        - 'null'
                      tax_exempt_reason:
                        type:
                        - string
                        - 'null'
                      entity_id:
                        type:
                        - string
                        - 'null'
                      customer_id:
                        type:
                        - string
                        - 'null'
                      metered:
                        type:
                        - boolean
                        - 'null'
                      object:
                        type:
                        - string
                        - 'null'
                discounts:
                  description: Discounts applied to the quote.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      amount:
                        type:
                        - integer
                        - 'null'
                      description:
                        type:
                        - string
                        - 'null'
                      line_item_id:
                        type:
                        - string
                        - 'null'
                      entity_type:
                        type:
                        - string
                        - 'null'
                      discount_type:
                        type:
                        - string
                        - 'null'
                      entity_id:
                        type:
                        - string
                        - 'null'
                      coupon_set_code:
                        type:
                        - string
                        - 'null'
                      object:
                        type:
                        - string
                        - 'null'
                line_item_discounts:
                  description: Discounts applied at the line item level.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      line_item_id:
                        type:
                        - string
                        - 'null'
                      discount_type:
                        type:
                        - string
                        - 'null'
                      entity_id:
                        type:
                        - string
                        - 'null'
                      discount_amount:
                        type:
                        - integer
                        - 'null'
                      object:
                        type:
                        - string
                        - 'null'
                taxes:
                  description: Taxes applied to the overall quote amount.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      name:
                        type:
                        - string
                        - 'null'
                      amount:
                        type:
                        - integer
                        - 'null'
                      description:
                        type:
                        - string
                        - 'null'
                line_item_taxes:
                  description: Taxes applied at the line item level.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      line_item_id:
                        type:
                        - string
                        - 'null'
                      tax_name:
                        type:
                        - string
                        - 'null'
                      tax_rate:
                        type:
                        - number
                        - 'null'
                      is_partial_tax_applied:
                        type:
                        - boolean
                        - 'null'
                      is_non_compliance_tax:
                        type:
                        - boolean
                        - 'null'
                      taxable_amount:
                        type:
                        - integer
                        - 'null'
                      tax_amount:
                        type:
                        - integer
                        - 'null'
                      tax_juris_type:
                        type:
                        - string
                        - 'null'
                      tax_juris_name:
                        type:
                        - string
                        - 'null'
                      tax_juris_code:
                        type:
                        - string
                        - 'null'
                      tax_amount_in_local_currency:
                        type:
                        - integer
                        - 'null'
                      local_currency_code:
                        type:
                        - string
                        - 'null'
                line_item_tiers:
                  description: Tiers related to line items in the quote.
                  type:
                  - array
                  - 'null'
                  items:
                    type:
                    - object
                    - 'null'
                    properties:
                      line_item_id:
                        type:
                        - string
                        - 'null'
                      starting_unit:
                        type:
                        - integer
                        - 'null'
                      ending_unit:
                        type:
                        - integer
                        - 'null'
                      quantity_used:
                        type:
                        - integer
                        - 'null'
                      unit_amount:
                        type:
                        - integer
                        - 'null'
                      starting_unit_in_decimal:
                        type:
                        - string
                        - 'null'
                      ending_unit_in_decimal:
                        type:
                        - string
                        - 'null'
                      quantity_used_in_decimal:
                        type:
                        - string
                        - 'null'
                      unit_amount_in_decimal:
                        type:
                        - string
                        - 'null'
                shipping_address:
                  description: The shipping address associated with the quote.
                  type:
                  - object
                  - 'null'
                  properties:
                    first_name:
                      type:
                      - string
                      - 'null'
                    last_name:
                      type:
                      - string
                      - 'null'
                    email:
                      type:
                      - string
                      - 'null'
                    company:
                      type:
                      - string
                      - 'null'
                    phone:
                      type:
                      - string
                      - 'null'
                    line1:
                      type:
                      - string
                      - 'null'
                    line2:
                      type:
                      - string
                      - 'null'
                    line3:
                      type:
                      - string
                      - 'null'
                    city:
                      type:
                      - string
                      - 'null'
                    state_code:
                      type:
                      - string
                      - 'null'
                    state:
                      type:
                      - string
                      - 'null'
                    country:
                      type:
                      - string
                      - 'null'
                    zip:
                      type:
                      - string
                      - 'null'
                    validation_status:
                      type:
                      - string
                      - 'null'
                    index:
                      type:
                      - integer
                      - 'null'
                    object:
                      type:
                      - string
                      - 'null'
                billing_address:
                  description: The billing address associated with the quote.
                  type:
                  - object
                  - 'null'
                  properties:
                    first_name:
                      type:
                      - string
                      - 'null'
                    last_name:
                      type:
                      - string
                      - 'null'
                    email:
                      type:
                      - string
                      - 'null'
                    company:
                      type:
                      - string
                      - 'null'
                    phone:
                      type:
                      - string
                      - 'null'
                    line1:
                      type:
                      - string
                      - 'null'
                    line2:
                      type:
                      - string
                      - 'null'
                    line3:
                      type:
                      - string
                      - 'null'
                    city:
                      type:
                      - string
                      - 'null'
                    state_code:
                      type:
                      - string
                      - 'null'
                    state:
                      type:
                      - string
                      - 'null'
                    country:
                      type:
                      - string
                      - 'null'
                    zip:
                      type:
                      - string
                      - 'null'
                    validation_status:
                      type:
                      - string
                      - 'null'
                    object:
                      type:
                      - string
                      - 'null'
                object:
                  description: The object type representing the quote.
                  type:
                  - string
                  - 'null'
                custom_fields: _definitions.json#/definitions/custom_fields
          type: DeclarativeStream
          name: "quote"
          primary_key: "id"
        parent_key: id
        partition_field: id
        incremental_dependency: true
  transformations:
  - type: AddFields
    fields:
    - path:
      - "quote_id"
      value: "{{ stream_slice.id }}"
      type: AddedFieldDefinition
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Quote Line Group
      type: object
      properties:
        version:
          description: The version of the quote line group.
          type:
          - integer
          - 'null'
        id:
          description: Unique identifier for the quote line group.
          type:
          - string
          - 'null'
        quote_id:
          description: Unique identifier for the quote associated with the line group.
          type:
          - string
          - 'null'
        sub_total:
          description: The subtotal amount of the quote line group.
          type:
          - integer
          - 'null'
        total:
          description: The total amount for the quote line group after all calculations.
          type:
          - integer
          - 'null'
        credits_applied:
          description: The amount of credits applied to the quote line group.
          type:
          - integer
          - 'null'
        amount_paid:
          description: The total amount that has been paid.
          type:
          - integer
          - 'null'
        amount_due:
          description: The total amount that is due for payment.
          type:
          - integer
          - 'null'
        charge_event:
          description: Details about the charge event associated with the quote line
            group.
          type:
          - string
          - 'null'
        billing_cycle_number:
          description: The number indicating the current billing cycle.
          type:
          - integer
          - 'null'
        line_items:
          description: Details about the line items included in the quote line group.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              id:
                type:
                - string
                - 'null'
              subscription_id:
                type:
                - string
                - 'null'
              date_from:
                type:
                - integer
                - 'null'
              date_to:
                type:
                - integer
                - 'null'
              unit_amount:
                type:
                - integer
                - 'null'
              quantity:
                type:
                - integer
                - 'null'
              amount:
                type:
                - integer
                - 'null'
              pricing_model:
                type:
                - string
                - 'null'
              is_taxed:
                type:
                - boolean
                - 'null'
              tax_amount:
                type:
                - integer
                - 'null'
              tax_rate:
                type:
                - number
                - 'null'
              unit_amount_in_decimal:
                type:
                - string
                - 'null'
              quantity_in_decimal:
                type:
                - string
                - 'null'
              amount_in_decimal:
                type:
                - string
                - 'null'
              discount_amount:
                type:
                - integer
                - 'null'
              item_level_discount_amount:
                type:
                - integer
                - 'null'
              reference_line_item_id:
                type:
                - string
                - 'null'
              description:
                type:
                - string
                - 'null'
              entity_description:
                type:
                - string
                - 'null'
              entity_type:
                type:
                - string
                - 'null'
              tax_exempt_reason:
                type:
                - string
                - 'null'
              entity_id:
                type:
                - string
                - 'null'
              customer_id:
                type:
                - string
                - 'null'
              metered:
                type:
                - boolean
                - 'null'
              object:
                type:
                - string
                - 'null'
        discounts:
          description: Details about any discounts applied to the quote line group.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              amount:
                type:
                - integer
                - 'null'
              description:
                type:
                - string
                - 'null'
              line_item_id:
                type:
                - string
                - 'null'
              entity_type:
                type:
                - string
                - 'null'
              discount_type:
                type:
                - string
                - 'null'
              entity_id:
                type:
                - string
                - 'null'
              coupon_set_code:
                type:
                - string
                - 'null'
              object:
                type:
                - string
                - 'null'
        line_item_discounts:
          description: Details about any discounts applied to individual line items
            within the quote line group.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                type:
                - string
                - 'null'
              discount_type:
                type:
                - string
                - 'null'
              entity_id:
                type:
                - string
                - 'null'
              discount_amount:
                type:
                - integer
                - 'null'
              object:
                type:
                - string
                - 'null'
        taxes:
          description: Details about the taxes applied to the quote line group.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              name:
                type:
                - string
                - 'null'
              amount:
                type:
                - integer
                - 'null'
              description:
                type:
                - string
                - 'null'
        line_item_taxes:
          description: Details about taxes applied to individual line items within
            the quote line group.
          type:
          - array
          - 'null'
          items:
            type:
            - object
            - 'null'
            properties:
              line_item_id:
                type:
                - string
                - 'null'
              tax_name:
                type:
                - string
                - 'null'
              tax_rate:
                type:
                - number
                - 'null'
              is_partial_tax_applied:
                type:
                - boolean
                - 'null'
              is_non_compliance_tax:
                type:
                - boolean
                - 'null'
              taxable_amount:
                type:
                - integer
                - 'null'
              tax_amount:
                type:
                - integer
                - 'null'
              tax_juris_type:
                type:
                - string
                - 'null'
              tax_juris_name:
                type:
                - string
                - 'null'
              tax_juris_code:
                type:
                - string
                - 'null'
              tax_amount_in_local_currency:
                type:
                - integer
                - 'null'
              local_currency_code:
                type:
                - string
                - 'null'
        object:
          description: Type of object representing the quote line group.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "quote_line_group"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
      record_filter:
        condition: "{{ record['migrated_at'] >= ( stream_state.get('prior_state',
          {}).get('migrated_at', 0) if stream_state else stream_slice.get('prior_state',
          {}).get('migrated_at', 0) ) }}"
        type: RecordFilter
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      path: "/site_migration_details"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: CustomIncrementalSync
    class_name: source_declarative_manifest.components.IncrementalSingleSliceCursor
    cursor_field: "migrated_at"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Site Migration Detail
      type: object
      properties:
        entity_id:
          description: ID of the entity being migrated at the current site.
          type:
          - string
          - 'null'
        other_site_name:
          description: Name of the site from which the entity was migrated.
          type:
          - string
          - 'null'
        entity_id_at_other_site:
          description: ID of the entity at the other site where migration occurred.
          type:
          - string
          - 'null'
        migrated_at:
          description: Timestamp indicating when the migration took place.
          type:
          - integer
          - 'null'
        entity_type:
          description: Type of entity being migrated (e.g., customer, subscription).
          type:
          - string
          - 'null'
        status:
          description: Current status of the site migration process.
          type:
          - string
          - 'null'
        object:
          description: Type of object being migrated (e.g., user, data).
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "site_migration_detail"
  primary_key: "entity_id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: created_at
        created_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/comments"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Comment
      type: object
      properties:
        id:
          description: The unique identifier of the comment.
          type:
          - string
          - 'null'
        entity_type:
          description: The type of entity (e.g., customer, invoice) that the comment
            is related to.
          type:
          - string
          - 'null'
        added_by:
          description: The user who added the comment.
          type:
          - string
          - 'null'
        notes:
          description: The actual content of the comment or notes added.
          type:
          - string
          - 'null'
        created_at:
          description: The timestamp indicating when the comment was created.
          type:
          - integer
          - 'null'
        type:
          description: The type or category of the comment (e.g., general, issue).
          type:
          - string
          - 'null'
        entity_id:
          description: The unique identifier of the entity the comment is associated
            with.
          type:
          - string
          - 'null'
        object:
          description: The object to which the comment is attached.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "comment"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/item_families"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Item Families
      type: object
      properties:
        id:
          description: The unique identifier for the item family.
          type:
          - string
          - 'null'
        name:
          description: The name of the item family.
          type:
          - string
          - 'null'
        description:
          description: A brief description of the item family.
          type:
          - string
          - 'null'
        status:
          description: The status of the item family.
          type:
          - string
          - 'null'
        resource_version:
          description: The resource version of the item family data.
          type:
          - integer
          - 'null'
        updated_at:
          description: The timestamp when the item family was last updated.
          type:
          - integer
          - 'null'
        channel:
          description: The channel associated with the item family.
          type:
          - string
          - 'null'
        object:
          description: The type of object, in this case, 'item_family'.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "item_family"
  primary_key: "id"
- retriever:
    type: SimpleRetriever
    record_selector:
      type: RecordSelector
      extractor:
        type: DpathExtractor
        field_path:
        - "list"
        - "*"
        - "{{ parameters.get('name') }}"
    paginator:
      type: DefaultPaginator
      pagination_strategy:
        type: "CursorPagination"
        cursor_value: "{{ response.get('next_offset')|tojson() }}"
        stop_condition: "{{ not response.next_offset }}"
        page_size_option:
          type: RequestOption
          inject_into: request_parameter
          field_name: limit
          page_size: 100
      page_token_option:
        type: RequestOption
        inject_into: request_parameter
        field_name: offset
    requester:
      type: HttpRequester
      url_base: "https://{{ config['site'] }}.chargebee.com/api/v2"
      http_method: "GET"
      authenticator:
        type: BasicHttpAuthenticator
        username: "{{ config['site_api_key'] }}"
      error_handler:
        type: CompositeErrorHandler
        error_handlers:
        - type: DefaultErrorHandler
          response_filters:
          - error_message_contains: "This API operation is not enabled for this site"
            action: IGNORE
            error_message: "Stream is available only for Product Catalog 1.0"
            type: HttpResponseFilter
        - type: DefaultErrorHandler
          backoff_strategies:
          - type: WaitTimeFromHeader
            header: "Retry-After"
      request_parameters:
        sort_by[asc]: updated_at
        include_deleted: "true"
        updated_at[between]: "'[{{stream_slice['start_time']}}, {{stream_slice['end_time']}}]'"
      path: "/differential_prices"
  transformations:
  - type: CustomTransformation
    class_name: source_declarative_manifest.components.CustomFieldTransformation
  incremental_sync:
    type: DatetimeBasedCursor
    start_datetime:
      datetime: "{{ format_datetime(config['start_date'], '%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    end_datetime:
      datetime: "{{ now_utc().strftime('%s') }}"
      datetime_format: "%s"
      type: MinMaxDatetime
    datetime_format: "%s"
    cursor_granularity: PT1S
    step: P1M
    cursor_field: "{{ parameters.get('stream_cursor_field', 'updated_at') }}"
  schema_loader:
    type: InlineSchemaLoader
    schema:
      $schema: http://json-schema.org/draft-07/schema#
      name: Add-on
      type: object
      properties:
        id:
          description: The unique identifier for the differential price data.
          type:
          - string
          - 'null'
        item_price_id:
          description: The identifier of the item price related to the differential
            price.
          type:
          - string
          - 'null'
        parent_item_id:
          description: The ID of the parent item linked to this differential price
            data.
          type:
          - string
          - 'null'
        price:
          description: The price value of the differential price.
          type:
          - integer
          - 'null'
        price_in_decimal:
          description: The price value in decimal format for precise calculations.
          type:
          - string
          - 'null'
        status:
          description: The status of the differential price data (e.g., active, inactive).
          type:
          - string
          - 'null'
        resource_version:
          description: The version of the resource for tracking changes.
          type:
          - integer
          - 'null'
        updated_at:
          description: The timestamp when the differential price data was last updated.
          type:
          - integer
          - 'null'
        created_at:
          description: The timestamp when the differential price data was created.
          type:
          - integer
          - 'null'
        modified_at:
          description: The timestamp when the differential price data was last modified.
          type:
          - integer
          - 'null'
        currency_code:
          description: The currency code associated with the differential price data.
          type:
          - string
          - 'null'
        tiers:
          description: Contains information about price tiers
          type:
          - array
          - 'null'
          items:
            type: object
            properties:
              starting_unit:
                description: The starting unit for a specific price tier.
                type:
                - integer
                - 'null'
              ending_unit:
                description: The end unit for a specific price tier.
                type:
                - integer
                - 'null'
              price:
                description: The price for the tier within specified units.
                type:
                - integer
                - 'null'
        parent_periods:
          description: Contains information about the parent periods
          type:
          - array
          - 'null'
          items:
            type: object
            properties:
              period_unit:
                description: The unit of the period (e.g., days, months) for the parent
                  item.
                type:
                - string
                - 'null'
              period:
                description: The period associated with the parent item.
                type:
                - array
                - 'null'
                items:
                  type:
                  - integer
                  - 'null'
        object:
          description: The object type which this data represents.
          type:
          - string
          - 'null'
        custom_fields: _definitions.json#/definitions/custom_fields
  type: DeclarativeStream
  name: "differential_price"
  primary_key: "id"
check:
  stream_names:
  - "event"
  type: CheckStream
type: DeclarativeSource
spec:
  type: Spec
  documentation_url: https://apidocs.chargebee.com/docs/api
  connection_specification:
    $schema: http://json-schema.org/draft-07/schema#
    title: Chargebee Spec
    type: object
    required:
    - site
    - site_api_key
    - start_date
    additionalProperties: true
    properties:
      site_api_key:
        type: string
        title: API Key
        description: Chargebee API Key. See the <a href="https://docs.airbyte.com/integrations/sources/chargebee">docs</a>
          for more information on how to obtain this key.
        airbyte_secret: true
        order: 0
      site:
        type: string
        title: Site
        description: The site prefix for your Chargebee instance.
        examples:
        - "airbyte-test"
        order: 1
      start_date:
        type: string
        format: date-time
        title: Start Date
        description: UTC date and time in the format 2017-01-25T00:00:00.000Z. Any
          data before this date will not be replicated.
        pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$
        examples:
        - "2021-01-25T00:00:00Z"
        order: 2
      product_catalog:
        type: string
        title: Product Catalog
        description: Product Catalog version of your Chargebee site. Instructions
          on how to find your version you may find <a href="https://apidocs.chargebee.com/docs/api?prod_cat_ver=2">here</a>
          under `API Version` section. If left blank, the product catalog version
          will be set to 2.0.
        enum: ["1.0", "2.0"]
        default: "2.0"
        order: 3
